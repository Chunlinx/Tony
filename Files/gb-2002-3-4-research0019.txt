                    Background        Microarrays have become standard tools for gene        expression analysis as the messenger RNA levels of        thousands of genes can be measured in one assay In a        standard microarray experiment total RNA or mRNA is        extracted from cells or tissue labeled by reverse        transcription with radioactive or fluorescenttaglabeled        nucleotides and hybridized to the arrays After        hybridization and washing the arrays are scanned and the        hybridization intensities at each spot are determined by        imageanalysis software Twochannel microarrays open up        the possibility of carrying out many hybridizations in        parallel using a common reference RNA In such experiments        different experimental conditions can be compared to each        other In many cases different conditions are analyzed        with some replications to allow variance analysis           This procedure results in multivariate grouped data in        which one group represents a condition with several        replicates Such data can be represented as a matrix with         n rows genes and         p columns hybridizations and a        vector of length         p containing the group labels These        data are characteristic of multicondition microarray        experiments        To analyze such data multivariate statistics are        needed Before carrying out the analysis the data must be        preprocessed by background subtraction computation of        ratios and arraywise normalization After this step the        data can be analyzed using different multivariate        approaches These methods can be classified as supervised        and unsupervised A wide variety of supervised approaches        have been described for example classification and        regression trees   or support vector machines          Among unsupervised methods hierarchical clustering          and other clustering approaches    as well as        projection methods such as multidimensional scaling          principal components analysis PCA              and correspondence analysis   have been described Such        projection techniques reduce the dimensionality of        multivariate data to embed the variables and objects of the        data in a visualizable two or threedimensional space        The projection aims to represent the objects and variables        in the reduced space in such a way that they approximate        their original distances in the highdimensional space        This enables one to extract and visualize the dominant        effects on variance from the data With PCA linear        combinations principal components of the original        variables can thus be functionally interpreted for review        see   This enables a biological interpretation of the        nature of coherent variation        In microarray experiments the identification of subsets        of genes with large variation between groups is of primary        interest This process has to comprise a criterion that        accounts for the variance within groups Sometimes this        selection is only the first step in the data analysis        Hastie         et al    carried out        hierarchical clustering of geneexpression data and        computed an average expression profile for each cluster        providing the input for a response model A direct        significance analysis to select genes from microarray data        SAM was proposed by Tusher         et al    This method is based        on         t like in the case of two        conditions or Flike statistics        Several methods for gene selection involving PCA have        been proposed The gene shaving approach of Hastie         et al    restricts PCA to the        first principal component Groups of genes are generated by        iterative exclusion of fixed fractions of genes typically         with smallest absolute loadings according to the first        principal component After orthogonalization of the data        with respect to an averaged expression profile of the first        group the procedure is repeated Another PCAbased method        of gene selection using PCAderived gene coefficient        vectors and Fstatistics was described by Landgrebe         et al           Although these methods allow the detection of patterns        or characteristic nodes by dimension reduction and the        selection of gene subsets with large variation between        condition groups the reliability of the results has to be        determined Therefore it is imperative to assess whether        the results are statistically reliable relative to the        level of noise in the data Classical statistical        parametric tests depend on the assumptions of normality and        independence of variables hybridizations Yet these        assumptions do not hold for microarray data           Consequently computationally intensive methods such as        permutation tests or bootstrap procedures as introduced by        Efron   are preferable Kerr         et al    show the application of        bootstrap technique to clustering results Ghosh          describes another approach based on mixture modeling to        assess the reliability of clustering results Other        permutationbased approaches were published by Tusher         et al    and Dudoit         et al    The method proposed by        Hastie         et al    also contains bootstrap        elements An approach of Wall         et al    tries to combine        PCAbased gene selection with a confidence measure using        leaveoneout crossvalidation        Here we describe an approach combining PCAdirected gene        selection with validation by permutation tests We use a        test statistic based on the genes object scores to select        genes with high variance with respect to the principal        components The method was developed for the analysis of        microarray data having several conditions with a few        replicates per condition or a group structure We        demonstrate this approach by applying it to the        wellcharacterized data of Spellman         et al    Although other methods        are better adapted to the analysis of temporal effects for        example   we chose the yeast data to allow comparison        with other approaches applied to this dataset    In        addition two datasets generated in our own laboratory were        also analyzed Our method was successfully applied to the        different datasets We revealed the main sources of        variance in the data and described the genes related to        this variance This allowed the interpretation of variance        and the permutationvalidated selection of genes in a        functional context                    Results                  Permutationtestvalidated PCA          We carried out permutationtestvalidated PCA on          grouped data with few replicates to study variation in          gene expression across several conditions to understand          the structure of the data to uncover patterns underlying          the hybridization conditions and to identify subsets of          genes with large variation across these patterns PCA is          primarily aimed at finding and interpreting complex          relationships between variables in a dataset Correlated          variables are converted to factors that are not          correlated to each other The central point of such          analysis is to decompose the original           n            p data matrix            n objects           p variables in the following          manner                    X            AF T           where           X is the           n            p data matrix           A is the           n            p matrix of factor scores and           F is the           p            p matrix of factor loadings With           s            p factors the total variance of all          variables is explained The decomposition of           X is done in such a way that the          factors explain the total variance in a descending order          Therefore it is possible to reduce the data to           s dimensions with a minimum loss of          information expressed by the matrix of residuals           E                     where  is the           n            s matrix of factor scores the           p            s matrix of factor loadings and           E is the matrix of residuals as a          result of dimension reduction In this manner PCA          provides a projection of the objects from           p dimensional to           s dimensional space          In grouped data with replicates per group condition          there is additional information about the columns of the          data matrix           y             y                       y                       y           p   is a set of class labels          identifying the replicates for each condition Although          PCA is generally not considered to be appropriate for          grouped data the method has been adapted for this data          type rankordered PCA            The consecutive steps of the permutation validated PCA          procedure are shown in Figure  In step  we perform          rankordered PCA based on the polished gene expression          matrix           X see Materials and methods by          computing separate oneway ANOVAs on the principal          components loadings for each of the components If the          betweengroup variance dominates the total variability in          the data PCA discriminates between groups In this          situation the first components of the PCA and components          with high Fvalues are identical Thus following the          order of explained variance we select the components          with significant Fstatistics            p   At the occurrence of a          component with nonsignificant Fstatistics we terminate          the selection This process results in           k components step  Data          approximated in the space based on these components          reflect the betweengroup variance Thus in step  of          the procedure we compute components from the          groupaveraged data and derive the exact betweengroup          variance for each gene which can be estimated by                    where           a                       gi            is the factor score for gene           g and component           i  As a test value we use step           Genes with a high value are candidates for          selection          To assess the reliability of the results we perform a          permutation analysis steps  Under the hypothesis of          no effect of different conditions on gene expression          profiles the class labels given by           y are randomly sampled to          determine the permutation distribution of the required          test statistics Computing PCAs from randomized          groupaveraged data yields the distribution of the test          statistic           T                       g            for each gene           g step                     We compute  permutation distributions for each          gene step  In step  we select the genes for which           t           g  is greater than the           quantile of the permutation distribution of           T           g   The last step is the          visualization of the arrays and selected genes in the          reduced           k components space If           k   a twofold visualization is          suggested The biplot with marked selected genes can be          used to relate genes and conditions Genes lying near an          axis of a condition are upregulated in this hybridization          and genes lying in the opposite direction are repressed          With several conditions this relation is generally not          unique Therefore the visualization maybe supported by          colorcoded expressionprofile tables Here the data          matrix is rearranged according to the angular distance          from the           x axis for each gene rearranging           n rows The same is done for          hybridizations rearranging           p columns If           k   several biplots and          colorcoded tables must be constructed                          Application to yeast cellcycle data          To demonstrate our approach we applied it to the          yeast cellcycle data published by Spellman           et al    These authors          synchronized the yeast cell cycle using independent          methods of cellcycle arrest and measured the expression          of all yeast open reading frames ORFs at different time          points after the cellcycle synchronization They          identified genes related to the cell cycle using Fourier          transformation and correlation measures We analyzed the          cellcyclerelated genes selected by Spellman           et al    to demonstrate the          relationship between cellcycle phases and          geneexpression patterns and to select a subset of genes          that show the highest and most reproducible variance          across the cellcycle phases We analyzed the expression          patterns of  selected genes over all           hybridizations          The cell cycle is a temporal continuum that is          generally grouped into cellcycle phases This          classification was also carried out by Spellman           et al    The classification          of genes in cellcycle phase groups enables one to          analyze the variance of gene expression across the          cellcycle phases and to select genes with different and          robust regulation We analyzed the data using          permutationvalidated PCA A first PCA was based on the          polished logarithmic ratios including all arrays An          analysis of variance ANOVA using the variable loadings          as dependent variables and the classificationderived          cellcycle phase groups as factors was carried out The          first two components were highly significant whereas the          others were not Figure shows a plot of the first two          component loadings against each other Of the datas          variance  was explained by the first two          components The plot shows that the resulting ordination          of the hybridizations corresponds to the assignment of          cellcycle phases by Spellman           et al    The angular position          of the hybridizations in the plot reflects their correct          temporal situation in the cycle The first seven arrays          of the CDC series seem to be misclassified They are          shown with colored labels in Figure and show a          counterclockwise shift in expression in the cell cycle          Thus the first two components approximate the cellcycle          aspect of the data quite well and could be interpreted as          cellcycle components They reflect the main temporal          aspect of the data          A second PCA was carried out on the groupaveraged          data using the original cellcycle classification with          two components  explained variance Figure shows          a biplot of the  gene scores and the five cellcycle          phase group loadings For each gene the distance to the          origin indicates the variance in the reduced          twodimensional space The hole in the middle of the plot          reflects the fact that only genes related to the cell          cycle were chosen by Spellman           et al    Genes without          variance with respect to the cell cycle equally          transcribed in most cellcycle phases would lie in the          middle of the biplot In Figure   genes are labeled          with gene symbols These genes had a test value above the           percentile of the permutation distribution of the          related test statistic Figure allows the assignment of          the genes to the cellcycle phases in which they are          regulated As illustrated by Figures and  in the          cellcycle phase MG           CDC encoding part of the          replication complex was selected as an upregulated gene          whereas the histone genes           HTB HTA and           HHO also marked by Spellman           et al    and Fellenberg           et al    were selected as          downregulated genes In phases G and S           POL replication complex and           RAD cellcyclerelated protein          kinase were selected The histone genes repressed in          MG were upregulated in S In G and M           CLB GMspecific cyclin involved          in mitotic induction           CDC mitotic DNA replication and           CLB GMspecific cyclin involved          in mitotic induction were selected as upregulated in          phase M           CDC cyclin degradation part of          the anaphasepromoting complex Thus among the known          genes selected by our algorithm many play a crucial role          in the cell cycle As described by Spellman           et al    the microarray          expression data confirm the results of other gene          expression studies                          Application to abolition of CRHRI function          data          In this experiment mRNAs from whole brains of mice of          different genetic backgrounds which had been treated with          an antagonist directed against the ligandbinding domain          of a seventransmembrane neuropeptide receptor   the          corticotropinreleasing hormone receptor  CRHR            were compared to mRNAs from brains of mice lacking a          functional CRHR CRHR knockout mice   using          cDNAmicroarrays Table  The data consist of log            ratios The matrix had           complete observations genes and  hybridizations We          computed a PCA based on the polished matrix of single          hybridizations to show that the treatment group members          clustered together data not shown We performed an          ANOVA using the variable loadings as dependent variables          and the treatment groups as factors The first two          components were highly significant whereas the third          component was not The first two components explained           of the datas variance We carried out PCA for          groupaveraged data with two components  explained          variance Figure shows a biplot of these components          The two components describe a gradient effect of the          abolition of CRHR function in different genetic          backgrounds Component  abscissa distinguishes the          CRHR abolition null mutant from relatively mild          CRHR function impairment h w  day of treatment          with antagonist With the increasing effect on the          animals of gene function impairment the animals          loadings on the first component become more similar to          the genetic CRHR inactivation Component  ordinate          distinguishes between impairment of heterozygotes treated          for  day and wildtype animals treated for  days both          of OlaCD background          Because longtermtreated wildtype animals of SvJ          background sy are similar to the knockout animals          treatment seems to have a strong effect in these animals          Animals with a OlaCD background group wy show a          weaker response to treatment with the antagonist Both          components describe abolitionoffunction effects in a          backgrounddependent manner Thus given a particular          genetic background treatment with an antagonist against          CRHR can mimic the genetic abolition of gene function          A comparable phenomenon was shown in yeast by Hughes           et al             Only  genes were selected by permutation tests and          are labeled with gene symbols in Figure  These genes          show high variance across the treatment groups and are          highly reproducible Only genes that contrast the groups          ko and s on one side and in the groups w and w on the          other side are selected The profiles of these genes are          illustrated in Figure and support the interpretation of          the biplot                          Application to antidepressant data          In this experiment  weekold male mice of SvJ          background were treated with mirtazapine paroxetine or          vehicle for   or  days Table  cDNA microarrays          were used to measure the mRNA expression in total brain          homogenates of these animals The data consist of log            ratios The matrix had           complete observations genes and  hybridizations We          computed a PCA based on the polished matrix of single          hybridizations to show that the treatment groups were          ordinated together data not shown We performed an          ANOVA using the variable loadings as dependent variables          and the treatment groups as factors The first two          components were highly significant They explained           of the datas variance and the object gene scores with          respect to these two components were used to compute the          variance of genes according to the group differences          We carried out a PCA with groupaveraged data and two          components  explained variance Figure shows a          biplot of these components with  selected genes at the           percentile labeled with numbers and  genes at the           percentile labeled with gene symbols The          components describe the effects of antidepressant          treatment on the mouse brain The first component          abscissa discerns treatment with mirtazapine a from          treatment with paroxetine p This component can be          interpreted as the drugtype effect The second component          discerns short  day from longer  or  days          treatment and can be interpreted as the treatment          duration effect Figure shows the  genes selected at          the  percentile in a colorcoded expression table          These genes strongly reflect the treatment type and          duration effect                            Discussion        Here we propose a method for analyzing microarray data        with group structure imposed by different conditions We        combine the visualization focused on the variance of genes        between groups and gene selection taking into account the        withingroup variance Based on PCA this method is able to        visualize relationships between hybridizations by dimension        reduction Yet data visualization via a biplot allows more        than biological interpretation of the components After        appropriate data preprocessing searching for genes with        changes in expression patterns across the groups can be        based on the genes objects distance from the centroid        of the biplot This distance is proportional to the        variance of genes in the dimensionreduced space A        correspondence analysis would give a similar result          But a selection of genes must be accompanied by an        assessment of whether the results are statistically        reliable relative to the level of noise in the data        Whereas classic statistical tests like         t and Fstatistics are based on        assumptions concerning distribution and variable        independence that do not hold for microarray data           the permutationvalidation procedure presented here makes        no assumption about the dependence of geneexpression        measurement within the expression matrix         X  Therefore genespecific scatter is        taken into consideration by calculating the testvalue        permutation distributions for each gene under the null        hypothesis of no groupstructure effect in the expression        profiles Another method for validating PCA results using a        leaveoneout approach Wall         et al    is very global and        can only be applied when the conditions correspond to a        continuous parameter such as time or dose        The last step of the permutationvalidated PCA procedure        concerns the visualization and the interpretation of the        selected genes according to their importance in a        biological context In the case of two dimensions          k   a colorcoded expression        profile can be generated by rearranging the selected genes        and the arrays with respect to angular distances in the        biplot When looking at a biplot showing several variable        loadings a given object gene has to be projected on all        different variables conditions to understand its pattern        with regard to all of them A colorcoded        expressionprofile table may support this visual        interpretation As a further development of the method        described here we envisage cluster analysis of the        selected genes for higher dimensions          k          The application of permutationvalidated PCA to        microarray data shows that the basic sources of variance        could be extracted from all datasets The components        computed from the Spellman         et al    yeast data described        the cell cycle and allowed ordinations of the        hybridizations according to their temporal situation in the        cell cycle Arrays misclassified by the Fourier        transformation   were assigned to shifted positions in        the cell cycle this was also achieved by correspondence        analysis   The components computed from the abolition        of CRHR function experiment described a gradient of        increasing functional impairment depending on the genetic        background of the animals The analysis of the        antidepressant data also shows how principal components led        to an understanding of the fundamental biological phenomena        captured by the data here they discern the types of        treatment and the treatment duration        But there were important differences in the results        whereas the grouped PCA of the cellcycle data explained         of the datas variance the corresponding rates were         explained variance for the antidepressant data and         for the CRHR abolition data In a situation with        homogeneous array groups and preselected genes such as the        cellcycle data the level of explained variance was very        high as the components explained the kind of variance the        genes were preselected for For the antidepressant data no                a priori information about the        relation of genes to treatment type and duration was        available Thus the level of explained variance was lower         although the two components used to build the test        statistics still captured a big part of the variance        present in the data Although the material used for the        antidepressant treatment data RNA from total mouse brain        homogenates containing a variety of cell types was more        heterogeneous than the clonal yeast cell lines        antidepressant effects on the brains mRNA transcription        were so important that clear variance structures emerged in        the data In contrast the level of explained variance for        the CRHR function abolition data was  In this        experiment different methods of impairing or abolishing        the function of CRHR were used on different mouse genetic        backgrounds The variance in the experimental design was        thus quite high Heterogeneity within the groups was also        higher than in the antidepressant experiment probably        because a selective pharmacologic antagonization of the        neuromodulating peptide CRH   had a less pronounced        and stereotypic effect on transcription in the brain than        the antidepressant drugs acting on a wide spectrum of        neurotransmitter receptors transporters and related        enzymes   In this situation of high variance in the        experimental design and a relatively high rate of        heterogeneity in the treatment groups        permutationvalidated PCA only selected genes reflecting        the contrast between the groups w w on one side and s        and k on the other side because this contrast was captured        by the first two components Other aspects of the data were        not captured by PCA Thus a multivariate approach trying        to compare very different gene expression patterns at the        same time might lead to loss of information In such a        case the selection of genes should be treated with caution        and crossvalidation by independent methods should be        applied if hypotheses are to be derived from the selected        genes Pairwise comparisons of groups might be more        appropriate in such a situation        In conclusion permutationvalidated PCA can be used to        extract the leading source of variance from microarray        data to visualize relationships between genes and        hybridizations and to select informative genes in a        statistically reliable manner This selection accounts for        the level of reproducibility of replicates or group        structure as well as genespecific scatter                    Materials and methods                  Sample processing and hybridization          A subset of the data from Spellman           et al    was used To acquire          our own data microarrays were manufactured mice treated          and total brain RNA extracted labeled and hybridized as          described in   Briefly mice were killed after the          end of treatment RNA was extracted by RNeasy and TRIZOL          procedure Total RNA  g was fluorescencelabeled by          oligodTprimed reverse transcription to cDNA in the          presence of CydUTP as described by Eisen and Brown            After reverse transcription total brain Cylabeled          cDNA from each animal was hybridized to a microarray          Fluorescence intensity was detected using the Genetic          Microsystems GMS  Array Scanner Raw data were          assessed with the Spectrum vs imageanalysis software          developed by Chen           et al                             Data preprocessing          Data from Spellman           et al    were also used by          Fellenberg           et al    we did not modify          the described preprocessing The two datasets from our          lab were preprocessed in the following manner Matrix          rows genes with missing observations were excluded from          the datasets resulting in data without missing values          To normalize and compare the different hybridizations to          each other the intensity measured at each spot of the          arrays was divided by the centered median of the          intensities measured at the corresponding spot in the          reference groups Thus every single hybridization was          normalized against the reference groups by computing the          log            of the ratios the mean of groups          so ho and wo for the CRHR data and group c for the          antidepressant data Therefore these groups do not          appear in Figures to  Given an           n            p data matrix the following model             can be stated                    X           gj                            g                                    j                                    gj                                    gj                      In this model           X           gi  is the logratio of gene           g under experimental condition           j                         g            is the normalizing effect for gene           g row                        j            is the experimental variance effect for j column                                 gj            is the differential gene expression for gene           g under experimental condition j          and                        gj            is the random error          To estimate the interaction term                        gj             several other effects must be controlled as                        g            reflects the relation of experiment RNA to          normalizing RNA and is of no biological interest it can          be controlled by mean centering rows                        j            reflects the global variance in RNA preparation          labeling efficacy and hybridization quality as well as          other sources of experimental variance between the arrays          and can be controlled by standardizing the matrix          columns Doing replicates enables control of                        gj             The term                        gj            can thus be obtained by data polishing   that          is the matrix is iteratively subjected to column          standardization and row mean centering until convergence          is reached This polished matrix was used as the basis          for multivariate analysis                    