                    Background        Affymetrix oligonucleotide arrays referred to here as        oligonucleotide arrays are widely used to measure the        abundance of mRNA molecules in biological samples   The        investigator isolates total andor polyadenylated RNA from        cells or tissues generates the corresponding complementary        DNA cDNA transcribes complementary RNA cRNA from the        cDNA template and then hybridizes the cRNA to the array          There is a significant amount of assay noise associated        with readouts from oligonucleotide arrays for example           For these arrays we have found additive and        multiplicative noise affecting individual gene readouts        typically  as well as multiplicative noise        affecting entire arrays often above  As defined here        normalization attempts to correct for only the latter type        of noise The primary sources of this arraylevel noise are        betweenarray variation in overall performance due to        inconsistencies in array fabrication staining and        scanning and betweencRNA variation as independently        prepared cRNAs have variable purity andor        fluorescentlylabeled mass fractions Because these        sources of variation contribute so significantly to array        readouts normalization is a critical first step in any        analysis of gene expression data        Most current normalization procedures for        oligonucleotide arrays are global approaches based on        normalization of the overall mean or median array intensity        to a common standard for example     Spiked        standards have also been used to normalize cDNA   and        oligonucleotide     arrays All these techniques        are inherently linear there have been recent reports of        nonlinear normalizations for cDNA   oligonucleotide           and other   arrays Few detailed comparisons of        oligonucleotidearray normalization procedures have been        reported however          For oligonucleotide arrays the normalization        implemented in the Affymetrix GeneChip software        Affymetrix Santa Clara CA is by far the most commonly        used for example    In this approach the mean        hybridization intensities the average differences AD        of all probe sets on each array are scaled to an arbitrary        fixed level   In the rest of this paper we refer to        this procedure as global normalization or scaled average        difference AD s In practice there are at least three        limitations to this method Of these the first two relate        to the normalization itself and the last relates to the        practical utility of the normalized readouts        First global normalization makes no attempt to        absolutely quantify mRNA abundances Readouts are        normalized to an arbitrary scale which may vary from one        operator to another or between experiments In contrast        previous experiments with spiked controls   and        comparisons with serial analysis of gene expression SAGE          have shown that array response can be proportional to        true transcript abundance suggesting that absolute        quantitation of transcripts is feasible If sufficiently        accurate such an absolute scale for all array readouts        could facilitate comparisons across large diverse gene        expression databases        Second global normalization implicitly assumes that the        mean expression level of all monitored mRNAs is constant        The validity of this assumption depends on the number and        biological characteristics of genes monitored by an array        For smaller arrays that monitor a limited set of mRNAs        this assumption is invalid and may result in erroneous        normalization Ideally a quantitation method for arrays        would be effective even in cases where this constant mean        hypothesis does not hold        Third as typically applied global normalization does        not deal well with transcripts expressed at low copy        numbers In a typical Affymetrix GeneChip assay many        lowabundance transcripts are present at levels below the        sensitivity of detection of the array typically about         mRNAs Measurements for such mRNAs are not only        noisy but are sometimes negative due to        crosshybridization to mismatch probes   Negative        intensity values are meaningless and problematic because        they cannot be logtransformed a manipulation that is a        common prelude to downstream analysis of array data Simply        discarding negative values is objectionable as it can lead        to missed observations of biologically significant        upregulation An automated normalization method that        handles noisy and negative measurements and responds to        variable array sensitivity is desirable especially in a        highthroughput setting        The primary criterion for any alternative to global        normalization is that it should expand the investigators        ability to compare diverse array experiments done at        different times in different laboratories In this paper        we describe alternative procedures that seek to quantitate        array results in terms of transcripts per unit cRNA We        chose cRNA quantitation because it meets the primary        criterion and for several additional reasons        First cRNA quantitation is easily applied to array        experiments using small amounts of starting total RNA that        are difficult to quantitate accurately Second the spike        reagents described here for cRNA quantitation can be used        to specifically monitor the performance of individual        arrays Third in our experience the reproducibility        accuracy and scientific value of cRNA quantitation are at        least as good as those of alternative techniques such as        procedures to quantitate transcripts per cell transcripts        per mass of input material transcripts per total RNA or        transcripts per polyadenylated RNA        We evaluated two alternatives to the standard global        normalization scheme which we term frequency F and        scaled frequency F s normalization These normalization        procedures are based on the presence of a common pool of        biotinlabeled transcripts of known concentrations spiked        into each hybridization Constructs for generating the        control reagents are available through the American Type        Culture Collection ATCC accession numbers are given in        Table  We describe how scaled frequency normalization can        be used to estimate message abundance in cRNA compute a        chip sensitivity metric and provide a natural scale for        damping spurious signals from belowsensitivity mRNAs        Using previously published replicated experimental        hybridizations and new simulated data we compare the        reproducibility and accuracy of frequency scaled frequency        and global normalization Our results suggest that scaled        frequency normalization is a useful strategy for        oligonucleotide array data and has important advantages        over current approaches                    Results and discussion                  The constantmean assumption          A key assumption underlying global normalization is          that the mean expression level on an array should be the          same for all samples and all arrays This assumption is          distinct from the additional implicit assumption that the          fraction of polyadenylated mRNA per total RNA is          constant One can certainly construct special cases where          the constantmean assumption is invalid One example          would be using a small array containing only genes from a          single pathway in an experiment that studies variable          induction of that pathway However it is unclear how          well even more general array experiments satisfy this          assumption          To evaluate the constantmean assumption we examined          the coefficient of variation CV of the mean expression          level of variablesized mRNA sets across samples covering          widely divergent developmental stages of the nematode           Caenorhabditis elegans We          constructed the largest possible subset of our data that          included only matched triplets of the A B and C array          designs see Materials and methods The subset comprised           chip hybridzations  of each design covering all          developmental stages This dataset represents a          relatively strong test of the constant mean assumption          because very large biological modulation of many mRNAs          occurs across the dataset As the           C elegans arrays monitor around           of all predicted           C elegans mRNAs and the sum of          the relative expression levels of all expressed genes          must be constant by definition global normalization is          well justified for the dataset as a whole Thus the           experimental hybridizations of each array design were          globally normalized and subsets of the  total          mRNAs monitored by the arrays were selected at random          For each subset the CV of the mean expression level of          the subset across all  hybridizations was computed          Subsets ranged in size from  to  genes  to           of this transcriptome Figure  The CV of the          mean expression level is below  for any set of mRNAs          larger than roughly  of the total As this CV is no          larger than the typical contribution of other noise          sources in the readout we conclude that the          constantmean assumption can be supported for arrays that          monitor on the order of  of a transcriptome This          is typical of current commercial arrays for several          bacteria yeast mouse and human          These results only apply when genes monitored by an          array are randomly selected with respect to their          expression characteristics The example noted above all          genes on an array from a single pathway is an extreme          case of nonrandom selection Other common ways of          selecting genes for arrays may also violate this          assumption including selection based on matches in          specific cDNA libraries          Nonrandom selection of even large mRNA sets for          individual arrays can also lead to betweenarray          inconsistencies in mean expression level For example          consider the case of two arrays each monitoring a large          equal percentage   of a transcriptome where the          first array monitors mRNAs with confirmed cDNA library          matches and the other array monitors mRNAs whose          sequences are based on lowerquality expressed sequence          tag EST sequence matches or computational gene          predictions While the constant mean assumption is          justified for each array in isolation comparison of          globally normalized expression levels between the two          arrays will give erroneous results because the mean          expression level of transcripts on the first array is          higher than that on the second                          Spikein based normalization          The limitations of global normalization suggest the          use of spiked transcripts to normalize array data Our          spikein normalization method which we call frequency          normalization uses spiked transcripts for two purposes          First they allow us to calibrate the arrays          transforming AD to cRNA frequency F estimates quoted in          transcripts per million Second the spiked transcripts          enable us to estimate the minimum detectable frequency on          the array the array sensitivity value The array          sensitivity is useful as a qualitycontrol metric for          individual hybridizations and is also used to adjust          signals from lowlevel transcripts Specifically          frequency values below the array sensitivity are averaged          with the sensitivity estimate to generate damped          frequencies that lie between  and  of the array          sensitivity This adjustment introduces a small          systematic error into the damped data but in return it          eliminates problematic negative values and retains          lowlevel readings that can be biologically informative          in the context of additional experiments          Figure shows a typical plot of the spiked transcript          readout from a single hybridization containing  g of          cRNA and a corresponding amount of spikein transcripts          The specific hybridization intensity AD value for each          of the  spikein controls is plotted as a function of          transcript frequency in units of transcripts per million          The points are fitted with a generalized linear model          that is then used as a calibration curve to compute          frequencies from the AD values of the other genes on the          array Using logistic regression we define the chip          sensitivity as the frequency where we estimate a gene to          have a  probability of being called Present We will          use the capitalized terms Absolute Decision Present          Absent and Marginal when referring to a specific          value that is calculated by the Affymetrix GeneChip          software described in Materials and methods In Figure           the vertical line at a frequency of  indicates the          computed sensitivity estimate for this array          Fitting a power law model AD  k           F           n  to the data in Figure yields          the exponent           n   This indicates mild          curvature in the response consistent with progressive          saturation of array readout for the highest abundance          mRNAs Experiments using  to  g cRNA per          hybridization with corresponding amounts of spikein          transcripts as well as high and low gain settings on the          scanner indicated that readout saturation not          hybridization saturation accounted for most of the          observed curvature in the spikein response The use of          approximately  g cRNA in each hybridization or reduced          scanner gain largely eliminated saturation with no          penalty in sensitivity                          Scaled frequency normalization          Frequency normalization is appealing theoretically and          effective even when the constantmean assumption is known          to be invalid However our experience suggests that          frequency estimates might be biased by experimental          limitations on the accuracy with which control          transcripts can be spiked into cRNA Specifically          because of the combination of small fluidhandling          uncertainties and potentially larger variation in the          purity of cRNA preparations the actual ratio of the          spiked transcripts to cDNAtemplatederived cRNAs might          be significantly skewed from one array to another One          source of variable impurities in cRNA preparations could          be oligodTprimerdependent cRNA product   Such          cRNA impurities would result in erroneous normalization          in which all readouts from one array would be          systematically higher or lower than those from another          array We use the term spikeskew to denote this          multiplicative skew in frequency values among multiple          hybridizations One expected symptom of spikeskew would          be replicate hybridization readouts that are highly          correlated but have widely divergent mean expression          levels          We developed the hybrid scaled frequency F s          normalization method to mitigate the effects of          spikeskew F snormalization is based on the principle of          removing technical variation in the ratio of spiked          transcripts to cDNAtemplatederived cRNAs by averaging          the response to spiked cRNAs over multiple          hybridizations To compute F svalues globally scaled          average differences are first computed for all arrays in          a set This initial step implicitly makes the          constantmean assumption A calibration function is then          computed by fitting a single linear model to the scaled          average differences of all spiked cRNAs on all the arrays          in the dataset pooled together Individual array          sensitivities are still computed as described above and          the same damping of lowend frequencies is carried out          using the sensitivity values for each array          To compare F and F smetrics consider an experimental          set of ten arrays To compute F values ten linear models          are fitted to the ten distinct unscaled AD responses to          the spiked cRNAs yielding ten different calibration          factors one for each array In contrast when computing          F svalues a single linear model is fitted to the pooled          spike response curve consisting of     globally          scaled AD values and a single calibration factor          generated for all ten arrays If there was no technical          variation in the ratio of spiked transcripts to          cDNAtemplatederived cRNAs in the ten experiments both          approaches would give the same quantitation up to a          random error term arising from the difference between          fitting ten point responses versus a single point          response If in one of the ten arrays the ratio of          spiked transcripts to cDNAtemplatederived cRNAs is          different for technical reasons then spike response for          that array will be skewed and the Fmetric readout for          that array will be skewed relative to the other nine          arrays In contrast such a skewed array will only affect          the F smetric to the extent that the single skewed          response shifts the fit to the pooled spike response The          skew for the single problematic array will be removed          because all arrays in the set will be scaled and          calibrated with a single factor In other words F          svalues are estimates of transcript abundance in cRNA          based on the average response to the spiked cRNAs over          multiple hybridizations and on the sensitivity of each          individual array F values provide the same estimate but          based solely on the response to spiked cRNAs in a single          array hybridization                          Comparison of normalization methods          reproducibility          We compared the performance of four metrics AD          globally normalized AD AD s frequency F and scaled          frequency F s The basis for comparison was          experimental data consisting of four sets of replicated          hybridizations each           n   or  of the same array          design the           C elegans A array Performance of          each metric was measured by the median absolute          coefficient of variation MEDACV of probe sets across          the replicated hybridizations MEDACV is a measure of          reproducibility for which a value of zero indicates          perfect agreement of all transcript readouts in a set of          replicated hybridizations We compared MEDACV for two          classes of mRNAs those called Present in at least  of          replicated hybridizations referred to as Present          mRNAs and those Present in fewer than  of the          replicated hybridizations referred to as Absent          mRNAs All metrics showed higher worse MEDACVs for the          lowabundance Absent mRNAs than for the higherabundance          Present mRNAs Figure  as expected from the presence          of background noise on the arrays For Present genes AD          swas more reproducible than AD as expected Scaled          frequency F s was as reproducible as AD sfor Present          genes in all replicate sets and yielded trivially higher          reproducibility than AD sfor Absent mRNAs owing to          damping of background noise Frequency appeared          equivalent to F sand AD sin the first set of experiments          the hour timepoint but had a higher MEDACV than F sin          the other three replicate sets We also computed Pearson          correlation coefficients for the same replicate readouts          Unlike MEDACV correlation coefficients between replicate          readouts were similar for all metrics in the range from                    To better understand the reasons for the markedly          different MEDACV performances of the four metrics on          experimental replicates we performed simulations These          simulations incorporated several adjustable noise          parameters We estimated values for these parameters          iteratively based on experimental data see Materials          and methods The similarity in the CV distributions of          experimental and simulated data indicated that for our          purposes the simulations recapitulated the major error          properties of real array data Figure           We tested if spikeskew could account for the          relatively high CV of frequency in three of the four          replicate sets Figure  by comparing experimental data          to simulated data with known levels of spikeskew To          approximate spikeskew the concentration of the spikein          transcripts in simulations was multiplied by a random          noise term Over a series of simulations we varied the          standard deviation of the noise term from  to  to          model the effect of increasing spikeskew MEDACV values          were then computed from the simulation results in the          same way as for the experimental data in Figure           As expected only frequency was sensitive to          spikeskew Figure  The F smetric which uses a single          standard curve pooled from each dataset to normalize all          arrays in that dataset effectively eliminated spikeskew          effects In the simulations a spikeskew level of           led to MEDACV values for frequency in simulated          replicates that were much higher than those of AD sor F          s These results were highly reminiscent of the            and  hour experimental replicate sets compare Figures          and           Taken together the experimental data and the          simulations suggest that spikeskews of roughly  can          explain the sometimes inferior MEDACV but consistently          high interreplicate correlation coefficients of the          frequency metric                          Comparisons across array designs          We next considered the reproducibility of readouts of          the same mRNA on different array designs For this          analysis we selected the three mRNAs that were monitored          by identical probe sets on each of the A B and C array          designs and were called Present in all hybridizations of          the  hour cRNA sample The observed CV of the AD smetric          was in all cases larger than that of the F or F smetric          and was greater than  for all three mRNAs indicating          very poor agreement of readouts from different array          designs when global normalization was used Figure  In          contrast the CVs of both F and F smetrics were lower          with CVs for F sin particular averaging  range           The mRNA KC was expressed at           fold lower levels than either of the other two mRNAs          and thus had higher CV values for both F and F sthan the          other two mRNAs Comparison of the acrossarraydesign          CVs to the withinarraydesign CVs for the three          transcripts in Figure indicates that the reproducibility          of AD swas substantially poorer when comparing across          array designs rather than within arrays Specifically AD          sacrossarray CV was  to fold higher than the          withinarray CV In contrast the acrossarray CV for F          swas only  to fold higher than the corresponding          withinarray CV Table           The reason for the poor agreement of AD sreadouts          across distinct designs was that the mRNAs monitored by          the A array are on average expressed at higher levels          than those on the B or C array as confirmed by two          independent lines of evidence First the mRNAs on the A          array were intentionally selected because they were          represented in           C elegans cDNA libraries whereas          the B and C array genes many of them computational          predictions were generally not represented in cDNA          libraries Second A array mRNAs were more likely than B          or C array mRNAs to be detected in the developmental time          course by the Affymetrix Absolute Decision metric            Because of this systematic difference between gene sets          the mean AD of all A array genes was substantially higher          than that of the genes on the B or C arrays The AD          smetric scales data under the assumption that mean          expression levels for all arrays should be equal          Therefore AD svalues for genes on the B and C arrays          were inappropriately inflated relative to AD svalues from          the A array                          Comparison of normalization methods          accuracy          Normalization methods should accurately measure true          biological variation We tested the accuracy of the four          methods using simulated data As a baseline we chose the          experimental data from one of the hour replicates on          the A array We generated  simulated experimental          conditions to produce  raw average difference values          for each of  genes For each of the four metrics          computed foldchanges between the modulated condition and          the baseline considering only messages called Present          were compared to the true foldchanges Accuracy was          defined as the fraction of computed foldchanges that          were accurate within twofold and determined for assumed          levels of spikeskew from  percentage is the ratio          of standard deviation SD to mean of the random          spikeskew term in the simulation Three simulations          were carried out at each level of assumed spikeskew AD          sand F smetrics performed equally well and best overall          with accuracies above  regardless of spikeskew As          expected frequency was the only metric with a          significant dependence on the level of spikeskew At           spikeskew frequency accuracy was mean  SD             at     and at     For          comparison the accuracy of AD was    at           spikeskew and did not change significantly at higher          spikeskew levels          We stress that the overall accuracy levels reported          here are highly dependent on adjustable parameters in our          simulation model see Materials and methods          Nevertheless the simulations demonstrate that at levels          of spikeskew consistent with our experience scaled          frequency is as accurate as globally normalized AD s          this observation is robust to changes in the model          parameters                          Absolute quantitation of cRNA and cellular          RNA          There are several potential sources of inaccuracy in          the cRNA quantitiation given by the scaled frequency          metric          Our results suggest that there is significant          uncertainty in the molar ratio of spikein mRNAs to          templatederived cRNAs in any hybridization the          spikeskew effect The MEDACV for the F metric in Figure          is likely one measure of this uncertainty as it          probably arises primarily from cRNA purity variation          This uncertainty leads to proportional differences          between frequency metric readouts and true cRNA          transcript abundances However in the scaled frequency          method the simultaneous normalization of larger datasets          reduces these differences through averaging We          anticipate that inaccuracies of cRNA quantitation arising          from this effect will be reduced by improved methods for          quantitation of cRNA preparations          For F and F s heterogeneity in probe response will          lead to genespecific biases in quantitation Our data          contains two observations that allow us to estimate the          degree of heterogeneity among spiked probe sets Cursory          examination of the calibration curve Figure  suggests          relative responses of the  distinct probe sets shown do          not vary more than twofold no observations fall more          than about a factor of two from the fitted line A more          rigorous evaluation of probe set heterogeneity can be          done by comparing the ratio of AD values from two          distinct probe sets that monitor the same transcript in a          single hybridization This ratio estimates the difference          in readout that would be observed for a single transcript          if a different probe set were selected This comparison          was made for the  spiked transcripts each array          contained two probe sets for each of these mRNAs On the          basis of  ratio measurements from the           C elegans arrays the thth          percentile range for the ratio was             indicating that for the set of control transcripts the          uncertainty in cRNA quantitation due to heterogeneity in          probe set responses for  of transcripts was less than          threefold          In addition to these factors leading to inaccuracies          in cRNA quantitation there are at least two important          factors leading to differences between cRNA abundances          and cellular RNA abundances in the starting biological          material          First because cRNA is generated from the          polyadenylated fraction of total cellular RNA by a linear          amplification process frequency estimates will not          reflect samplespecific changes in the fraction of          polyadenylated RNA in total cellular RNA This may be a          desirable feature of frequency estimates in cases where          pertotalRNA abundance is less relevant than          perpolyadenylatedRNA abundance          Second any genespecific biases in the cRNA          amplification procedure will lead to genespecific          differences between cRNA and pertotalRNA          quantifications Evidence to date suggests that these          biases are small   and reproducible            Taken together the abovenoted sources of inaccuracy          suggest that there can typically be around two to          threefold differences between scaled frequency percRNA          estimates and perpolyadenylatedRNA abundances in the          starting material These differences could be reduced by          improved cRNA process control and quantitation and by          improved probe selection algorithms                            Conclusions        We have shown that cRNAs spiked into hybridization        solutions at known concentrations covering two to three        orders of magnitude can be used to normalize array data and        to estimate array sensitivity However frequency        normalization based solely on these control transcripts can        be adversely affected by variations in the purity of cRNA        preparations These observations underline the need for        meticulous quality control during the production of cRNA        samples and accurate quantitation of the resulting        material With better control of these processes the        frequency metric may provide a robust spikebased        normalization that unlike all the other metrics described        here does not rely on the constantmean assumption        In the presence of variation in cRNA purity the F        smetric provides a compromise between the robustness of the        AD smetric and the more absolute quantitation scale of the        frequency metric in cases where the constantmean        assumption is valid In addition the F smetric provides a        common scale for comparing data from distinct array        designs This is an important advantage over other metrics        For example the F smetric allows comparison of the        expression levels of all worm mRNAs on all three of our        array designs with comparable confidence to        withinarraydesign comparisons This is not possible with        globally normalized average differences We believe that        cRNA quantitation and the damping of lowamplitude signals        provided by the F snormalization make this metric a        valuable format for reporting diverse gene expression array        results                    Materials and methods                  Experiments and arrays          Array experiments used the Genetics Institute           C elegans Affymetrix GeneChip          oligonucleotide arrays a set of three arrays denoted A          B and C which in aggregate monitor approximately  of          the  predicted worm mRNAs in the October  worm          genome sequence release   The total number of probe          sets on each array was  A array  B and           C Each probe set consists of  distinct probe          pairs each probe is a mer designed to monitor a          single transcript On the           C elegans arrays described here          probe sets monitoring the spiked transcripts were each          tiled twice with a different set of oligonucleotide          probes On arrays that are commercially available from          Affymetrix one probe set is tiled to monitor each of the          spikein transcripts The probe sets are not fully          randomly distributed across the arrays although on the           C elegans arrays the different          probe sets are tiled in widely different regions of the          arrays Experimental array data described here were taken          from the developmental time course dataset reported in            Specifically we examined individual replicate          hybridizations of the A array from the worm developmental          time course at each of             n               n               n   and             n   hours after synchronization          of worm eggs by bleach as well as a larger set of           hybridizations of all three arrays to samples ranging          from oocytes to weekold worms Replicate          hybridizations in the datasets included independently          generated complementary RNA cRNA preparations from the          same starting total RNA Primary data for all transcripts          on all arrays including all replicates of all three          array designs is contained in the supplementary Excel          spreadsheet see Additional data files                          Spikein transcript pool          A pool of biotinlabeled spikein control transcripts          was derived by           in vitro transcription of  cloned                    Bacillus subtilis genes using the          methods described in   The spikein pool was added          into hybridization cocktails in proportion to the          UVquantitated cRNA mass in the hybridization so as to          achieve the desired final concentration of spikeins The          spiked transcripts and their final concentrations in the          hybridization cocktails are listed in Table  Final          concentrations in pmol and parts per million ppm for          each spiked transcript were computed from the known          length of each spikein assuming a total mass of  g          worm cRNA in a  l hybridization volume and an          average length of  bases for           in vitro transcribed worm          cRNAs                          Metrics for transcript abundance          Average difference AD is the basic measure of          transcript abundance that is calculated by the Affymetrix          GeneChip  software The calculation of AD is described          in detail in the Affymetrix GeneChip User Guide            Briefly a background intensity is computed for each of           rectangular sectors on the array This local          background is subtracted from the intensity values of          each probe cell in all sectors After background          subtraction the difference between perfect match PM          and mismatch MM feature intensity is calculated for all          probe pairs in each probe set in our case  probe          pairs in total The AD for each probe set is the average          of the PM  MM differences after outlying values are          removed          A second important metric generated by the GeneChip          software is the Absolute Decision The Absolute Decision          is a categorical call for each transcript either          Present Absent or Marginal The Absolute Decision is a          heuristic metric based on the number of probe pairs for a          given transcript that show strong specific hybridization          signals See the Affymetrix GeneChip User Guide   for          a detailed description of this metric          Because of arraytoarray variation in overall signal          strength AD values from different arrays are usually          normalized to a common scale We reproduced the scaled AD          normalization of the Affymetrix GeneChip  software          The calculation is described in detail in the Affymetrix          GeneChip User Guide   Scaling is done by equalizing          the average intensity of all arrays in a given dataset          where the average intensity is defined as the trimmed          average of the AD values of every probe set on the array          excluding the highest  and lowest  of the values          This normalization works on the assumption that the          summed expression level of all genes on the array is          constant across experiments and that differences in          expression levels between arrays can be corrected by          arrayspecific scaling factors We denote the normalized          AD values as scaled average difference AD s          The calculation of frequency F values involved two          steps first conversion of AD values to frequencies by          use of the calibration curve and second estimation of          the chip sensitivity of detection and damping of          frequency values below this sensitivity          The calibration curve for each hybridization was          constructed from the AD values for each of the  control          transcripts and their known frequencies Table  AD          values that were negative or associated with Absent or          Marginal Absolute Decisions were removed from the curve          in order to improve the robustness of the fit This          calibration curve was fitted by a linear function with          zero intercept using a generalized linear model            fitting procedure in the statistical software SPLUS          Insightful Corp Seattle WA The fitting procedure          assumed a gamma error structure appropriate for data          with constant coefficient of variation and utilized          iterative reweighting of errors The single coefficient          of this linear fit was multiplied with the average          difference values for each gene on the array to yield          initial frequency estimates Calibration curves for the          hybridizations described here were examined visually to          rule out poor curve fits          Chip sensitivity of detection was estimated from the          Absolute Decisions Present Marginal or Absent for the           spikein transcripts in one of two ways In the          general case Absolute Decisions were considered as a          binary response Absent   Present   with Marginal          calls treated as Absent to be conservative This response          was regressed against the logtransformed known          frequencies using a generalized linear model with a          logit link function The chip sensitivity was then          defined as the frequency at which the predicted odds of a          Present call were  In the special case where all          spikein mRNAs called Absent were lowerabundance          messages than all spikeins called Present the          sensitivity was defined by linear interpolation as the          frequency  of the distance between the highest Absent          call frequency and the lowest Present call frequency          Frequency values for all genes on the array that fell          below the sensitivity were damped as follows Negative          frequencies corresponding to negative AD values were          adjusted to onehalf of the chip sensitivity Frequencies          between zero and the chip sensitivity were adjusted to          the average of the frequency and the chip sensitivity          The rationale for this adjustment was threefold First          onehalf the chip sensitivity was a reasonable           a priori estimate of abundance for          many genes that were not reliably detected Second the          adjusted frequencies were guaranteed to be          positivevalued making downstream analyses of frequency          values for example log transformation significantly          easier Third retaining the adjusted lowlevel frequency          estimates was preferable to discarding them because          discarding the values would make it impossible to detect          potentially important regulation of these genes in future          experiments          Frequency normalization could be adversely affected by          technical uncertainties in cRNA preparation see Results          and discussion To attenuate these effects an          additional frequency variant termed scaled frequency F          s was introduced F swas a hybrid of ADs and frequency          and was computed as follows AD swas first computed for a          set of two or more arrays exactly as described above          Then a linear model with zero intercept was fitted to          the pooled AD svalues for the  spikein transcripts          from all arrays ignoring negative AD svalues or those          associated with MarginalAbsent Absolute Decisions The          slope of this linear model was the single calibration          factor for the entire dataset This slope was multiplied          with the AD svalues from all arrays to yield F svalues          Perarray sensitivity values were computed exactly as          described for F and F svalues on any array that were          below the array sensitivity were adjusted as described          above                          Simulated data          Array data was simulated as follows First a single          experimental dataset one of the hour replicates was          chosen as a baseline for generation of all simulated          data To this baseline dataset several random noise          sources were added to reproduce key sources of          variability in array data The relation describing the          simulated data was                    AD                       ij                       b                       ij                       ADB                       i                       a                       j                      m                       ij                      s                       ij                      r                       ij                      where                    AD                       ij             simulated AD for the           i th mRNA on the           j th array                    ADB                       i             baseline gene expression data for the           i th mRNA                    b                       ij             background noise for the           i th mRNA on the           j th array                    a                       i             array intensity offset for the           j th array                    m                       ij             multiplicative noise for the           i th mRNA on the           j th array                    s                       ij             spikeskew factor for the           i th mRNA on the           j th array unity for all nonspiked          mRNAs                    r                       ij             regulation factor for the           i th gene on the           j th array unity for all spiked          mRNAs          Background           b                       ij            was Gaussian with a standard deviation SD that          varied randomly from one array to another The background          noise SD had a mean of  AD units and a standard          deviation of  AD units Array intensity offsets a                       j            were Gaussian with a mean of one and SD of           Multiplicative noise           m                       ij             was drawn from a normally distributed zeromean          noise source with a constant CV of  Spikeskew factor                    s                       ij            was a single random factor for all spiked cRNAs on a          given array and unity for all other messages The          spikeskew factor for the spiked cRNAs was Gaussian with          mean  and a SD that was adjusted from  to  in          percentage terms  Regulation factors r                       ij            were generated by a procedure in which the base          log foldchange for each gene was selected from a          normal distribution with mean  and SD  Extreme          random regulation factors were limited so that the          regulated gene expression values had the same range as          baseline data After multiplication of each gene by its          regulation factor the mean expression level of all genes          was adjusted so that the overall mean expression level          was unchanged by regulation                            Additional data files        Primary data for all experimental hybridizations are        available as an Excel spreadsheet Kb        Additional data file         Primary data for all experimental hybridizations        Primary data for all experimental hybridizations        Click here for additional data file            