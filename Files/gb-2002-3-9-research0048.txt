                    Background                  Linear normalization methods          Linear methods are the predominant means of microarray          normalization Scaling the simplest linear approach          assumes a linear relationship passing through the origin          Forcing array distributions to have the same central          tendency arithmetic mean geometric mean median can be          accomplished by a scaling factor and has been the method          chosen by Affymetrix and others   Linear regression             and general linear modeling such as ANOVA             provide offsets scaling factors and other parameters          but again assume linear relationships and properties of          the data or log data distributions such as normality          that are not always true In all cases linear approaches          will fall short when the signal bias is not linear          Approaches for twochannel cDNA arrays apply scaling          in order to zero a central tendency of the log expression          ratios     These approaches may also be          applied to pairs of singlechannel oligonucleotide          arrays Applying an additive offset to the log data is          equivalent to a multiplicative scaling of one channel          before taking the log Moving the median or mode of the          logratios to zero makes the assumption that the majority          of genes are not differentially regulated Additional          steps may scale the logratios by a measure of dispersion          such as the standard deviation or median absolute          deviation MAD possibly grouping spots according to the          printingtip This is equivalent to raising both channels          to a power before taking the log and is therefore a          nonlinear transformation of the original signals though          giving rise to a linear transformation of the          logsignals Unfortunately systematic biases are not          always linear in logspace either                          Nonlinear normalization methods          Nonlinear normalization methods have been shown to          control signaldependent nonlinear bias between Cy and          Cy channels of cDNA arrays    The promising          approach of Yang           et al   uses lowess local          regression   directly to paired data as a function of          signal intensity For the cDNA data used by Yang           et al and Tseng           et al    lowess was used          for local linear regression of log           R log           G  versus log           R   log           G  where           R  and           G are the intensities of the Cy          and Cy channels respectively Rather than regressing          log           R  directly to log           G  these approaches correctly          attribute uncertainty to both channels by regressing to          the geometric mean of the intensity Even so standard          regression techniques can be sensitive to outliers which          are likely to occur in microarray data Robust regression          techniques as found in the R version of lowess            are relatively insensitive to outliers Robust regression          techniques incur significant computational costs and in          practice a small random sample of data must be used for          todays oligonucleotide arrays The approach taken by          Tseng           et al   and Schadt           et al   addresses the outlier          issue by selecting nonregulated features based on a rank          invariant criterion where all signals from both arrays          are sorted and signals with ranks deviating by less than          a threshold are included Normalization of replicate          arrays raises the question of which signals should be          excluded when none of the genes are differentially          expressed In the method we will describe no data need          to be excluded for curve fitting and it is therefore          global and unbiased by subset selection                          Signaldependent nonlinear normalization          The goal of signaldependent normalization is to make          signal distributions comparable across the intensity          range This suggests that the expectation for the          difference of paired measurements or logratios should          not significantly deviate from zero anywhere over the          intensity range Again this is the motivation for          centering Cy to Cy logratio distributions of cDNA          arrays but now we consider multiple arrays If the          logratio distributions between arrays or color channels          are to be centered across the intensity range then the          resulting correlation will be linear with intercept zero          and slope one The resulting data correlation will retain          stochastic noise and more important the biological          variation This linear data correlation presupposes that          the distributions of signals be roughly the same Our          approach seeks to transform the distribution of one array          to the distribution of a target array in order to achieve          this goal If the target array is chosen to be the          geometric mean probe intensities over the arrays in an          experiment then each array distribution is fitted to an          empirical estimate of the signal distribution for the          experiment In principle any measure of central tendency          may be used although the geometric mean is a natural          extension of existing cDNA methodologies Alternatively          each array can be fitted to the theoretical quantiles of          a known distribution for example the lognormal          distribution This approach was not chosen here as the          observed distributions did not fit a theoretical model          and contained well determined systematic features In          this work we seek only to make the distributions similar          to each other whatever those distributions may be          For Affymetrix data all the arrays of an experiment          can be used to define a target array and thus a target          distribution that all arrays are normalized to As a          result of the dye effects data from twochannel cDNA          arrays display significantly different Cy and Cy signal          distributions suggesting that means calculated over both          signal types may not make sense for the definition of a          target distribution Instead either the geometric mean          of the Cy or Cy channels are used and all channels          from all arrays are normalized to a single Cy or Cy          distribution This accomplishes both Cy to Cy          normalization within and between arrays The approach          described here can be used to normalize the Cy channel          to the Cy channel within a single array or may also be          applied to pairs of Affymetrix arrays                          Qspline normalization          The normalization method described in this work          qspline uses quantiles from array signals and target          signals           x and           v  to fit smoothing Bsplines The          splines are then used as signaldependent normalization          functions on the signals of           x  The target signals can be from          another array or could be means calculated from multiple          arrays as just described Splines are a natural and          robust choice in that they are capable of representing          almost any smooth relationship and will also work well if          data is linearly related Using quantile information          provides a much easier fitting problem and avoids          directly fitting the pairwise data which often requires          robust regression techniques An example oligonucleotide          array signal distribution and quantile comparison can be          seen in Figure                           Spatial normalization          Spatial heterogeneity of signal can be observed in          microarray data and in particular in cDNA microarray          data Variability in CyCy ratios has been shown to be          generated in part by the specific printtip used during          the spotting of the cDNA probes   In fact an Ftest          found that at least one printtip was very significantly          correlated to logratio log           p value less than  in all          cDNA arrays used in this study Spatial effects are not          only caused by the printing device but may also be          related to temperature or humidity during the time of          printing the batch of cDNA represented by a specific          microtiter plate reagent flow during the washing          procedure after hybridization or from uneven or tilted          glass surfaces during scanning Microtiter plate effects          can appear as vertical or horizontal bands across the          array whereas other effects may generate smooth gradients          of arbitrary orientation Signal gradients can be          normalized by subtracting local signal estimates log          intensities or logratios and a preliminary approach for          this was tested          These effects though not as significant as the Cy          Cy bias can be quite pronounced as will be observed in          the           A thaliana microarrays          Oldergeneration Affymetrix arrays like those used in          this study were subject to local signal biases due to the          adjacent placement of probes for each geneprobe set          This bias has since been corrected in more recent          oligonucleotide array designs Other spatial biases can          be observed for Affymetrix arrays and are best described          as smooth gradients                          Normalization comparison          Logintensity scaling lowess and invariant set          normalization approaches were compared to qspline for the          reduction of variation between replicate arrays in          oligonucleotide and cDNA array experiments Six          microarrays were used for each of the HIV and           B subtilis studies Three control          replicate and three treatment replicate singlechannel          arrays were used in the oligonucleotide array study of          HIVinfected Tcells Six replicate twochannel cDNA          arrays provided six control and six treatment channels          for each           B subtilis study In addition a          pair of dyeswapped replicate arrays from           A thaliana were also normalized to          investigate the various normalizations methods versus          dyeswap normalization          The lowess normalization method for cDNA array data          was taken from the Rarray module of the sma package          version    and was used for the normalization          of all cDNA microarray data sets For oligonucleotide          array data a lowess method was adapted from Raffy module          of the sma package Instead of averaging all pairwise          array regressions on a single random sample of feature          pairs iterative regressions between an array and the          target array were averaged using a new random sample for          each iteration The former method tended to significantly          undernormalize whereas the adapted method used          essentially the same procedure but performed          significantly better          In addition to printtip normalization for cDNA          arrays a spatial gradient normalization was devised          using a twodimensional Gaussian function This function          was used to estimate local background bias over a window          of probes for the logratios of cDNA and oligonucleotide          array data Logratios for oligonucleotide array data          were calculated versus the geometric mean of each probe          across arrays as will be seen throughout this work          Lastly although it is only a matter of preference we          used log base  throughout                            Results                  Global assessment of normalization          The assessment of normalizations was first observed          for global features such as absolute signal distribution          and relative signal distribution Absolute signals result          from the image analysis and are the values extracted from          the pixel intensities of each spot whereas relative          signals are logratios of absolute signals versus          measured or calculated background probe signals The          absolute signal distributions of the six oligonucleotide          arrays can be seen in Figure for the HIV perfectmatch          PM distributions and           glnA Cy           G and Cy           R distributions experiments both          before and after normalization Distributions for          replicate arrays or replicated Cy Cy channels are          shown in the same color          Figure shows that signaldistribution inconsistencies          between replicate oligonucleotide arrays are comparable          to those between treatments For this example          distribution discrepancies appear minor though we have          encountered Affymetrix experiments showing dramatically          disparate distribution profiles Scaling by the trimmed          mean of PMmismatch MM as done by the Affymetrix          GeneChip software MAS  was observed to separate PM          intensity distributions more than is observed for          unnormalized data and was not considered in this study          Newer versions of the Affymetrix software MAS           incorporate additional logintensity scaling routines          that improve normalization performance but were not          investigated in this study Logintensity scaling used in          this comparison also did not make signal distributions          more comparable than the unnormalized case Both lowess          and invariant set normalization methods resulted in          similar array distributions whereas our version of          lowess normalization gave more comparable distributions          than the Raffy version The qspline normalization          resulted in the most similar array distributions which          are indistinguishable from each other in Figure           Normalized array distributions for the two cDNA          experiments showed a similar trend although cDNA array          distributions strongly depended on the cyanine dye and in          all cases distributions were much less smooth The dye          bias can clearly be seen in the unnormalized Cy and Cy          signal distributions shown in green and red respectively          in Figure  Both global and scaled printtip lowess and          qspline normalizations showed similar signaldistribution          comparisons Lowess and qspline normalizations generated          more comparable Cy and Cy distributions than scaling          alone whereas qspline methods generated the most similar          signal distributions          The effects of normalization on the relative signal          distributions log           x                       i                       v  are shown in Figure for both          oligonucleotide and cDNA arrays for the same          normalizations shown in Figure  These probedeviation          distributions show the variability from each           v calculated over all the channels in          an experiment and therefore show logintensity deviations          from the experiments centroid The original signal          intensities are lost in these plots of relative          information but global biases can still be seen          Comparable decreases in global array bias were observed          for lowess qspline and invariant set normalized results          Systematic differences between cDNA Cy and Cy channel          distributions can be seen before normalization but          display similar distributions after signaldependent          normalization By visual inspection printtip scaling          followed by qspline normalization resulted in the          greatest decrease of relative signal bias for the cDNA          array data Little if any difference was observed between          global lowess and scaled printtip lowess with regard to          relative signal distributions The same was observed for          the two variants of qspline suggesting that printtip          effects are much smaller than the global biases The same          trends were observed for the four channels of the          dyeswap replicate cDNA arrays          Quantitative results in Table confirm the          observations from the distribution analysis Variances          were estimated within each control or treatment group and          served as a measure of replicate error Oligonucleotide          arrays showed large decreases of from  to  in          replicate error for all normalization methods whereas          cDNA replicate errors showed decreases of from  to           depending on the normalization Reductions in variability          for lowess qspline and invariantset methods were          comparable for both treatment and control replicates of          oligonucleotide data The largest decrease in replicate          variability for the HIV experiment was observed for          qspline and invariantset normalization where both gave          decreases of  and  for control and infected          respectively Including spatial normalization after          qspline improved on these decreases by an additional           Results for the cDNA experiments showed that global and          printtip qspline provided greater reduction of replicate          error versus the lowess methods                          Signaldependent assessment of normalization          To visualize signaldependent bias Figure shows          logsignal deviations from           v versus signal intensity for each of          the three HIVinfected samples that is log           x                       i            log           v  versus log           v  As previously noted   MA          plots where Mlogxy is plotted versus          Alogsqrtxy for signals x and y contain the same          information as           xy correlation plots but are much          better at visualizing deviations from the identity line          This representation clearly shows the need for          signaldependent normalization between replicates and          similar results were found for the three control          replicates A comparison of normalization curves shows          differences between all normalization techniques and that          the signaldependent methods were able to correct for          nonlinearities in the log scale The comparison of          normalizing curves shows that the lowess method generated          smoother curves than the cubic spline methods qspline          and invariant set and that the splinebased curves were          very similar          The signaldependent biases for the individual          channels of cDNA array data can be seen for an example           glnA microarray in Figure after          printtip scaling lowess and qspline normalizations In          this case log           G  and log           R  signals are compared to mean          log           G  signals calculated over the six          arrays Although qspline normalized to signals calculated          from all six arrays normalization performance was          comparable if not better than the lowess method that only          used the Cy and Cy signals within each individual          array Additional examples can be found in the additional          data files available with this paper see Additional data          files and            Figure compares lowess and qspline normalization to          dyeswap normalization for replicate arrays A and B          where           G                       A            and           R                       A            were the control and mutant RNA samples on array A          and           G                       B            and           R                       B            were the mutant and control samples on array B          Dyeswap normalization effectively averages log          intensities within each sample type and is used to          calculate a single set of logratios log           R                       A                      G                       B                       G                       A                      R                       B             From Figure it is clear that dyeswap          normalization alone is not enough to account for          signaldependent biases for this example Either lowess          or qspline alone provided more effective normalization          than dyeswap averaging This was due to the fact that          in this case the dye bias was not consistent between          replicates and can be seen to be much worse in array B          Signaldependent normalization followed by dyeswap          averaging should provide significantly better results          than either approach alone          When the signalintensity range was separated into          quartiles the median logratio versus the probe means v          was plotted for each array and each quartile These          medians can be seen in Figure for the HIV           glnA and dyeswap experiments after          the various normalizations Separating these          distributions by quartiles shows the performance of the          normalization methods relative to signal intensity and          again confirms the effectiveness of the methods described          here The lowess methods used for cDNA data were only          employed to normalize within individual arrays and thus          signal differences can still be observed between arrays          The           RG logratio variability for each          array was found to be comparable for both single and          multiple array normalization strategies Again the          results from global and printtip methods were not seen          to differ          The distributions of           R            G logratios versus printtip can          be compared for an example           glnA array in Figure  After          global normalization a printtip dependence can still be          observed in most cases Scaling the individual Cy and          Cy logsignals before qspline normalization is shown to          correct for some of this effect although this method          does not directly scale the           R            G logratios The scaled printtip          lowess first performs regressions by printtip group          followed by tipgroup scaling of the logratios and not          surprisingly generates the most comparable printtip          logratio distributions The preliminary spatial scaling          technique also normalizes logratio information and can          be seen to generate comparable printtip logratio          distributions          Spatial effects can be more or less dependent on the          printtip group depending on the strength of the other          spatial effects Figure shows an example from the          dyeswap experiment where gradient effects tended to be          as large as the printtip effects Tipgroup          normalization alone can be seen still to contain spatial          bias within each tip sector Spatial logratio          normalization after global normalization can be seen to          give the most homogeneous logratio signals across the          surface of the array An example oligonucleotide array is          shown before and after spatial normalization along with          the values that were used for the normalization in Figure           The distribution of the logsignal differences used          for the spatial normalization had a MAD of  for          Affymetrix data compared to  for the cDNA array data          of the           glnA experiment suggesting that          spatial bias is more than ten times stronger for cDNA          array data                          Biological assessment of normalization          A set of genes was known to be differentially          regulated in the           glnA mutant strain of           B subtilis These  genes were          found to rank higher in a           t test analysis after          signaldependent normalization compared to rankings from          unnormalized and scaled logsignals Figure  A paired          Welch           t test was performed on the          individual Cy and Cy signals for each gene The top           ranking genes can be seen in Figure  where the genes          known to be differentially regulated are shown in          parentheses and up or downregulation is shown in red or          green respectively Unnormalized data rankings showed          only one of the  genes in the top  and overall these          genes had an average rank corresponding to the st          percentile as would be expected from randomly selected          genes Logsignal scaling shifted the rankings of these          genes to an average rank corresponding to the th          percentile whereas signaldependent normalizations          raised the average rank to correspond with the th to th          percentile nd to rd percentile for the median rank          Seven of the  genes can be seen in the top  after          scaled printtip lowess and qspline The spatial          normalization approach appears to adversely effect the          top  ranking genes though the resulting mean and median          ranks of the  genes were comparable or better than the          other approaches The lowest average rank was observed          for the global qspline method  percentile followed          closely by global and printtip lowess both at the           percentile The lowest median rank was seen for the          spatial normalization results  percentile followed          by global qspline  and printtip qspline                     t tests were applied to          geneexpression estimates calculated from the Li and Wong            reduced model for the oligonucleotide array data          Unfortunately the set of genes believed to be          differentially regulated due to HIV infection was found          to be randomly distributed throughout the two sample           t test rankings both before and          after different normalizations The overall effects of          normalization on the           p values can be seen for the HIV          and           glnA experiments in Figure  For          this comparison only the relative characteristics          between normalization methods are of interest The actual                    p values are not correct as a          result of multiple testing Log rank versus log           p value plots show differing          trends for oligonucleotide and cDNA array data          Unnormalized data show lower           p values for genes in the lower          half of the ranking in cDNA because of the dye bias and          lack of dye swapping over the six replicates and suggest          poorer signaltonoise characteristics Lack of          normalization in the HIV experiment showed less          significant           p values over all genes          Logsignal scaling showed slightly higher           p values whereas lowess invariant          set and qspline showed comparably lower           p values                            Discussion        Three important assumptions must hold for        signaldependent normalization methods The first two were        suggested by Zien         et al   in their linear        centralization approach the majority of genes are not        differentially regulated assumption  and the number of        upregulated genes roughly equals the number downregulated        assumption  The third assumption is that these two        assumptions hold across the signalintensity range        Assumption  was used as a justification for centering        logratio distributions and is likely to hold when an        unbiased selection of thousands of genes is measured If        assumption  is true then assumption  can be relaxed as        long as random effects on nondifferentially expressed        genes are equally positive and negative The third        assumption is important for signaldependent normalizations        and is supported by the intuition that genes with  to         mRNA copies per cell will be no more or less biased        toward up or downregulation than genes with  to         copies per cell Microarrays with a small number of        genes may be biased to over or underexpression and could        generate data that do not conform to any of the listed        assumptions We believe that future microarrays will only        include more features and genes making these assumptions        even more valid In coming years oligonucleotide arrays        for humans will contain all  genes or however many        there may be and therefore will not contain a biased        selection of genes        A potential fourth assumption motivates spatial or        pinspecific normalization and would state that assumption         should hold spatially across the surface of the array        These effects were observed to be more significant for cDNA        microarrays whereas global signaldependent biases        dominated over spatial effects for oligonucleotide array        data The MAD for the difference of logPM before and        after global normalization was  times larger than the MAD        of the difference between globally normalized and spatially        normalized  versus  For the         glnA experiment the spatial effect        as measured by a similar MAD was ten times larger than that        of the HIV experiment but still roughly ten times smaller        than the global cDNA effects  versus  Although        spatial effects may not always be significant        probespecific effects are a significant issue for        oligonucleotide arrays and must be addressed by other        techniques such as the method of Li and Wong   The        preliminary spatial normalization method presented in this        work will require further validation and development as the        current method by visual inspection appears to be        overfitting the cDNA data Probe placement and microarray        designs do not always correctly randomize strongly or        weakly expressed genes and may contain spatial biases that        should not be removed That said the ranking of genes        known to be regulated did not change significantly as a        result of this overfitting        The process of comparing and validating these methods        should depend most heavily on the biological assessment        Unfortunately this evidence was found to be the most        unreliable Genes from the list that were known to be        differentially regulated were found throughout the         t test ranking in both the HIV and        the         glnA experiments Statistical        measures such as reproducibility were less ambiguous but        showed similar performance for global and printtip        although clear printtip biases were present Each        microarray system presented different sources of bias and        in the end no one criterion was sufficient for assessing        whether microarray data was properly normalized Observing        global signaldependent and spatially dependent        distributions is recommended in all cases                    Conclusions        Assessments of normalizations were shown globally for        array signal and relative signal distributions as well as        for signaldependent MAstyle plots and medians of relative        signals by quartile In all cases these analyses showed        favorable results for lowess invariant set and qspline        methods Certain aspects of the splinebased methods make        it preferable to the other methods First the qspline        method is computationally more efficient than the lowess        methods second owing to the random sampling procedure        lowessbased methods will give slightly different results        for each data fitting whereas the spline methods are        deterministic and third the quantilebased approach of        qspline can normalize arrays with different numbers of        features Only through populationbased methods such as        qspline can arrays with different features be normalized        for signal dependent bias                    Materials and methods                  Tcell cultures infected with HIV          Ten million MT cells were incubated with either  ml          virus stock  multiplicity of infection MOI units of          strain IIIB or  ml mock virus for  h at C After          extensive washing the cells were transferred to  cm          Nunclon bottles in  ml culture medium RPMI  with           fetal calf serum and antibiotics and cultured at          C  CO            for  days Messenger RNA was          extracted using QIAGEN RNeasy Mini kit and prepared for          hybridization to Affymetrix HuGeneFL chips according to          protocols provided by Affymetrix          The Affymetrix HuGeneFL arrays contain about             PM MM probe pairs Probebased normalization was found          to work on both PM and pooled PM MM values although the          MM values were ignored in this analysis We believe that          MM values are unreliable indicators of          crosshybridization and can be shown to have a          confounding effect on all but the top  of the signal          intensity range Control features designed for grid          alignment spiked controls and ALU controls AFFX          humalu were removed                          Bacilluscultures on cDNA microarrays          Cells were grown at C in a modified Spizizen          saltbuffered minimal medium as described previously            supplemented with  gml Ltryptophan Na            SO            was used instead of NH                        SO            and glutamine  was added as          the sole nitrogen source At an OD    nm          approximately  ml of culture was harvested by          centrifugation at  rpm for  min The pellet was          resuspended in  l water and RNA was isolated from          this by the use of four tubes from the fastRNA kit blue          BIO  Carlsbad CA and as recommended by the          supplier cDNA synthesis dye coupling of probe array          hybridization and scanning were carried out as described          by DeRisi and coworkers protocol available at            RNA preparations were run in duplicate and each sample          was hybridized to triplicate arrays In all cases the          control RNA was labeled with Cy and treatment RNA with          Cy Each of the  genes was spotted on the array          twice which gave  measurements per gene per          experiment                          Microarray normalization          The variance within replicate group was estimated for          each normalization described below                    where           i is an index over           n probe signals and           j is an index over           m replicates                          Global scaling of log intensities          As a comparison with the signaldependent qspline and          lowess approaches a scaling of log intensities was          carried out as follows Probe intensities were          logtransformed in all cases we used log base  on          signalintensity data and a measure of central tendency                    c                       j             was calculated for each array and for the entire          matrix            c  The mean of the log values was          used but the median was found to work just as well Each          array was then scaled in the logspace to the global          mean log           x                       j                       c            c                       j             This simple transformation often accounted for          much of the variability between oligonucleotide arrays          The approach used on cDNA array data scaled each Cy and          Cy channel to the same central tendency with the          additional constraint that each printtip group also had          the same Cy and Cy central tendency                          Lowess normalizations          The Affymetrix normalization method found in the Raffy          module of the sma package uses the lowess function          loess with a robust local linear regression mode          symmetric The Raffy method performed all pairwise          normalizations between the six HIV arrays and averaged          the five results            m  for each array The process          was then repeated on the new data which resulted in           total fits for the six arrays Instead of averaging all          pairwise array regressions on a single random sample of          feature pairs the modified version averaged iterative          regressions between each array and the target array using          a new random sample on each iteration This resulted in           total fits for the six arrays The former method          tended to undernormalize and did not perform as well as          simple logintensity scaling The adapted method used          essentially the same procedure and code but performed          significantly better when used in this scheme          The six replicates for each           glnA and           tnrA experiment were normalized to          a prototype           v  denned by the median or geometric          mean of the six Cy channels used to measure the control          mRNA wild type By this method all  channels from          the six arrays were normalized to each other and at the          same time the Cy channels were normalized to the Cy          channels The cDNA normalization method found in the          Rarray module of the sma package uses the lowess function          lowess with analogous settings as described for          oligonucleotide array normalization Both global and          scaled printtip group lowess normalization were          performed norm  l and norm  s respectively The          scaled printtip mode performed lowess normalization for          within each printtip group and then scaled the          logratios of each group by its respective MAD                            Cubic spline normalization using quantiles          For this approach all signal channels are normalized          to a target array The same method was used for cDNA and          oligonucleotide array data          The geometric mean of each probe was calculated over          all arrays           x                       j             in the experiment                    where           j indexed over the           m   arrays and           i indexed over the           n probes          From each array and the vector           v   quantiles were taken           q                       j            and           q                       v            percentiles The size of the quantile sample          represented   of           n  Figure shows an example          comparison of array signal distributions           x                       j            and           v along with a quantilequantile plot          showing the correlation between the corresponding           q                       j            and           q                       v             Each           q                       v                       q                       j            pair was used to fit a cubic spline function           s                       j                       f            q                       v                       q                       j             where           f was a spline function generator          that fits the parameters of a natural cubic spline          Bspline The splinefun function in the R base package          was used for this purpose Spline parameters were fit for          each interval between consecutive quantiles The          interpolating spline function defined over the           k th interval is defined for the          parameters           a                       jk            and           y                       jk            in Equation  For an unsmoothed cubic spline           y                       jk                       q                       vk                                s                       j                       x             a                     jk             a                     jk             x            y                       jk                        a                     jk             x            y                       jk                        a                     jk             x            y                       jk                        In an iterative approach quantiles were resampled          from percentiles shifted by a small offset           np                       k where           p            was the first percentile and           k the number of iterations defines          the difference in rank between consecutive quantiles          This provided a different set of evenly spaced quantiles          for each curve fitting For the normalizations performed          here the results from five interpolations were averaged          The qspline method was implemented in R and included in          the Bioconductor package which will be described          elsewhere and is available from the web            Data for cDNA experiments were qspline normalized with          percentile samples and fitted in an iterative approach as          described for the oligonucleotide arrays The signal          distributions were found to contain many nonsmooth          features not common for both channels To account for the          printtip effect an additional normalization was          performed where Cy and Cy signals were scaled within          each printtip group as described in global scaling of          log intensities before qspline normalization as just          described                          Spatial normalization          Local signal logratio was estimated for each probe          using a weighted mean of neighboring probe signals A          sliding square window centered on the each probe             for oligonucleotide arrays and    for cDNA was          used to define the local neighborhood Weights were          defined by their Euclidean distance to the center probe          using a Gaussian function standard deviation  for             neighborhood and  for the    neighborhood For          both oligonucleotide and cDNA array data this adjustment          was made after global qspline normalization                            Additional data files        Additional data files showing MA plots and signal        distributions from all the HIV glnA tnrAarrays for the        different normalizations are available with the online        version of this paper and at          Additional data file         MA plots and signal distributions from all the HIV        arrays        MA plots and signal distributions from all the HIV        arrays        Click here for additional data file        Additional data file         MA plots and signal distributions from all the glnA        arrays        MA plots and signal distributions from all the glnA        arrays        Click here for additional data file        Additional data file         MA plots and signal distributions from all the tnrA        arrays        MA plots and signal distributions from all the tnrA        arrays        Click here for additional data file            