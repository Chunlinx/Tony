                    Background        The         TNF locus MIM  has been        associated with susceptibility to a wide range of        infectious and inflammatory diseases including malaria        typhoid leishmaniasis meningococcal sepsis trachoma        asthma multiple sclerosis and inflammatory bowel disease                      Thus far these associations        have not been mapped in any detail and as         TNF lies in the central part of the        major histocompatibility complex MHC there are many        candidate genes that could potentially be responsible A        strong candidate is         TNF itself as it encodes the potent        proinflammatory cytokine TNF and there is a significant        body of clinical and experimental data suggesting a causal        role for it in the pathogenesis of many of the diseases        with which it has been associated Furthermore most of the        reported associations are with polymorphisms located in the                TNF promoter region and cellular        studies of gene regulation         in vitro suggest that the molecular        basis of the disease association maybe at least in some        cases a direct effect of the polymorphism on levels of        gene expression             To pursue the causal origin of these         TNF disease associations we must        begin with a detailed understanding of the allelic        associations between different         TNF SNPs This is particularly        important considering that within a few hundred base pairs        there are several potentially functional polymorphisms        which show apparently independent disease associations with        severe malaria       Alternatively these         TNF SNPs may be serving as neutral        markers of functional polymorphisms elsewhere in the        central MHC In order to understand first how the         TNF SNPs relate to each other and        second which SNPs are the best markers of the         TNF locus in general we applied two        new analytical techniques to our haplotypic data The        first association efficiency analysis AEA precisely        defines the ability of one SNP to detect association at        every other SNP in a casecontrol scenario The second        technique entropy maximization method EMM selects those        SNPs that most effectively dissect the underlying        haplotypic structure of a locus The results of these        analyses allow us to prioritize SNPs for genotyping in        future diseaseassociation studies                    Results                  Haplotyping the TNFlocus          Twelve SNPs spanning  kb Figure  were genotyped          in  Gambian and  Malawian adults with no missing          data Allele frequencies for each SNP are listed in Table           The Gambian genotypic data had   sites          where gametic phase was unknown and the Malawian data          had   sites where gametic phase was          unknown Where available genotypes from offspring of the          adults were used to phase these data using the program          PHAMILY which reduced the number to            phaseunknown sites in the Gambian dataset and            phaseunknown sites in the Malawian dataset The          data were pooled and the program PHASE was then used to          assign the remaining phaseunknown sites After inferring          haplotypes only   phase assignments were          less than  certain in the Gambian dataset and only            phase assignments were less than           certain in the Malawian dataset All other assignments           and  were greater than  certain          These  Gambian haplotypes and  Malawian haplotypes          Table  were the basis of subsequent analyses          reported                          Haplotype distributions in two populations          In the Gambian sample we observed  different          haplotypes and the distribution was dominated by one          major haplotype  and two others            Table  Figure  Thirteen haplotypes of low frequency          made up another  and  of alleles were singletons          haplotypes observed only once in the sample The gene          diversity or probability that two haplotypes chosen at          random from the sample are different was  standard          deviation SD  There is one nonrecombinant          haplotype that is found only in The Gambia           The Malawian sample included  different haplotypes           of which were shared with the Gambian population          Table  Figure  The predominant haplotype in Malawi          was not as common at  and there were three other          haplotypes with frequencies greater than             and  Haplotype  bearing the C and          A alleles is much more common in Malawi than in The          Gambia at  versus  Four percent of the          Malawian alleles were present as singletons The gene          diversity in Malawi was slightly greater at  SD                    Wrights           F statistic reveals differences          between populations by calculating the reduction in          heterozygosity that is expected after random mating          between the two populations For the Gambian and Malawian          populations the           F                       ST              Permutations of the data under a null          hypothesis of no differences between the populations          gives a probability of  An exact test of          population differentiation finds the observed haplotype          distributions to be a poor fit of a model of random          mating between the Gambian and Malawian samples with a          probability less than                            Recombination          Results of the fourgamete test on pairs of SNPs in          each population reveal that in The Gambia            pairs of loci have all four possible haplotypes present          while in Malawi   pairs of SNPs have all four          haplotypes present Figure  Some highfrequency and          presumably older SNPs show evidence of recombination in          both populations TNF TNF In The Gambia the          TNF SNP shows evidence of recombination with six          other SNPs In Malawi the TNF shows evidence of          recombination with many other SNPs Interestingly the          TNF SNP of relatively high frequency in Malawi          shows no evidence of recombination with any other SNPs in          the Malawian sample Recombinant haplotypes of frequency          greater than  are represented in Figure with dotted          lines Although the branching structure of the           TNF genealogy is similar in both          populations there are unique recombination events that          have differentiated the two samples haplotypes            and  In Malawi there appear to be more recombinant          haplotypes of greater than  frequency                          Linkage disequilibrium          Consistent with the evidence for recombination          linkage disequilibrium is variable across the           TNF locus Figure cd and          generally low Values of pairwise linkage disequilibrium                    r  are different between the two          populations though well correlated            r   In The Gambia  of          SNP pairs have the minor alleles in the repulsion phase          while in Malawi  of SNP pairs are in the repulsion          phase Most of the SNP pairs in the repulsion phase have          very low linkage disequilibrium            r   There are six pairs of          SNPs that are in the coupling phase in the Malawian          sample but are in the repulsion phase in The Gambian          sample reversing the allelic associations Most of these          occasions involve the TNFA allele which is found on          only one haplotype in the Gambia in phase with the          TNFG allele but on five different haplotypes in          Malawi                          Association efficiency analysis          Using Equation  see Materials and methods we          calculate the apparent relative risk at one marker given          a relative risk of  at a second marker for all pairs of          markers As an example we assign a relative risk of           to the TNFA allele this is the relative risk of the          A allele compared to the G allele and calculate the          relative risks at all other SNPs in the TNF gene using          the haplotype frequencies from The Gambia Figure  Log                     of the relative risk is plotted on          the           y axis so values above the           x axis correspond to disease risk          while values below the           x axis correspond to disease          protection We find that the relative risk varies greatly          across the TNF gene region The three SNPs that are in          maximum positive linkage disequilibrium            D    with TNFA show          relative risks of   and  when TNFA gives a          relative risk of  The remaining eight SNPs in the TNF          gene would have a relative risk between  and  when          the relative risk at TNFA is  Figure           Data for all pairs of markers are given in Figure          ab Hypothetical disease alleles are given along the           x axis and marker alleles are          given on the           y axis Each cell indicates the          apparent relative risk            R  of a marker on the           y axis when the hypothetical          disease allele indicated on the           x axis has a relative risk of           Using an arbitrary cutoff of             R   indicated by blue          color some markers perform poorly for example in The          Gambia TNF can only detect TNF            R   Interestingly if the          TNF SNP were a disease allele most of the other SNPs          in TNF would show a moderate protective effect TNF          is good at detecting associations at seven other SNPs In          Malawi the pattern of association efficiency is          different and generally stronger Most hypothetical          disease SNPs in Malawi would be detectable by other SNPs          in TNF with the exception of TNF and TNF which          have very low frequency and little prospect of being          detected by other markers                          Association efficiency analysis compared to linkage          disequilibrium          To illustrate the relationship between the association          efficiency parameter and measures of linkage          disequilibrium we plot the log            of relative risk for all pairs of          SNPs when one SNP is assigned a relative risk of           against           r Figure ab Above the           x axis           r appears to be correlated with          the association efficiency parameter correlation          coefficients of           r   in The Gambia and           r   in Malawi Below the           x axis where the marker SNP gives          an apparently protective effect the correlation is not          as strong            r   in The Gambia           r   in Malawi In this          situation where minor alleles are in the repulsion phase          the values for           r remain low even when association          efficiency parameter shows a strong protective          effect          The association efficiency parameter is correlated          with           D  the unnormalized linkage          disequilibrium parameter Figure cd When the          absolute value of           D is great the association          efficiency tends to be high however many SNP pairs also          have high association efficiency even when the absolute          value of           D is low          When we plot the association efficiency parameter          against the normalized disequilibrium parameter           D  we see a strong positive          correlation           r   in the Gambia and           r   in Malawi Figure ef          Linkage disequilibrium is necessary to detect          association however it is not sufficient Despite           D    some pairs of SNPs are          poor markers of each other showing relative risks          between  and  when the linked hypothetical disease          allele gives a relative risk of                           Entropy maximization method          Entropy            E  a measure of haplotypic          diversity was calculated for the full SNP haplotypes          in each population Equation  in Materials and          methods In the Gambian sample           E   in the Malawian sample           E   To determine if a subset          of these  SNPs could account for most of the haplotypic          diversity in these samples we calculated entropy for all          possible subsets of SNPs increasing the number of SNPs          in a subset from  to  In Figure we plot the subsets          of markers with maximum entropy We begin with a single          SNP and with each additional SNP we include the entropy          increases The entropy plateaus when the additional          markers contribute little additional information To          account for  of the haplotypic diversity of           TNF  one must genotype  of           SNPs in The Gambian sample in order of decreasing          informativeness                  and type  SNPs in the Malawian sample                                            Discussion        The         TNF locus has been associated with        susceptibility to a wide range of infectious and        inflammatory diseases In African populations three         TNF promoter SNPs have been        independently associated with severe malaria       To        better understand these complex genetic associations with        malaria we have defined the haplotypic structure of the         TNF gene region using  SNPs        genotyped in  Gambian and  Malawian adults Gametic        phase was determined by genotyping one offspring from each        adult when available reducing the number of        phaseunknown sites by  The gametic phase of the        remaining sites was determined by statistical inference        This integration of family and populationbased methods of        haplotype reconstruction resulted in phase assignments of        high certainty This description of the pattern of DNA        sequence variation provides insight into the genetic        differentiation of these two African populations the        evolution of the TNF gene itself and the suitability of        these SNPs to serve as markers of disease association        There are a number of interesting features that        distinguish these two populations at the haplotypic level        Eleven haplotypes are unique to the Gambian sample and        eight are unique to the Malawian sample The haplotype        bearing the TNFT allele was not found in Malawi this        site is not polymorphic in the Malawian sample whereas it        has a frequency of  in The Gambia When population        differentiation is assessed by haplotype instead of by        individual SNP frequencies we observe a greater value for        Wrights fixation index         F                   ST            compared to         F                   ST            for individual TNF SNPs     Intragenic        recombination seems to have had an important role in        diversifying the locus and in distinguishing the two        populations as evidenced by a number of        populationspecific recombinant haplotypes    and         In spite of the significant differences in haplotype        distributions between the two African populations it        appears that most of the haplotypes have evolved over a        period of time during which there was gene flow between the        two sampled populations That is the basic branching        structure of the gene genealogy is the same in both        populations although frequencies are different and there        appear to be population specific recombination events        Figure         Our results have some similarities with a report of        haplotype structure across  megabases Mb in a sample of        Yorubans and AfricanAmericans     In a haplotype        block defined by  SNPs four haplotypes greater than         frequency were found we find five in the Gambia and four        in Malawi with frequency greater than  However we find        that a minimum of  and  haplotypes make up  of the        sample in The Gambia and Malawi respectively while they        report an average minimum of  haplotypes Furthermore        they report values for         D  that are constant across a        haplotype block while we find variability in linkage        disequilibrium even over short distances Our data are        more consistent with previous reports of haplotypic        structure where SNPs were ascertained by resequencing in a        large sample of chromosomes              The increased frequency of haplotype  in the Gambian        sample has a profound impact on the allelic associations        between SNPs as evaluated by chisquare test or as defined        by the pairwise association efficiency parameter The        starshaped genealogy of the Gambian         TNF locus dominated by one central        haplotype with many derived haplotypes defined by single        mutational events produces negative disequilibria between        most pairs of SNPs the rare alleles are found in the        repulsion phase The chisquare test has low power to        detect negative disequilibria     this may explain why        in the case where         p    SNP pairs have        negative disequilibria The ability of one marker to detect        another in a casecontrol scenario is also greatly reduced        when alleles are in the repulsion phase For example in        the Gambian sample allele pairs in the repulsion phase are        much more likely to be inefficient markers where        inefficient means the apparent relative risk at the marker        SNP is betwen  and  when the relative risk of the        hypothetical disease SNP is  than alleles in the        coupling phase          p           Although linkage disequilibrium between a disease        susceptibility locus and a marker locus is required to        detect an association with a complex disease for a fixed        sample size it may not be sufficient Even in the extreme        case when linkage disequilibrium is at its theoretical        maximum          D    and no recombination has        occurred between the two SNPs the relative risk at the        marker locus will be some fraction of the relative risk at        the disease susceptibility locus unless the two alleles        have the same frequency     Using the relationship        defined in Equation  see Materials and methods we can        examine the haplotypic structure of a candidate locus and        assess the ability of one marker to detect a disease        association when a second marker contributes a given        disease risk We calculate two values of apparent relative        risk for each pair of SNPs assigning each SNP in turn a        hypothetical risk of  and plot them against         D  Figure         Pairs of SNPs where         D  values are reversed between the        populations also show a reversal of the relative risk that        is relative risks greater than  become less than  For        example if the risk at SNP TNF was  then the        neighboring SNP TNF would give a relative risk of         in Malawi but in the Gambian population the effect would        be protective with a relative risk of  This suggests        that even with a marker in close physical proximity to a        diseasesusceptibility SNP results may differ greatly and        even give apparently contradictory results between two        populations This illustrates the importance of identifying        populationspecific recombinant chromosomes in the study        populations We identify six pairs of SNPs that would        reverse relative risks that is reverse the sign of         D  between the Gambian and Malawian        populations        Although the association efficiency parameter is        correlated with         D           r   for combined data it is        interesting to consider the situation where         D    between the marker and        hypothetical disease SNPs In this situation the apparent        relative risk at a marker SNP may be considerably lower        than at the disease SNP Figure  This is especially        evident in the Malawian population These observations        suggest that linkagedisequilibrium measures as summarized        by         D  may not accurately reflect the        ability of a marker to detect a disease association        It is troubling to observe that even within a relatively        small gene like         TNF  kb in this study the SNP        markers are poorly correlated if a true        diseasesusceptibility allele existed in the TNF gene many        of the other SNPs would be inefficient markers of that        disease allele Our calculations reveal that even if a        hypothetical disease allele gave a fold increased risk        out of the  possible pairs of SNPs in  of them         the marker would show a relative risk of less than twofold        Only a small minority of SNP pairs are efficient enough to        detect a strong diseasemodifying SNP in the         TNF gene region        Although it appears that individual SNPs in         TNF are poor markers of each other        it is important to ask which SNPs serve as good markers of        the         TNF haplotypes Depending on the        haplotypic structure of a gene region one may be able to        choose a small subset of SNPs that capture most of the        haplotypic diversity thus reducing the cost of genotyping        significantly with only modest reductions in information              Two methods have been reported that select the        best subset of SNPs      In this paper we introduce        a third the entropy maximization method EMM which        chooses the subset of SNPs that explains the largest        proportion of the underlying haplotypic diversity as        measured by entropy        The single SNP with maximum entropy is the SNP with        frequency closest to  in this case TNF In both        populations this SNP represents about onethird of the        haplotypic diversity With the addition of a second SNP to        form a twoSNP haplotype onehalf of the haplotypic        diversity is accounted for In The Gambia it is most        informative to include the TNF SNP as a second marker        whereas in Malawi the TNF SNP contributes the most as        a second marker It is not surprising that the first few        SNPs selected by the EMM are those that have frequencies        closest to  however the addition of a common SNP that        is well correlated with a SNP already in the subset will        contribute little additional information        For example in the Gambian sample the four most common        SNPs are selected first by the EMM TNF  TNF         TNF  TNF  The next most common        SNPs are the TNF  and the TNF  however        the EMM does not choose these SNPs next because the        TNF tends to occur in phase with the TNF and the        TNF tends to occur in phase with the TNF both of        which are already in the subset of four SNPs So the next        two choices that maximize entropy are the TNF and        TNF SNPs which although less common represent        haplotypes previously unaccounted for  and  These        sixSNP haplotypes now represent about  of the        haplotypic diversity Two more SNPs must be added for a        total of eight before  of the SNP haplotypic        diversity is accounted for        In Malawi the general features of marker selection are        the same though the optimal SNPs are different Three of        the four most common SNPs are selected first by the EMM        TNF  TNF  TNF  followed        by the TNF  and TNF  SNPs        Interestingly populationspecific recombinant haplotypes        make the TNF SNP more informative in Malawi it is        required to resolve haplotypes  and  and haplotypes         and  which together make up almost  of all the        haplotypes In Malawi seven SNPs must be included to        represent  of the SNP haplotypic diversity        EMM is especially useful when combined with AEA The        latter can be used to determine how well the recommended        haplotypetagging SNPs detect association at a particular        candidate SNP The results of AEA can then be used to        adjust the power of an association study accordingly        Analysis of the         TNF locus in two African populations        reveals a haplotypically diverse locus where markers are        only weakly associated with each other Although initial        detection of a disease association in         TNF may be difficult weak allelic        associations within the         TNF gene region will make it possible        to distinguish a diseasemodifying SNP from its neighbors        Future studies may determine that this is a general feature        of African genomes                    Materials and methods                  Subjects          Healthy unrelated adults were recruited in Banjul The          Gambia and in Blantyre Malawi All were parents of          children who presented to hospital with severe malaria          All subjects gave informed consent and the study was          approved by the Gambia GovernmentMedical Research          Council Joint Ethical Committee and the College of          Medicine Research Committee of the University of          Malawi          After excluding erroneous pedigrees the           parentchild pairs plus  other adults comprised the          Gambian sample a total of  adults and           parentchild pairs plus  other adults a total of           adults comprised the Malawian sample We also studied          DNA from two chimpanzees one gorilla and two orang          utans                          SNP identification and genotyping          In a previous study we described the nucleotide          diversity of the           TNF locus in  healthy unrelated          Gambian adults     There we identified  SNPs by          forward and reverse sequencing of the entire TNF gene          from  bp relative to the start of transcription to           bp on  chromosomes Here we have genotyped the           SNPs identified in           TNF  plus one SNP in the          neighboring gene           LT  in a sample of  Gambian          and  Malawian adults The amplification refractory          mutation system PCR ARMSPCR was used to genotype the          polymorphisms identified by sequencing Methods are as          previously described     The accuracy of the          ARMSPCR method was tested on sequenced individuals          before extending it to DNA samples of unknown          genotype                          Haplotype construction          For most of these adults genotypes were available          from their children raising the question of how to          construct haplotypes most efficiently from a dataset          where pedigree information is available for some but not          all individuals We developed a program PHAMILY which          uses information from twogeneration pedigrees to          construct parental haplotypes at all unambiguous sites          These partial haplotypes of unambiguous sites serve as          input for PHASE      which uses the          StephensDonnelly method of haplotype construction to          assign the remaining phaseunknown sites among the          unrelated parents The two study populations were pooled          before haplotype construction after haplotype          construction individuals were assigned to their original          populations on the basis of their sample identifiers                          Population genetic analyses                      Estimating gene diversity            An estimate of gene diversity              H  the probability that two            randomly chosen haplotypes are different in a sample            was calculated using Equation  from Nei                            where             n is the number of gene copies in            the sample             k is the number of different            haplotypes and             p                           i              is the frequency of the             i th haplotype The sampling            variance of this estimate was calculated according to            Nei and Roychoudhury     The computer software            Arlequin was used to perform these calculations                                                Construction of haplotype networks            Networkoc was used to construct medianjoining            networks of the haplotypic data     Because of the            occurrence of many lowfrequency recombinant haplotypes            in the dataset only haplotypes observed twice or more            were represented in the network Output from            Networkoc was critically evaluated and some            modifications made to best fit a model of minimum            mutation                                Fourgamete test            All pairs of biallelic SNPs were crosstabulated to            identify the number of unique twolocus haplotypes            present An observation of four different haplotypes            from a pair of biallelic loci was considered evidence            for recombination or recurrent mutation                                Population differentiation and pairwise F            ST            Pairwise             F                           ST              was calculated as the genetic variance among            populations divided by the genetic variance of the            total population using haplotypic data     An            exact test of population differentiation was applied to            the haplotypic data     The computer software            Arlequin was used to perform these calculations                                                Linkage disequilibrium calculations            Pairwise linkage disequilibria were calculated using            the             r statistic Terms for allele            and twolocus haplotype frequencies are given in Table                         r was calculated using                        where             D                                                            Normalized linkage            disequilibrium parameters             D  were calculated using the            method of Lewontin    in Hartl and Clark                Statistical significance of the standardized linkage            disequilibrium parameter was calculated using the            formula                        with one degree of freedom     where             N is the number of            chromosomes                                    Association efficiency analysis AEA          To assess the ability of one marker to detect a given          disease association at a second marker we derived a          measure we call association efficiency which is the          relative risk at one SNP by virtue of its association          with a second SNP Consider a diseasemodifying SNP           A that is in linkage disequilibrium          with a neighboring nonfunctional SNP           B  We define           R                       A            as the relative risk associated with allele           A            compared to allele           A             Under a multiplicative mode of          inheritance the frequencies of the different haplotypes          A             A            B             A            B             A            B             found in diseased individuals is          expected to be                                     R                       A                         and           R                       A                        see Table  Given the risk          associated with           A            and the frequency of each haplotype          we can derive the frequency of allele           B            among diseased individuals            q                                The frequency of allele           B            in the general population is defined          as           q             Thus in a casecontrol study          where diseased individuals are compared to individuals          drawn from the general population we would obtain an          odds ratio for allele           B            of                    This odds ratio provides an approximation of the          relative risk that is associated with the nonfunctional          allele           B            by virtue of its association with          the disease allele           A                      When locus B is considered to be the diseasemodifying          locus with           R                       B            as the relative risk associated with allele           B            compared to           B             it can be shown that the relative          risk at locus           A is                    In this paper we consider the possibility that the          rarer allele gives a true relative risk of  for a given          disease and calculate the apparent relative risk at all          other loci We do this for all pairs of loci Because          this property does not commute that is the apparent          relative risk at locus           B given a true relative risk of           at locus           A is not necessarily equal to the          apparent relative risk at locus           A given a true relative risk of           at locus           B  we calculate two values for          each pair of SNPs                          Entropy maximization method EMM          A measure of haplotypic diversity entropy            E  was calculated using                    where           p                       i            is the frequency of the           i th haplotype and           k is the number of unique          haplotypes in the sample Entropy is maximized when all          haplotypes have the same frequency We developed an          algorithim that chooses SNPs first individually then in          multiSNP haplotypes that maximize entropy     Thus          we can define a subset of SNPs that represent the          greatest proportion of the full SNP haplotypic          diversity This method provides for the selection of          optimal haplotypetagging SNPs even in the absence of a          clear haplotypic block structure                            Additional data files        A gzipped file of the C source code for the program         Additional data file  together with instructions for        compiling the C source code  Additional data file  are        available Instructions for how to run the compile program         Additional data file  an example output file with an        introduction  Additional data file  and an example of        the input file format  Additional data file  as well as        a file listing marker selection by maximum entropy kb         Additional data file  can also be downloaded The        algorithm is also available from            Additional data file         A gzipped file of the C source code for the program        A gzipped file of the C source code for the program        Click here for additional data file        Additional data file         Instructions for compiling the C source code        Instructions for compiling the C source code        Click here for additional data file        Additional data file         Instructions on how to run the compiled program        Instructions on how to run the compiled program        Click here for additional data file        Additional data file         An example output file with an introduction        An example output file with an introduction        Click here for additional data file        Additional data file         An example of the input file format        An example of the input file format        Click here for additional data file        Additional data file         A mathematical explanation of the method        A mathematical explanation of the method        Click here for additional data file            