                    Background        The pattern of genes expressed in a cell can provide        important information about the cell state DNA microarray        technology can measure the expression of thousands of genes        in a biological sample DNA microarrays have been        increasingly used in the last few years and have the        potential to help advance our biological knowledge at a        genomic scale    In analyzing DNA microarray        geneexpression data a major role has been played by        various clusteranalysis techniques most notably by        hierarchical clustering   Kmeans clustering   and        selforganizing maps   These clustering techniques        contribute significantly to our understanding of the        underlying biological phenomena A recent review of various        methods is provided by Tibshirani         et al    However many methods        including the three mentioned above have some        restrictions one of which is their inability to determine        the number of clusters The difficulty may be related to        the fact that in many methods there is no clear definition        of what a cluster is in the first place Furthermore their        clustering results may not be stable    An important        clustering technique that improves on andor provides        alternative solutions to these issues is modelbased        clustering see for example   It has a clear        definition that a cluster is a subpopulation with a certain        distribution and several statistical methods can be        applied to estimate the number of clusters Some authors        have considered its application to cluster geneexpression        patterns            Here we consider the use of modelbased clustering in        the context of detecting differentially expressed genes        which is to identify all the genes with altered expression        under two experimental conditions for example normal        cells versus cancer cells We note that the goal here is        different from that of clustering geneexpression patterns        as done by other researchers in using modelbased        clustering In modeling differential expression levels of        genes it is natural to assume that genes are from two        subpopulations one with constant and another with changed        expression levels Hence a twocomponent mixture is a        reasonable model This is the approach proposed by Lee         et al    where it is assumed        that each of the two components has a normal in the        statistical sense distribution However in general each        component does not necessarily have a normal distribution        It is well known that many distributions can be well        approximated by a finite mixture of normal distributions        Hence the normal mixture modelbased clustering can be        regarded as a more general and flexible approach along        these lines and we pursue this approach here In        particular we summarize a possible change of expression of        a gene using a         t statistic which automatically        accounts for differential variations of expression levels        across genes Then we apply modelbased clustering to these                t statistics to exploit which genes        have differential expression levels The methodology is        illustrated with an application to a dataset containing the        expression levels of  genes of normal rats and those        with pneumococcal middleear infection                    Results and discussion                  Data and preprocessing          Pneumococcal otitis media is one of the most common          diseases in children Almost every child in the United          States experiences at least one episode of acute otitis          media by the age of  years To understand the          pathogenesis of otitis media it is important to identify          genes involved in response to pneumococcal middleear          infection and to study their roles in otitis media A          study was recently carried out at the University of          Minnesota applying radioactively labeled cDNA          microarrays   to the mRNA analysis of  genes in          middleear mucosa of rats with and without subacute          pneumococcal middleear infection It consisted of six          experiments two cDNA microarrays were run with controls          while four were run with pneumococcal middleear          infection We first take a natural logarithm          transformation for all the observed geneexpression          levels so that they are more likely to have a normal          distribution which will reduce the number of clusters          found in a modelbased clustering The histograms of          geneexpression levels before and after          logtransformation for the first experiment are shown in          Figure  It can be seen that the logtransformation          reduces the skewness of the distribution of          geneexpression levels          After taking logtransformation for each experiment          we then standardize the transformed geneexpression          levels by subtracting their median value The above          standardization is based on the assumption that most          genes at least a half will not be expressed The median          is used because it is more robust against outliers than          is the more commonly used mean We use           x                       ij            to denote the resulting expression level of gene           i from experiment           j  Note that the first two          experiments that is           j   and  were conducted using          control rats whereas the last four that is           j      using infected          rats Some scatterplots showing comparisons between          experiments are presented in Figure  It can be seen          that in general there is a good agreement as well as          some variation between the experiments under the same          condition that is either within the control group or          within the infected group It appears that expression of          some genes are altered with pneumococcal infection          On the basis of the above observation we calculate          the following twosample           t statistic for each gene as its          measure of possible differential expression                    where                    for           i    The numerator of           y                       i            is the difference of average geneexpression levels          under the two conditions infected versus control          whereas the denominator is the sample standard error of          the numerator and serves to standardize the observed          difference by penalizing those with large and thus less          reliable variations Previous studies have found          evidence that genes may have differential variability of          expression levels     Note that although the           t statistic is constructed we          shall not conduct           t tests because there is no          evidence to support the questionable normality assumption          required by the           t test We also do not carry out          permutation or other nonparametric tests   because of          the small sample size that is    This is also          related with the fact that there exists the problem of          multiple comparisons if we test gene by gene   Our          goal here is to apply modelbased cluster analysis to the          preprocessed relative geneexpression levels           y                       i                       i     and see which          genes will have relative levels far away from the          majority                          Modelbased clustering          Finite mixtures of distributions provide a flexible as          well as rigorous approach to modeling various random          phenomena for example   For continuous data such          as geneexpression data the use of normal components in          the mixture distribution is natural With a normal          mixture modelbased approach to clustering it is assumed          that the data to be clustered are from several          subpopulations or clusters or components with          distinguished normal distributions That is each data          point           y is taken to be a realization from          a normal mixture distribution with the probability          density function                    where             y                        i                       V                       i             denotes the normal density function with mean                        i            and covariance matrix           V                       i             and                        i            s are mixing proportions We use                        g            to represent all unknown parameters                        i                                    i             V                       i                       i              g in a           g component or           g cluster mixture model          In modelbased clustering first the above mixture          model is fitted to the data and obtain the maximum          likelihood estimate                       g             Second the posterior probabilities of each data          point belonging to each of the           g normal components can be          calculated Finally each data point is assigned to the          component with the largest posterior probability We          review the major steps in the following          The mixture model is typically fitted by maximum          likelihood using the expectationmaximization EM          algorithm   Given           n observations           y                        y                       n             we want to maximize the loglikelihood                    to obtain the maximum likelihood estimate                       g             The EM algorithm computes                       g            by iterating the following steps          Suppose that at the           k th iteration the parameter          estimates are                        i                       k s                        i                       k s and           V                       i                       k s Then in the            k  th iteration the estimates          are updated by                    for           i              g where                    is the posterior probability that           y                       j            belongs to the           i th component of the mixture          using the current parameter estimate for                        g             for           i              g and           j              n           At convergence we obtain                       g             as the maximum likelihood estimate As local          maxima can be found by the EM algorithm it is desirable          to run the algorithm multiple times with various starting          values and choose the estimate as the one resulting in          the largest loglikelihood          One interesting but difficult problem in cluster          analysis is to determine the number of components           g  In contrast to many other          approaches that fail to accomplish this goal modelbased          clustering provides several useful and objective          selection criteria which have been used in other model          selection problems The best known are the Akaike          Information Criterion AIC   and the Bayesian          Information Criterion BIC                      where           v                       g            is the number of independent parameters in                        g             In using the AIC or BIC one first fits series of          models with various values of           g  then one picks up the           g with the smallest AIC or BIC          In many studies related to model selection it is          found that AIC may select too large a model whereas BIC          may select too small a model This phenomenon appears to          hold in selecting           g in the mixture analysis            Some other criteria have been studied but there does not          seem to be a clear winner   Banfield and Raftery            proposed using approximate weight of evidence as an          approximate Bayesian model selection criterion Some          empirical studies seem to favor the use of BIC   We          feel that a combined use of AIC and BIC is helpful at          least in providing a range of reasonable values of           g           A different approach to selecting           g is through hypothesis testing          This could be done through the use of the loglikelihood          ratio test LRT to test for the null hypothesis           H                       g            g            against the alternative           H                       g            g             for any given positive integer           g             The LRT statistic is  log           L                log           L              which however does not have the          usual asymptotically chisquared distribution as a result          of violation of required regularity conditions for          example the maximum likelihood estimate may lie in the          boundary of its parameter space McLachlan            proposed using the bootstrap to approximate the          distribution of the LRT statistic under the null          hypothesis On the basis of the resulting           p value one can decide whether to          reject           H                                      Implementation          McLachlan           et al    have implemented          modelbased clustering in a standalone Fortran program          called EMMIX which is freely available from the web            It supports all the functions we described above          including multiple start of the EM algorithm using random          partition or           K mean clustering calculation of          the model selection criteria AIC and BIC and the use of          the bootstrap to test a given number of components           g             We will use EMMIX to analyze the          geneexpression data described earlier          The MCLUST software   implementing modelbased          clustering is also freely available   It is          designed to interface with the commercial statistical          package SPlus For users familiar with SPlus it is          convenient to take advantage of the power and flexibility          of SPlus However at the same time it can have some          serious restrictions on the size of the data being          analyzed because of the overhead on CPU speed and memory          induced by SPlus                          Application          We fitted five mixture models with           g ranging from  to  Table          summarizes the model fitting results Using AIC or BIC          we would select           g   or           g   respectively Also from the          loglikelihood values there is a dramatic change when           g is increased from  or           However from           g   log           L increases very slowly Hence          both           g   and           g   appear reasonable To          determine which one is better we applied the bootstrap          method also implemented in EMMIX to test           H                       g   versus           H                       g   Using  bootstrap          resamples we were unable to reject           H            as the resulting           p value is  larger than the          usual  nominal level In contrast if we test           H                       g   versus           H                       g   then we will reject           H            with a small           p value  Therefore we choose          to fit a threecomponent normal mixture model          The fitted mixture model is                    f            y     x           N                N                N            More than  of data points fall into the two          clusters with means close to  That means there is          either no or little change in geneexpression levels for          most genes On the other hand  genes classified into          the first cluster seem to have a change in          geneexpression levels This can be verified from Figure           which shows the profiles of geneexpression levels          across all six experiments for each cluster          In addition to determining the number of clusters          modelbased clustering has another advantage in providing          posterior probabilities of observations belonging to each          cluster The posterior probabilities are calculated using          Equations  and  and are presented in Figure           Recall that a gene is classified to a cluster if its          posterior probability of being in the cluster is the          largest From Figure  it can be seen that if a genes           t statistic has a large absolute          value then it will be classified into cluster           Specifically if a           t statistic           y                       i             is smaller than  or larger than  then          the corresponding gene           i is judged to be from cluster           Hence cluster  consists of genes with large absolute          values of           t statistics implying that          cluster  corresponds to genes with large changes of          expression levels after standardization by the variation          of expression levels          Furthermore the posterior probability can serve as a          quantitative measurement of the strength of each gene          being classified into each cluster For instance among           genes classified into the first cluster there are          respectively    and  genes with a posterior          probability of being in the first cluster greater than             and  Hence those  or  genes          are likely to have expression levels significantly          different from those of other majority genes The          posterior probability might also provide information          about possible misclassifications In addition to those          classified into cluster  there might be other          observations classified into the other two clusters but          nevertheless with not too small probabilities of being          classified into cluster  The lower right panel of          Figure shows six such observations all belonging to          cluster  but with probabilities of being in cluster           ranging from  to  These six genes show somewhat          differential geneexpression levels but the evidence is          not strong and more experiments may be needed to verify          this          We hope we have shown that modelbased clustering is a          powerful method that is useful in analyzing          geneexpression data It is flexible as well as          intuitively understandable However it does have some          limitations Although it provides posterior probabilities          for classification results in the context of detecting          differentially expressed genes its use is more in the          line of exploratory data analyses For instance in our          example we treat cluster  as representing genes with          changed expression whereas clusters  and  consist of          genes without expression changes Although this treatment          is reasonable it is somewhat subjective and is          debatable Some new statistical approaches              are interesting alternatives that provide a more          quantitative answer to detecting genes with altered          expression but they require replicates of spots or          arrays Modelbased clustering is less restrictive and          can be applied to data without replicates and to cluster          relative geneexpression levels directly                              Materials and methods        Three young pathogenfree SpragueDawley rats were        inoculated with pneumococcus in phosphatebuffered saline        PBS and served as the pneumococcus group Three other        rats inoculated with PBS served as controls All animals        were sacrificed on day  after inoculation The bullae        from each of the pneumococcus or PBSinoculated groups        were pooled and submitted for mRNA purification Purified        mRNAs   PdATP dNTP mix and reverse transcriptase        were incubated at C for  min for the synthesis of        radioactively labeled cDNA probes The Atlas cDNA array        membranes Atlas rat  array Clontech CA were        hybridized with the cDNA probes and nonspecific binding        washed away Specific binding of cDNA probes with the        membranes was scanned into a computer and the radioactive        signal intensities of specific binding were quantitated        with the OptiQant software version  DeltaPackard        Boston MA and presented in digitalized light unit DLU        The intensity level in DLU is the observed geneexpression        level As described earlier the logtransformation was        conducted on the intensity level in DLU and the centering        and scaling procedures were followed using the        logtransformed data The original data representing the        intensity level in DLU for each gene from each of the six        experiments are available from our website              