                    Background        The genome of         Drosophila melanogaster was sequenced        using a wholegenome shotgun WGS approach    The        first assembly WGS used only plasmid and BAC pairedend        sequences The second added BAC and Pbased finished and        draft sequences see Table  of   for details these        two assemblies were compared in   The joint assembly        was submitted to GenBank as Release  This sequence        contained many gaps and regions of low sequence quality A        second release Release  corrected some errors in the        order and orientation of small scaffolds present in Release         and filled a few hundred very small sequence gaps Using        improved WGS sequenceassembly algorithms two additional        assemblies of just the WGS plasmid and BAC paired end        sequences used in WGS were generated in March  WGS        and July  WGS roughly coinciding with the WGS        assemblies of the human   and mouse genomes          respectively        This paper describes the finishing work we have done to        improve Release  in order to generate the Release         sequence of the         D melanogaster euchromatin The        status of the heterochromatic regions of the genome is        reported in   Our goals in generating the euchromatic        portion of Release  were to close all the gaps improve        regions of low sequence quality extend the sequence at the        telomeric and centromeric ends of each chromosome and        verify the whole genome assembly The Release  euchromatic        genome sequence has been reannotated    using a new        annotation tool Apollo   and deposited in GenBank        Companion papers    address the complete reannotation        of the         Drosophila euchromatic genome on the        basis of improved genomic sequence and new expressed        sequence tag EST and cDNA sequences The improvements        made to the genomic sequence in Release  had a large        impact on the annotation of transposable elements          because of the substantial corrections made in the assembly        of repeated sequences Because the nonrepetitive regions        of the genome were generally of good quality in Release         most of the improvements to the annotation of these regions        resulted from the increased amounts of EST and cDNA data          Release  provides a euchromatic sequence that is        virtually gap free and of high accuracy We were thus able        to rigorously assess the quality of Release  as well as        the sequences generated by each of the three WGS        assemblies by simply comparing these sequences to the        Release  euchromatic sequence and assuming that all the        differences were the result of errors or omissions in the        other sequence                    Results and discussion                  Overview of the finishing strategy          Both of the sequencing centers that participated in          the finishing effort Lawrence Berkeley National          Laboratory LBNL and the Human Genome Sequencing Center          Baylor College of Medicine HGSC have extensive          experience in finishing the sequence of individual BAC          clones To take advantage of this expertise we reduced          the problem of finishing a WGS sequence to one of          finishing a set of overlapping BAC clones This approach          allowed us to use the sequence assembly software phrap            which provided an independent assembly of the raw          trace data and an estimated error rate Thus apart from          filling gaps and improving sequence quality we were able          to compare two independent assemblies of the same trace          data LBNL took responsibility for chromosome arms L          R R  and the proximal half of the X chromosome           Mb and HGSC chromosome arm L and the distal half of          the X chromosome  Mb          We previously generated a physical map of the major          autosomes   BACbased maps of the X chromosome            and chromosome    were also available Figure  We          selected a tiling path of BAC clones spanning the          physical maps and Release  sequence using the available          sequencetagged site STS maps and BAC end sequences          The WGS sequence traces and end sequences of the tiling          path BACs were assigned coordinates based on their order          in the Release  assembly We then binned all the traces          belonging within a particular BAC and extending  bp          beyond the end sequence of that BAC These traces were          combined with sequence traces   sequence coverage          that had been generated from libraries made from the          individual tilingpath BACs   and assembled using          phrap These assemblies formed the starting point for our          finishing efforts          To generate Release  we closed gaps by sequencing           kb subclones  kb clones and  fragments          generated by PCR we improved quality with  custom          primer sequence runs To assess the accuracy of the          individual BAC assemblies we compared           in silico restriction maps          generated from the sequence of each BAC to restriction          fingerprints essentially as described   A set of           Bam HI           Eco RI and           Hind III digests was used to verify          the assembly of  BACs For  BACs only two of the          three enzyme digests were available to verify the          assembly The finished BAC clone sequences were submitted          individually to GenBank          The assembly of the individual BACs into entire          chromosome arms was verified in two ways First BAC          tiling path clones were mapped by           in situ hybridization to the          polytene salivary gland chromosomes of third instar          larvae which serves as an unambiguously correct physical          map           In situ hybridization data for           clones in the BAC tiling path have been reported          previously   Images documenting the localization of            BACs in the tiling path can be found in the          GadFly Genome Annotation Database   Second the          unique end sequences of  BACs were aligned to the          assembled chromosome arm sequences If the fully          sequenced BACs were not assembled in the correct order          and orientation we would expect to find regions of the          genome where those end sequences fail to align to          positions between  and  kb apart such regions of          misaligned paired BAC end sequence were not observed in          the final Release  chromosome arm assemblies The          Release  chromosome arms are composed of  sequence          scaffolds and contain  sequence gaps A sequence          scaffold is defined as a set of contiguous sequence          contigs ordered and oriented with respect to one          another within a scaffold the gaps between adjacent          contigs are of known size and are spanned by clones            Physical map gaps are gaps between scaffolds in these          cases no clones that span the gap have been          identified                          Refinements to the physical map          A BACbased physical map of the X chromosome was          constructed by the European Drosophila Genome Project          EDGP   and used as a starting point for BACbased          sequence assembly of the X In our finishing work we          replaced mismapped BACs at A and D We also filled          nine clone gaps in the physical map identifying BACs          that span them by comparing the paired end sequences of           BACs   with the Release  sequence assembly In          Release  the X chromosome is in three scaffolds of            and  Mb and has two physical map gaps at          EF and A estimated to be  kb and  kb in size          respectively Table  Several short tandem arrays lie          within  kb of the EF gap but it possesses no other          remarkable sequence features Complex nests of          transposable elements flank the gap at A which lies          within the centric heterochromatin such nests of          transposable elements are common in the proximal regions          of the chromosome arms            Our BACbased physical map of the autosomes   was          used as a starting point for sequence assembly of the          second chromosome The left arm of chromosome  L is          in two scaffolds of  and  Mb and has one clone gap          at DE that contains  tandem repeats of the          histone gene cluster   Each repeat contains five          histone genes           Histone H His Histone H His          Histone H His Histone HA HisA and           Histone HB HisB  Two          predominant forms of the repeat  and  kb have          been previously described and differ primarily in the          size of the spacer DNA between           His and           His  The variants are not          interspersed with one another but form segregated          clusters The BAC at the distal side of the gap has at          least three copies of the kb variant and the BAC at the          proximal side of the gap has at least two copies of the          kb variant          The right arm of chromosome  R is in three          scaffolds of  Mb  Mb and  Mb with two clone          gaps one in B and another in B estimated to be           kb and  kb respectively Table  The clone gap in          B is associated with  to  copies of a previously          uncharacterized  bp repeat showing weak similarity to          RNAdirected RNA polymerase interspersed with kb units          that have  nucleotide similarity to the            transposable element The          other clone gap on R in B is flanked on the distal          side by bp tandem repeats with similarity to snoRNAs            and on the proximal side by a different bp          repeat          The left arm of chromosome  L is in two scaffolds          of  Mb and  Mb with a single clone gap at  C          estimated to be  kb Table  The right arm of          chromosome  R has no euchromatic clone gaps and is          represented in a single sequence contig of  Mb          A BACbased physical map of chromosome    was          used as a starting point for sequence assembly of this          arm This map has two clone gaps one at A and the          other at EF The gap at A was estimated to be very          small and was filled with  bp of sequence in          Release  The gap at EF was estimated to be  kb          and remains the only clone gap on chromosome  in Release           In Release  chromosome  exists in two scaffolds           Mb and  Mb The gene           CG extends into the gap from          the proximal side and the           CG CAPS gene extends into          the gap from the distal side these sequences can be used          as starting points to fill the gap for Release  of the          genome sequence The CAPS gene is found in a kb          scaffold in WGS that extends  kb into the gap          ending in approximately  kb of the simple bp repeat          CATAATAAT                          Assessment of the quality of Release           The total size of the euchromatic portion of the           Drosophila genome in Release  is           bp The status of each chromosome arm          including length number of physical map gaps number of          finished and unfinished BACs number of sequence gaps          and sequence quality estimated as error rate in a          sliding window of  kb is shown in Table  The          positions of the remaining gaps are diagrammed in Figure           The euchromatic genome is assembled into  contigs           of the genome is contained in contigs N of  Mb          or greater and  N is in contigs greater than           kb A total of seven physical map gaps and  sequence          gaps remain Table  The sequence is highly accurate           of the base pairs are contained within kb          regions having estimated error rates of less than one per           bp The estimated error rate was also determined          for each of the  BACs that comprise the tiling path          All have a phrap estimated error rate of less than one in           bp and   are estimated to have less than          one error in  bp                          Extending the sequence                      Chromosome X            The sequence at the telomere of the X chromosome in            Release  is contained in BACRJ but this BAC is            not completely assembled and does not extend to the TAS            repeats The Release  sequence of the X chromosome            extends proximally approximately  kb beyond Release             toward the centromere The proximal  kb of Release             are not covered by BAC clones we used kb clones            from the WGS in order to produce this sequence The            WGS assembly extends beyond Release  by  kb ending            in  copies of the simple repeat TAGA a known            heterochromatic satellite repeat                                  Chromosome L            The Release  telomeric sequence extending            approximately  kb farther than that of Release  ends            in  copies of the TAS repeat The proximal sequence            of chromosome arm L ends in  kb of nested            transposable elements                                Chromosome R            The Release  telomeric sequence ends in two copies            of a bp repeat similar to the previously described            telomeric sequence in the TAS element The proximal            sequence of chromosome arm R is highly enriched in            transposable element sequence                                Chromosome L            There has been no change in the sequence of the L            telomere in Release  compared to Release  It has a            single copy of a bp sequence with  similarity to            the minisatellite TAS repeats of L The proximal            sequence of chromosome arm L extends beyond Release             by  kb and is highly enriched in transposable element            sequence                                Chromosome R            The telomere of chromosome arm R in Release             contains six copies of a bp repeat similar to the            previously described telomeric sequence in the TAS            element it extends the Release  sequence by            approximately  kb We did not substantially extend the            proximal sequence of chromosome arm R in Release             The WGS assembly extends  bp beyond Release  and            ends in  tandem copies of a nearly perfect simple            repeat TATAA a known heterochromatic satellite            repeat                                Chromosome             The most distal BAC on chromosome  BACHK is            not anchored to the Mb main scaffold This BAC            contains over kb of sequence not mapped to            chromosome  in Release  Analysis of the sequence of            this BAC shows that it should have been appended in            inverted orientation because it ends in two copies of            an approximately  bp portion of a             HeTA element whose polyA tail            is oriented toward the centromere The sequence of            chromosome arm  in Release  extends proximally to            that of Release  by nearly  kb This extension            contains four  kb tandem imperfect repeats each            bounded by a             narep  repeat The distal repeat            contains the             plexin B gene the three proximal            repeats contain related proteincoding genes             CG CG and             CG                                     Comparing Releases  and           The Release  sequence of the euchromatin contained           gaps of which we were aware These declared gaps          were represented in the sequence by a string of Ns          corresponding in length to the estimated gap size or by           Ns if we were unable to estimate the size of the          gap Our comparisons of Releases  and  identified           additional insertions or deletions greater than  bp          which we refer to as undeclared sequence gaps Table           Figure  Now that more than  of the gaps in the          euchromatic sequence have been filled we are able to          examine the sequences that were missing in both the          declared and undeclared gaps The sequences missing in          each gap were classified into seven categories unique          sequence transposable element homopolymer simple          repeat tandem duplications local misassembly or gross          misassembly In addition we identified individual          basepair differences as well as insertions and          deletions of less than  bp          In the WGS assemblies the sequence coverage of the X          and Y chromosomes is expected to be less than for the          autosomes The autosomal coverage was estimated to be x            thus sequence coverage is expected to be  for          the X chromosome and x for the Y assuming an equal          number of male and female embryos in the collection used          to make the DNA for the WGS Presumably as a result of          its reduced sequence coverage the Release  sequence of          the X chromosome has  times as many gaps           representing  of the total per million bases as those          of the autosomes and more than half the gaps in the          euchromatic portion of the genome that lie in unique          sequence map to the X chromosome The Y chromosome is          almost entirely heterochromatic and Y chromosome          sequences are limited to small WGS scaffolds            Repetitive elements are difficult to assemble in a          wholegenome shotgun strategy As a consequence one of          the initial steps in the Release  assembly was to          identify known repetitive elements including          transposable elements and remove their traces from the          early steps of the assembly process   After the          unique sequence was assembled and sequence contigs were          ordered and oriented those transposable element sequence          traces were added back Sequence traces belonging to          transposable element families were assembled using an          aggressive strategy that resulted in composite sequences          for most of the transposable elements in Release  Part          of the finishing effort has been to determine the          sequence of each individual element Of the  full          and partial transposable elements in Release    only           are identical to the corresponding Release           transposable element sequences Of these identical          elements  are shorter than  bp and could be          assembled with two reads if those reads contained          sufficient unique sequence to be unambiguously placed          The sequences of the remaining  transposable elements          are identical between Release  and Release  because          their sequence was determined by the Berkeley Drosophila          Genome Project BDGP as part of the finishing process          leading to Release    Approximately a third of the          total number of gaps in Release  euchromatin are the          consequence of transposable elements A slightly higher          fraction of the gaps are the consequence of simple          repeats          Duplications in the           Drosophila genome are rare in          comparison to the number found in mammalian genomes We          observed tandem repeats whose repeat units range in size          from  bp to  kb The largest region comprised of          tandemly duplicated repeats in the euchromatic portion of          the           Drosophila genome is the histone          cluster at B described above As a prelude to a more          rigorous analysis of repeats we have searched for          perfect direct or inverted repeats over  bp in length          that are not transposable elements or lowcomplexity          sequence We identified  Mb of repeated sequence less          than  of the euchromatic genome  mapping to          chromosome X  to chromosome   to chromosome           and  to chromosome  Although there are more repeats          on chromosomes X and  they appear to be randomly          distributed and are not clustered at the centromeres or          telomeres This is in contrast to the increased number of          tandem duplications found in the pericentric regions of          mammalian chromosomes   Misassemblies of tandem          repeats account for only  of all gaps Local          misassemblies resulting in small insertions the result          of lowquality sequence in Release  are also rare          constituting only  of the gaps          We identified only seven gross misassemblies in          Release  Six resulted in large sequence insertions or          deletions in Release  and one resulted in a large          inversion In addition a polymorphism in the isogenic          strain resulted in an eighth largescale sequence          difference between Releases  and  This polymorphic          tandem duplication consists of more than  kb of          sequence bounded by           hobo and           cruiser transposable elements half          of the BACs mapping to this location contain one copy of          the repeat and the other half have two Transposable          element sequence is associated with the ends of all of          the misassembled regions On the X chromosome at          position  Mb  kb of complex transposable element          sequence in Release  has been replaced in Release  with          a single copy of a           roo element and a gap When          complete this region is expected to contain three           roo elements On L there is one          misassembly at  Mb A declared gap estimated to be           bp and involving an           mdg transposable element was          filled in Release  with  kb of sequence On R there          are three misassemblies mapping to  Mb  Mb and           Mb The first is associated with four declared gaps          within  kb of Release  sequence That sequence has          been replaced with  kb of sequence in Release           bounded by a           G element at one end and an           invader  element at the other The          second misassembly is a declared gap estimated to be           kb that was filled with  kb of sequence in Release           In the third  kb of complex transposable element          sequence in Release  has been replaced with a single          complete kb           roo element in Release  On R a          kb segment in Release  is replaced in Release  with           kb The Release  sequence of chromosome  contains a          large misassembly that inverts the distal third of the          chromosome John Locke personal communication The          inversion occurred at position  the location of a          portion of a  element The misassembled Release           sequence ends with a TAATAATA            repeat that maps starting at          position  bp in Release           We identified single base substitutions and single          nucleotide insertions and deletions between Release  and          Release  Excepting transposable elements the rate of          base changes is one per  bp for the autosomes and          one per  bp for the X chromosome Within          transposable elements the rate of base changes is one          per  bp this high error rate is largely a consequence          of comparing the Release  sequence of individual          elements to the composite sequences in Release                           Comparison of WGS assemblies to Release           In addition to comparing the Release  sequence to the          two sequence releases previously deposited in GenBank we          also compared Release  to each of three pure WGS          assemblies These comparisons allow an assessment of how          well a WGS approach works on a  Mb metazoan genome          Although the specific software we used is proprietary          the underlying algorithms and the logic have been fully          described    and the basic approach replicated by          others    An analysis of these assemblies in          light of the modifications to the algorithmic strategy          made between assemblies should inform the development of          WGS assembly software in general The sequence traces          used in these assemblies are available from the GenBank          trace repository and Release  offers a highquality          sequence for comparison providing an important resource          for testing new WGS assembly algorithms The sequences          that comprise the WGS and WGS assemblies are also          available for benchmarking          Three assemblies of the WGS data were made each using          a different version of the Celera Genomics assembly          software WGS used  pairedend shotgun reads          from genomic plasmids and  paired BACend reads An          additional  reads that had been erroneously removed          during the quality screening process for WGS were added          to the input data set for the next two assemblies WGS          and WGS The assembly algorithm that produced WGS did          not adequately handle repeat resolution a variety of          improvements including a different method of placing          repeat traces better identification of repeat traces          and the introduction of a sequence correction algorithm          resulted in better subsequent assemblies particularly of          repetitive regions          The output of the assembly process is a collection of          scaffolds made up of ordered and oriented contigs linked          together by paired end sequences Pairedend reads of          clones whose size falls within a tight distribution allow          the length of every gap between two contigs of a scaffold          to be characterized with an expected mean and standard          deviation There were  pairs of sequences produced          from the ends of kb plasmid libraries another           pairs of sequences from the ends of kb plasmid          libraries and  pairs of BACend sequences a mean          distance of  kb apart from each other Table presents          statistics characterizing the scaffolds in the three          assemblies Table presents the same statistics for the          scaffolds that align to the Release  euchromatic          sequences The scaffolds that do not align to the          chromosome arms totaling  Mb of sequence and          spanning  Mb derive from the heterochromatic regions          of the genome see   for more information on the          content of these scaffolds          The output of the assembler contains only the sequence          reads that assemble with high confidence into a contig          As a result  of the sequencing reads most of          which come from heterochromatin or interspersed          repetitive elements do not form part of an assembly          Table provides evidence that the total amount of data          that was reliably assembled increased as the assembly          algorithms improved In the later assemblies more          sequence from heterochromatic regions of the genome is          reported but in a more fractured state than for          euchromatic regions These additional assembled pieces          although constituting a modest fraction of the sequence          constitute a large percentage of the number of scaffolds          and contigs The  largest scaffolds of the three          assemblies constitute over  of the sequence and are          almost identical          In all three assemblies a small number of large          scaffolds cover the  Mb of the Release  euchromatic          sequence Table  WGS scaffolds span  of Release           euchromatic sequence and extend beyond it by  Mb          Mean gap length increased between WGS and WGS but          there are half as many gaps indicating that WGS          resolved many of the smaller interspersed repeats          Scaffold N lengths are similar in each assembly Table           as all of the mapped scaffolds are large Of the           Mb of Release  euchromatic sequence WGS provided           WGS provided  and WGS provided  of          the sequence          The content of sequence gaps in WGS WGS and WGS          was determined by comparison to Release  The majority          of this sequence    and  respectively  is          repetitive either tandem repeats or transposable          elements          We compared the order of the Release  euchromatic          sequences with the order of the contigs and scaffolds in          each of the WGS assemblies see Materials and methods          Assuming that Release  is correct we manually examined          and categorized these discrepancies Table shows the          number of incorrectly ordered segments in each category          and the total number of base pairs involved in those          segments Occasionally what look like separate scaffolds          actually overlap a contig at the end of one scaffold          contains sequence that belongs in a gap at the end of the          other scaffold These interleaved scaffolds induce a          subtype of local order error as seen in Table  In          later versions of the assembly the number of          interleaving failures actually increased Until now all          the algorithmic solutions have simply considered          scaffolds to be nonoverlapping and have ignored this          phenomenon The order and orientation of the scaffolds          themselves is correct so these are considered separately          from local errors          We measured the basepair accuracy of the sequence in          the WGS assemblies We found  discrepancies in          WGS  in WGS and  in WGS corresponding to            and  errors per  bp respectively          The National Human Genome Research Institute NHGRI          standard for finished sequence is less than one error per           bp With the exception of gaps WGS nearly meets          this standard for finished sequence over the entire          assembled sequence However most of the errors are in          the reconstruction of repetitive sequence Table  in          the unique sequence all three assemblies exceed the          error rate standard          Furthermore assemblies tend to be less accurate at          the tips of contigs because the number of reads covering          the ends is much lower than in the middle of the contig          As shown in Table  sequence quality rises when  bp          are eliminated from the ends of each contig Though the          WGS sequences contain more gaps than would be considered          acceptable for finished sequence the sequences that          are present are highly accurate                            Conclusions                  Generating a finished sequence          In producing Release  we have greatly improved the          quality of the           Drosophila euchromatic sequence We          have increased sequence accuracy and reduced the number          of sequence contigs spanning the euchromatic portion of          the genome from  to  The largest sequence contig          covers the entire chromosome arm R in a single contig of           Mb However more remains to be done and we have          already begun work on Release  We are confident that          all but a few of the remaining sequence gaps can be          closed with existing technology Likewise we can easily          improve the few regions of low sequence quality that          remain A greater challenge will be resolving complex          tandem duplications and discovering and correcting the          sequence assembly errors that they cause We have been          fortunate to have access to two different assemblies one          of the whole genome produced with a constrained          assembler that utilizes pairedend information and the          other of BACsized intervals produced with an          unconstrained assembler phrap Comparison of the          products of these two assemblers with lowresolution          restriction enzyme fingerprints of BAC clones has          convinced us that constrained assemblies carried out on          small genome intervals and more exact comparison to          restriction digests are necessary to be truly confident          of the fidelity of the sequence assembly especially in          repetitive regions                          WGS sequencing is efficient          In Release  we delivered a sequence of the          euchromatic           Drosophila genome that has proven          extremely useful to experimental biologists representing          over  of the finished sequence Repetitive sequences          were of only draft quality however Using improved          assembly software  of the           Drosophila genome was assembled          accurately in WGS judged by comparison to the Release           sequence with virtually no global errors and few local          order and orientation errors With the exception of a          larger number of gaps overall sequence quality          approaches the NHGRI standard for finished sequence          Furthermore it is likely that continued algorithmic          advances and specific refinements to treat the case of          tandem repeats will improve the quality of assembly in          repetitive regions Initial objections to the WGS          strategy suggested that the finishing stage would be more          difficult and expensive than BACbyBAC sequencing            in particular because of a lack of clones to use as          finishing templates However we found that the kb          plasmids used in the WGS provide an excellent resource          for finishing Such clones are large enough to cover most          gaps and small enough to sequence conveniently by          transposon insertion methods                          If we were to start today          In the course of the           Drosophila Genome Project we have          utilized a wide variety of sequencing strategies On the          basis of our experience our strategy to sequence another          genome would be the following First carry out WGS          sequencing and assembly using pairedend reads from           and kb plasmids and from kb BAC clones at            and   sequence coverage respectively Second align          the BAC end sequences to the assembled sequence scaffolds          to generate a preliminary physical map Third generate          highresolution restriction enzyme fingerprints of BAC          clones in a threedeep tiling path across each arm to          resolve collapsed repeats and to verify the physical map          and final assembly Fourth localize a sampling of BACs          using fluorescence           in situ hybridization FISH to          associate the sequence scaffolds to their chromosome of          origin Fifth close gaps using the WGS kb clones as          sequencing templates Note that we would not generate          sequence information from the BACs except for their end          sequences choosing instead to use the kb WGS clones          as templates for all finishing work Sixth improve          lowquality regions with custom primers                            Materials and methods                  Strain and libraries          Sequencing templates were made from P BAC and WGS          DNA libraries using the           D melanogaster strain           yellow            y            cinnabar            cn            brown            bw            speck            sp  This isogenic strain was          constructed in the early s   the P   BAC            and WGS DNA libraries   were made in            and  respectively Although we have not determined          the singlenucleotide polymorphism rate between the          libraries we observed four cases of insertional          polymorphisms in which BACs contain transposable elements          that are absent from the Release  WGS assembly two on          the X a           gtwin element in BACRA and a            element in BACRP one on          chromosome  a           roo in BACRK and one on          chromosome  a           roo in BACRC We have confirmed          the molecular mutation of the           y allele as an A to C transversion          in the ATG translation initiation codon as first          determined by Geyer           et al   We determined the          molecular lesion of the           cn allele to be a  bp          deletion relative to wild type The mutation in           bw was known to be associated with          an uncharacterized insertion   We have identified          the insertion to be a            transposable element mapping to          the third exon The wildtype           sp gene located genetically and          cytologically to  C has not yet been molecularly          characterized However           sp is known to be suppressible by           suppressor of sable   a known          suppressor of            elements Two            elements map to  C one in           Dat and another near           NopB                           Sequencing methods                      BACbased assembly            BACbased assemblies were produced using phred            version c   and phrap version               WGS traces were obtained from Celera Genomics with            a listing for each trace that included name insert            size and coordinates in Release  We determined the            Release  coordinates of each BACend in our tiling            path by comparison of the BACend sequences to the            Release  sequence The WGS sequence traces            corresponding to the region spanned by each BAC in the            tiling path were then pooled with the sequence traces            generated from that BAC approximately  coverage              and assembled using phrap At LBNL draft sequence            from neighboring BACs was also included in each            assembly Traces for repeat sequences including            transposable elements were obtained from Celera            Genomics in two sets one surrogate traces with            multiple location coordinates in Release  and another             k traces with no location coordinates Only those            sequence traces derived from repetitive DNA that could            be associated with their unique mate pairs were            included in our assemblies A total of  BAC clone            assemblies were generated to complete the euchromatic            BAC tiling path                                Sequence gap closure            The phrap assemblies were viewed using consed            version    and more recently version  At            LBNL BAC end sequences were manually tagged and if            the assembly was in more than one contig gap sizes            were estimated using Consed and phrapview version               To aid in the determination of gap            sizes phrapbased assemblies were compared to the            Release  assembly using Sim   At HGSC gap sizes            and locations were estimated before phrap assembly            using the WGS read coordinates Gap closure status was            monitored in the phrap assemblies using            checkcontigpl a program developed at HGSC            Assemblies were automatically tagged using BLAST              or crossmatch   to identify the location of            transposable elements            LBNL and the HGSC used slightly different strategies            for gap filling With an estimated gap size LBNL used            one of five gapfilling methods to determine their            sequence first gaps less than  bp were sequenced            using custom primers designed by consed and a kb or            kb plasmid as DNA template second gaps between             bp and  kb that were spanned by a kb clone were            completed by sequencing the kb clone using a            transposonbased sequencing strategy described below            third gaps between  kb and  kb that were spanned            by a kb clone were completed by sequencing the kb            clone using a transposonmediated sequencing strategy            fourth gaps larger than  kb were completed by            sequentially sequencing multiple kb clones to walk            across the gap At LBNL very rarely a PCR product was            generated and sequenced using custom designed            primers            HGSCs initial approach to gap closure of L was to            design primer pairs to span each gap One thousand            basepairs of sequence flanking each gap  bp            total per gap was extracted from the published            chromosome sequence The flanking sequences were masked            for repeats using Repeatmasker   and then  bp            PCR primer pairs were chosen for each gap using PRIMER               such that the predicted melting temperature            was   C for gaps of less than  bp and              C for gaps of more than  bp We successfully            generated PCR products for  gaps up to  bp            Internal sequencing primers were synthesized for            sequencing PCR products less than  bp PCR            products greater than  bp were treated one of two            ways If the sequence of the product corresponded to a            known transposon a battery of custommade sequencing            primers evenly spaced across the element was used to            generate the sequence Alternatively random shotgun            libraries were generated and sequenced to   coverage            HGSC used phrap to assemble individual BACs and derive            quality scores Four BACs containing large nearly            exact duplications refractory to assembly by phrap            were resolved using the Euler assembler                                  Sequencing  and kb clones            LBNL and HGSC sequenced kb clones using different            strategies as part of the finishing process LBNL            employed a  transposonbased strategy to sequence            kb clones essentially as described   An             in vitro transposition system            Finnzymes TGS was used to sequence kb clones            Either  or  colonies per clone were selected for            sequencing of  or kb clones respectively            kb clones at HGSC were usually sequenced using            shotgun libraries Libraries were prepared according to            the double adaptor method   with the following            modifications DNA was sheared using the Hydroshear            Gene Machines San Carlos CA at speed code  for             cycles The phenol extraction and ethanol precipitation            after end repair and ligation steps were replaced with            purification using Qiagen PCR Cleanup columns Shotgun            libraries of PCR products were constructed as the other            libraries but without the sizeselection step and with            an increase in the shearing pressure from  to  psi            and increase in time from  to  min Some clones at            HGSC were sequenced using the EZTN KAN Tn            transposonbased strategy                                  Quality            BAC assemblies in a single sequence contigs were            evaluated for basepair accuracy using the phrap            consensus quality scores Regions of low quality were            identified and sequenced using custom primers designed            by Consed Autofinish   to bring the estimated error            rate to less than one error in  bp Completed            highquality BAC sequence was submitted to GenBank            Unfinished BACs were submitted to GenBank as phase             sequence Tandem duplications were resolved by adding            phd files from subassemblies In cases of multiple            identical copies of repeated sequence phd files were            used to generate an accurate assembly but not            necessarily an accurate quality score as it is            impossible to automatically constrain the location of            individual traces At LBNL  BACs  Mb            nonredundant sequence had no difficult repeats and            assembled easily using phrap For the  BACs  Mb            of nonredundant sequence that included a finished            sequence of a P clone the assembly was driven by the            P sequence In order for phrap to correctly assemble             BACs  Mb nonredundant sequence it was            necessary to include phd files corresponding to either            the sequence of a kb totaling  Mb or a kb            totaling  Mb plasmid or other phd files totaling             Mb to obtain a correct assembly see Repeat            assembly below for more details                                Assembly verification            At LBNL BAC assemblies were viewed using phrapview            which was customized to recognize our kb kb and            kb subclones and display the pairedend            relationships with a colorcoded key Clones that were            beyond acceptable size or orientation parameters are            visualized in red as problem clones Clusters of such            clones indicate a collapsed repeat or misassembly At            HGSC in addition to phrapview BAC assemblies were            verified by comparing the order of the reads in the            Release  assembly with the order of the reads in the            contigs generated using phrap and correlating the            expected gap size with the completed sequence This            enabled rapid visualization of largescale            discrepancies such as collapses or inversions between            the WGS and the phrap assemblies Final BAC assemblies            were then verified by comparing the virtual restriction            digest to             Eco RI             Bam HI and             Hind III fingerprints produced by            HGSC and manually called at LBNL and HGSC Band sizes            in the range of  to  kb were used for comparison            At LBNL Release  BAC sequence assemblies were also            compared to the Release  sequence from that region            using Sim to analyze the largescale assembly and            Sim to identify basepair differences                                Repeat assembly            At LBNL we developed two custom assembly programs            assembleSubclonepl and deconstructpl to facilitate            resolution of tandem repeats AssembleSubclonepl was            used to join the two traces generated by primers in            opposite direction from the same transposon insertion            prior to phrap assembly of  or kb plasmid clones            this process effectively doubles the read length A phd            file generated from the assembly of the plasmid clone            was used to direct the BAC assembly Deconstructpl was            used to resolve collapsed repeats provided that            sufficient variation exists in the repeat copies Using            deconstructpl we extracted local regions from the            main assembly and reassembled the associated traces and            their mate pairs at high stringency using phrap The            resulting consensus sequence was then incorporated in a            reassembly of the entire BAC                                Arm assembly and overlap verification            Quality scores and consensus sequence from the BAC            assemblies were exported from Consed Chromosome arm            assemblies were generated by determining the overlap            between neighboring BACs using pslayout LBNL a            program developed for this purpose as part of the human            genome project   or by BLAST HGSC Discrepancies            in overlap regions were reviewed and resolved The            programs Assemblearms LBNL or BACstitcher HGSC was            used to generate a FASTA file of the chromosome arms            starting with the first BAC in the tiling path and            adding the unique sequence from the adjoining BAC to            extend the sequence contig To assess the accuracy of            the chromosome arm assemblies we determined the            location and orientation of the BACend sequences using            a customized version of Sim   we also checked            that each gene present in the annotated Release             sequence was appropriately located in Release  using            BLAST To generate quality scores for an entire            chromosome arm we associated a phrap consensus score            with each base In regions of overlap between            neighboring BACs the highest consensus score was used            Gaps represented by Ns were not given a consensus            quality score and did not contribute negatively to the            estimated error rate Sequence and physical map gaps            are representing in the arm assembly by sets of Ns One            thousand Ns correspond to physical map gaps If the gap            size could be estimated it was filled with the            corresponding number of Ns            At HGSC unfinished BAC sequences were used to            produce chromosome X  and chromosome L arm            assemblies if the unfinished portion of the BAC was            limited to one or two short  kb regions of the            clone but was high quality everywhere else At HGSC            regions of the Release  sequence were used to produce            chromosome X  and chromosome L arm assemblies if            BAC clones spanning these regions had not yet been            identified In regions of overlap between finished            clone and either unfinished or Release  sequence            BACstitcher preferentially incorporated finished            sequence                                    Sequence comparisons of Release  to Release                    In order to quantify the basepair differences between          Release  and Release  we aligned the sequences using          MUMmer v    We searched for maximal exact matches          of at least  bp From the list of exact matches we          generated a path of ordered and oriented matches that          served as landmarks for subsequent analysis In regions          where discrepancies were detected we compared Release           and Release  sequences using Sim   to determine          subintervals of high similarity within the sequence and          to count the number of individual basepair differences          within each subinterval          Each unmatched segment was classified according to the          nature of the mismatch as follows known gaps in Release           which are filled with sequence in Release  newly          discovered gaps in Release  defined as  bp or more of          sequence that does not align with Release  using Sim          and regions containing single nucleotide differences          between Release  and Release  defined as less than           bp of sequence that does not align with Release  using          Sim          Release  sequence was used to characterize the          content of the known and newly discovered gaps in Release           The sequence content was annotated as transposable          element homopolymer simple repeats tandem repeats          misassemblies unique gross misassemblies and unfilled          for those gaps that remain in Release  Transposable          elements were identified using a curated list described          in   Homopolymers and simple repeats were determined          using RepeatMasker Tandem repeats were identified using          Sim and the Release  gap sequence and the adjacent          neighboring sequences If the gap filling sequence showed           Sim similarity to the neighboring sequences it was          classified as a tandem repeat Release  sequence that          does not align with Release  was compared using Sim and          the adjacent neighboring sequence If the unaligned          sequence showed  sim similarity to the neighboring          sequences it was classified as a misassembly Any          interval not falling into one of these categories was          considered unique The seven gross misassemblies are          described in Results and discussion                          Modifications to the WGS assembler          Between each assembly the assembler was revised and          improved The basic algorithmic strategy for WGS is to          first assemble the unique segments of the genome and          then resolve repeats The assembler that produced WGS          and the precursor to Release  used algorithms and code          that had weaknesses with repeat resolution Between WGS          and WGS we corrected an error in the first step of          repeat assembly  placement of repeat traces that are          paired with an end read that lies in unique sequence          This allowed us to remove the second step in the original          assemblers repeat reconstruction strategy in which          repeat traces were added to the assembly even when they          were not paired with a unique read This step was the          cause of most of the inaccurate repeat reconstructions in          Release  In addition the overlap step of the assembler          no longer requires explicit knowledge of genomespecific          repeats Between WGS and WGS the primary improvement          was the introduction of a sequence errorcorrection          algorithm that allowed us to improve the sequence quality          of every read by examining its relation to all the other          reads This allowed us to tighten the stringency of          overlap leading to improved assembly especially of          repetitive regions                          Sequence comparisons of Release  to WGS   and                    The three assemblies were compared to Release  by          first finding the best possible mapping of those sequence          segments of the assembly that represent portions of the          finished sequence This task is complicated by nearly          identical repeats that appear to align a portion of an          assembly to every copy of the repeat We proceeded in          three steps First every contig was compared against the          sequence of Release  using a local variation of MUMmer          to produce a collection of significant aligned segments          Second all of the scaffolds for which there are          competing matches and are either under  kb and do not          have at least  of their sequence matching or are over           kb and do not have at least  of their sequence          matching were removed from consideration What remains          are scaffolds that clearly contain sequence belong to the          euchromatin with the exception of small scaffolds that          were almost certainly entirely repetitive Third the          remaining matched segments were then reduced by a greedy          algorithm   to a onetoone nonoverlapping sequence          of matches that was considered to be the relevant tiling          of Release  by each assembly The set of scaffolds          having a segment match in the oneto one tiling was          considered to be mapped to Release  The heaviest weight          common subsequence HCS between the WGS and Release           orders was computed where the weight of each match was          its length this order was taken as the correct order          within each WGS assembly Matched segments in the          assemblies that were not in the HCS were considered order          and orientation errors We focused on the maximal set of          matched segments to Release  without regard to their          orientation and position on the contigs and scaffolds of          the assembly Thus we will see any inconsistencies          between our assembly and Release  The content of the          gaps in the WGS assemblies were identified using a repeat          database and a tandem repeat finder   run with the          default settings                    