                    Background                  Gamma distribution Input          The use of a predetermined parametric function for          It is the most direct approach It is shown below that          a good fit to a variety of experimental intestinal          absorption processes is provided by the  parameter          Aab gamma distribution                     I            t             Ab           a           t           a exp           bt            a           where A is the total amount reaching the systemic          circulation  is the gamma function a is the gamma          number usually between  and  and b has units of          inverse time The gamma distribution is clearly superior          to polyexponential functions for fitting the initial          time delay in absorption associated with gastric          emptying The use of a gamma distribution to model          absorption was first suggested by Debord et al              The  parameters are determined by the use of global          simulated annealing and local Powell nonlinear          optimization                          Analytical Deconvolution          In this approach ct eq  is approximated by an          interpolating or smoothed spline function and the          deconvolution uses the analytic approach of VengPedersen              and Gilespie and VengPedersen     This          approach is used in the freely distributed program PCDCON          written by Gillespie          httpanesthesiastanfordedupkpdand is the most widely          used experimental deconvolution technique                                            Spline Function Input          This method uses the approach of Verotta     in          which the input It is parameterized by a general          Bspline function and the deconvolution is obtained using          constrained regression                          Uniform Input          In this approach the function It is estimated on a          dense uniform sequence of time points and the stochastic          regularization procedure of De Nicolao et al    and          Sparacino et al     is used for the          deconvolution          Since each of these approaches has been extensively          described and compared previously what justifies the new          treatment in this paper There are  new features           The four above mathematical approaches to the          deconvolution problem are implemented in the software          package PKQuest This software has a simple user          interface and automatically plots the results in a          variety of formats This easy to use freely distributed          program httpwwwpkquestcomallows anyone to use and          compare the different approaches for different          experimental data sets           The last  approaches are characterized by a number          of user input parameters whose values are not known a          priori In the previous applications of these routines          these parameters had to be varied and the best value          found either based on the subjective judgment of the user          about the quality of the fit or by a semiempirical          optimization procedure This represents the major          limitation of these techniques In this paper a new          method is introduced for determining the value of these          parameters for the last two methods Spline function          and Uniform based on the use of a gamma distribution          approximation for It           Previous tests of the different approaches have          used either idealized model data or experimental data in          which the true values of the bolus input function rt          and the systemic input function It were not known In          contrast in the analysis described here the different          methods will be tested using the same PBPK model that was          used to determine rt In general all the methods work          well if accurate experimental data are used see below          The most stringent test of the different methods is under          conditions when there is random error in the data points          and sampling frequency is limited as is often the case          for the experimental data This latter case is          investigated in this paper                            Methods                  Generation of PBPK Model Venous Concentration          Data          The model venous concentration data for the          intravenous IV and intestinal input are generated using          the PKQuest httpwwwpkquestcomPBPK software The          standard human PBPK organ weights and blood flows are          listed in Table I These are the same values that have          been used previously to model the pharmacokinetics of D            O and ethanol     toluene and          the volatile anesthetics     propranolol    and          inulin and protein bound antibiotics     Two          different PBPK models are used In the first model          referred to as simple the solute distributes with          flowlimited kinetics in all the body water and there is          no solute binding In the second model referred to as          binding the different tissues bind the solute with a          tissueplasma equilibrium partition coefficient of  for          all tissues except muscle where it is  and fat          where it is  This model is similar to that used to          describe human propranolol pharmacokinetics     The          model input goes directly into the venous compartment          bypassing the liver and the solute clearance is produced          entirely by renal secretion so that the input function          absorption rate is equal to the systemic          availability                          Determination of Polyexponential Bolus Response          Function          The standard approach is used for determining the          bolus response function rt It is assumed that rt is          described by a polyexponentials function                    The optimum values for the parameters a           i  T           i  are determined by using the Maple          implementation of the nonlinear Levenberg and Marquardt          method nlfit          httpwwwmathvillanovaeduarchivesmaplemisc Some          care must be used in the application of this technique          because if the initial estimates of a           i and T           i are far from the correct values          then for the exponential case it is possible for the          solution to become stuck in a local minimum far from the          global minimum In the implementation in PKQuest a           exponential fit is found first and this fit is used to          estimate the initial values for the exponential fit          This procedure seems to be quite robust                          Gamma distribution Deconvolution          It is assumed that the input function can be described          by a  parameter Aab gamma distribution eq  The           parameters are chosen by minimizing the error          function                    where the sum is over all the data points ydat           i is the experimental venous          concentration and ygam           i is the venous concentration          determined by convoluting the gamma distribution input          eq  with the polyexponential bolus response function          rt eq  The parameter noise determines the          relative weighting of each data point If noise   then          the error is proportional to the sum of the fractional          error ygamydatydat of each point while for          noiseydat the error is proportional to the sum          of the absolute error ygamydat of each point In the          current implementation noise is assumed to be equal to           of the value of average venous concentration ydat           i  Since the convolution of the          gamma distribution with rt is a highly nonlinear          function it is essential to use a robust optimization          procedure to avoid local minimums In the implementation          in PKQuest a global annealing procedure    is          applied first followed by Powell    nonlinear          minimization                          Analytical Deconvolution          The approach described originally by VengPederesen              is followed The discrete venous concentration          data c i eq  is fit with either an interpolating          which goes through each data point or a smoothing cubic          spline function and then the deconvolution is obtained          analytically using this spline function The spline          fitting algorithms of Spath    were used for both the          interpolating cubr and smoothing cubsm          conditions In the smoothing algorithm the spline points          differ from the experimental data points by an amount          that is proportional to the jump in the third derivative          of the cubic spline function The proportionality          constant is assumed to be the same for each data point          and is set by a user input smoothing parameter that          varies from  interpolating case to infinity This          implementation is not identical to that used in program          the PCDCON written by W R Gillespie          httpanesthesiastanfordedupkpd However when the          same input was used for PCDCON and the current          implementation the results were very similar                          Spline Function Deconvolution          The deconvolution approach of Verotta    is used          The input function It is parameterized by a Bspline          function characterized by the number and position of the          breakpoints and the order of the spline function An          order of  is assumed The deconvolution is obtained          using the Penalized LeastSquares regularization          approach     where the regularization parameter          referred to here as a smoothing parameter limits the          roughness of the Bspline function The input rate It          is constrained to nonnegative values by using the          constrained conjugate gradient algorithm  of          Hestenes              The quality of the deconvolution solution is          critically dependent on the number and position of the          break points see Results Section In the implementation          in PKQuest a number of alternative options are allowed          for choosing or inputting the break points Since this          method is a generalized parametric approach one would          like to use the smallest number of breakpoints and          therefore the fewest adjustable parameters that are          compatible with the input function A new feature that is          introduced here is the use of the gamma distribution          input approximation to automatically select the          breakpoints this is the default option in PKQuest This          method first chooses the breakpoints that provide a good          fit to the gamma distribution and then supplements these          breakpoints with additional points at  hour intervals          at long times when the gamma distribution is small By          trial and error it was found that the minimum number of          break points that provided a good fit to the gamma          distribution were located at the times the gamma          distribution concentration equaled               and  times the maximum gamma distribution          value As shown in the Results Section this procedure          works well for the typical intestinal absorption input          functions                          Uniform Input Deconvolution          The method of De Nicolao et al    which solves          for the values of the input function on a uniform dense          set of time points is used Only the constrained option             is used since it is essential to limit the input          function to nonnegative values De Nicolao et al             describe a sophisticated mathematical approach using the          fast fourier transform FFT However in the          implementation in PKQuest using Maple it was observed          that the overhead required to set up the FFT approach          used more CPU time than the more direct implementation          that was finally adopted          This approach is critically dependent on the          regularization parameter referred to in this paper as          smoothing parameter and De Nicolao et al             described a number of criteria for choosing the best          value of this parameter In PKQuest a new option is          introduced that uses the gamma distribution input          function to obtain a default value of the smoothing          parameter The error function that is minimized to          determine the input vector U is the sum of two terms                                  Error Function             Y            GU            T            Y            GU              U           T            F           T           F            U           In the first term the matrix YGU is a measure of          the error difference between the experimental venous          concentrations Y and the model values given by the          convolution of the input vector U and bolus input          function operator G The second term is a measure of          the roughness of the data where  is the smoothing          parameter and F is the second difference matrix The new          procedure that is used to estimate the smoothing          parameter  is to set the input vector U equal to the          approximate gamma input function and solve for the value          of  that makes the two terms in eq  have equal weight          This calculation of  is limited to time points where the          value of the gamma distribution is greater than  of the          peak value of the gamma distribution  that is points          where the gamma distribution provides a good          approximation Although this choice of equal weights is          empirical and was based on trial and error on one set of          data it seems to work well for a large range of          experimental data even when the actual input differs          significantly from a gamma distribution see Results          Section                          PKQuest Implementation User Interface and          Graphical Output          All the deconvolution procedures and the software code          used in this paper are freely available on the web          httpwwwpkquestcom The complete deconvolution          procedure is called by a short Maple worksheet One          simple example is shown below                      sampledeconvproc                                  The following ivinput is for a             minute IV infusion of  micromoles ninput                                 ivinputtabletype  amount             tbeg  tend                                    Venous concentration data time            conc resulting from above IV input                                 ivdata                                                                                                                                        Venous concentration data following            an unknown input                                 absdata                                                                                                                                                             deconvolutiontableusedata             fitfunc  plotinput  Nexp  breakpoint              scalesmooth                                              convolvewritedircunitivinputivdataabsdatasyspargammapargammaparmod            deconvolution                                 end proc                     The amount and time course of the IV input that is          used for the calculation of the bolus response function          rt is characterized by the Maple table           ivinput  The venous concentration          data is described by the parameters           ivdata used to determine rt and                    absdata venous concentration          resulting from unknown input The data can also          optionally be read in from a data file The parameter           deconvolution is a Maple table          characterizing the type of deconvolution calculation           usedata determines whether the          bolus response function the input function or both          functions are found           fitfunc determines the          deconvolution technique that is used           plotinput specifies the graphical          output           Nexp is the number of exponentials          in the bolus response function           breakpoint is either the type of          procedure used to determine the breakpoints for the          spline deconvolution or the time interval for the          uniform deconvolution and           scalesmooth scales the smoothing          parameter The deconvolution procedure is run by the call          to the           convolve procedure In addition          to the above parameters a number of optional parameters          can be entered           writedir is the directory where the          input function is written           cunit eg  micromoles is the          amount unit used in the output plots           gammapar and           gammaparmod are the gamma parameter          input and model function parameters and           syspar is the bolus response          function parameters these  inputs are optional          depending on the type of calculation and graphical          output Sample deconvolution procedures and a detailed          Manual and Help pages can be downloaded from the PKQuest          web site          When the above procedure is run a large number of          different graphical plots are output The calculations of          the bolus response function rt are routinely described          by the following four plots that compare the venous          concentration determined from rt versus the          experimental data the early time points  the late          time points  a semilog plot of all the time points          and  all the time points Three of these plots are          shown in figs to  Three different statistical tests          are applied to the rt calculation so that the user can          determine whether a  or  exponential function should be          used              The deconvolution calculation of the unknown input          function It is routinely described by the following          three plots  Plot of the calculated It versus time          along with a comparison with the gamma distribution          deconvolution optional and the model gamma distribution          input optional  Comparison of the calculated          deconvolution venous concentration with the experimental          data and  Plot of the total amount of absorption          versus time Examples of plots  and  are shown in          figs and  In addition if           writedir is specified then a text          file describing It is written All of the plots shown          in this paper are copied directly from the standard          PKQuest output                          Detailed Description of Deconvolution Data Test          Sets          The tests of the deconvolution procedure in this paper          are based on two sets of data one with a single gamma          distribution input and one with this same gamma          distribution plus a delayed smaller gamma distribution          input In this section a detailed description of these          data sets is provided so that other investigators can use          this data as deconvolution test cases          For both sets of data the system unit bolus response          function was                     r            t              e            t             e            t             e            t           The single input was a gamma distribution eq  with          A  mm a   b   min that started at time            For the two input case a second gamma input was          added with A   mm a   b   min that          started at t   minutes For the single input the          data was sampled at   and           minutes The exact venous concentration          micromoleliter data for the single input at these          times was                  The corresponding data          for the three noisy data sets was Noisy                              Noisy                    Noisy                              The two input data was sampled at                     and           minutes The exact venous concentration data at these          times was                   The          corresponding data for the three noisy data sets was          Noisy                       Noisy                                 Noisy                                                            Results                  Use of a gamma distribution to describe the rate of          intestinal absorption          In PKQuest a recently introduced PBPK software          routine a new approach is introduced that provides a          direct measure of the rate of intestinal absorption of a          solute if the PPBK parameters are known Figure shows          the result of applying this technique to experimental          data for three different solutes in humans ethanol             with or without a meal standard propranolol             and a long acting form of propranolol     The          squares in these figures describe the time course of the          total absorption as determined by PKQuest The solid line          is the gamma distribution fit eq  to the squares It          can be seen that in all cases the parameter gamma          distribution provides a good fit to the experimental          data The standard propranolol absorption rate fig           lower left panel has a long initial time delay followed          by a steep rise  a time course that is especially          difficult to fit with other functions eg exponential          Hill equation but is closely fit by the gamma          distribution For this reason the gamma distribution has          been chosen in this paper as the function of choice to          model intestinal absorption data It also provides a good          fit to absorption from other sites eg skin          intramuscular and intraperitoneal                          Use of a PBPK Model to Evaluate the Accuracy of the          Determination of the Bolus Input Function rt          The accuracy of the determination of rt will be          evaluated  different ways In the first test a          continuous venous concentration curve will be generated          using a known constant IV input to the PBPK model This          continuous curve will then be sampled at varying discrete          time points which will be used to determine rt          Comparing the venous concentration curve determined using          this rt with the original PBPK venous data provides a          direct test of the accuracy of rt In the second test          this rt will be used to calculate It by applying eq           to the venous concentration data produced by a known          gamma distribution input to the same PBPK model          Comparison of the deconvolution It versus the actual          model input provides another indication of the accuracy          of rt The model intestinal input gamma distribution          parameters are similar to the absorption parameters for          the standard propranolol shown in fig A   millimole          a   b   min           The results will be presented for the two different          PBPK models a the solute distributes in all the tissue          water with no tissue binding referred to as simple          model and b there is tissue binding of the solute          similar to what is observed for propranolol referred to          as binding model see Methods section for a detailed          description In both models it is assumed that the          solute clearance is produced only by renal secretion and          the model input is directly into a systemic vein          Results will be shown for a  or  exponential response          function for venous concentration data sampled at high          resolution                       and  minutes and low resolution                   and  minutes The          first time point for the high resolution data is at           minutes and considering the experimental mixing and          delay artifacts one probably cannot expect to be able          make accurate measurements at times before this For each          case the results of a minute constant infusion will          be compared with a second constant infusion The          second infusion is meant to mimic an experimental          bolus input          Figures to quantitate the accuracy of the          determination of the bolus response function rt under          various conditions In each figure the black line is the          exact model venous concentration resulting from either a          second left column or minute right column          constant IV infusion into the PBPK model system The          black squares are the discrete venous concentration data          points that were used to determine rt The red lines in          these figures are the venous concentration curves          resulting from convolution of the calculated bolus          response function rt with the model input function The          first row shows the fit for the early time points the          second row for the long time points and the third row is          a semilog plot for all the data The bottom row compares          the true model intestinal gamma input function green          with the intestinal input rate determined by the gamma          distribution deconvolution method see below using this          rt black          Figures and show the results for the simple PBPK          model using a exponential bolus input function rt for          the high fig  and low fig  time resolution data          For a minute constant IV infusion right column figs          and  the venous concentration calculated using the          expononential rt red line provides a good fit to          the entire time course of the model venous concentration          black line As expected for this good estimate of rt          the deconvolution intestinal absorption rate determined          using this rt bottom row black line right column is          very close to the true model input function green          line          For the second constant infusion left hand column          there is a sharp early spike in the venous concentration          which must be fit by extrapolation of the venous data          points back from the first data point at either           minutes high resolution fig  or  minutes low          resolution fig  In each case this extrapolated          venous concentration red line is a poor approximation          to the true model venous concentration black The          bottom row in these figures quantitates the influence of          this early time error on the determination of the          intestinal absorption rate by deconvolution by comparing          the model rate green versus the deconvolution rate          black It can be seen that for this simple model the          error in the deconvolution intestinal absorption rate is          quite small despite the large early error in the venous          concentration          Figures to show a similar set of results for the          binding PBPK model The tissue binding increases the          volume of distribution and results in a more          complicated venous concentration time course One          indication of this complicated times course is that a          exponential bolus response function rt no longer          provides an accurate description of the venous          concentration for the high resolution exact data fig           right column In contrast a exponential rt provides          a nearly perfect fit fig  Surprisingly despite the          poor fit to the venous data using the exponential rt          for the  minute infusion the intestinal absorption          rate fig  bottom row right determined by          deconvolution using this rt is in good agreement with          the model input green          For the second constant infusion using the binding          model left hand column figs to  the venous          concentration predicted using rt for the times          preceding the first experimental time point  minutes          for high resolution  minutes for low resolution          differs markedly from the true model venous          concentration The corresponding error in the intestinal          absorption rate is small when the first data point is at           minutes high resolution data figs and  but          becomes large when the first point is at  minutes low          resolution data figs and           For the minute constant infusion an accurate          determination of both the bolus response function and the          input can be obtained when the first venous sample is at           minutes fig  right column This illustrates the          importance of adjusting the sample times to the IV input          conditions Figure shows a similar result for a          minute constant infusion with the first sample point          at  minutes This suggests as a general rule that an          accurate determination of the response function only          requires that the first sample point be obtained at or          before the end of the constant infusion          It is clear from these results that one cannot judge          the accuracy of the response function from the agreement          between the model ie experimental data points          squares and the calculated venous concentration using          this response function For example the poorest fit to          the intestinal absorption function is for the low          resolution second input fig  left column even          though there is nearly perfect agreement between the data          points and the predicted venous concentration using the          exponential rt The error results from the incorrect          predicted venous concentrations for the times preceding          the first data point at  minutes                          Evaluation of Deconvolution Procedures          In this section the four different techniques          described in the background section will be used to          determine the intestinal absorption function It by          deconvolution see eq  The accuracy of the different          methods will be tested by the use of a known intestinal          input to the PBPK model to generate the absorption venous          concentration data The It determined by deconvolution          of eq  using this data and the previously determined          bolus input function rt will then be compared with the          actual model input Results will be shown only for the          binding PBPK model The bolus input function rt used          in this section is the  exponential function determined          for the binding PBPK model using a  minute constant          IV infusion and the high resolution venous sampling          Since this rt provides a nearly perfect kinetic          description of this system see fig  right column          any errors in the intestinal input function It must          result from the deconvolution procedure The          deconvolution procedures will first be tested for an          intestinal input rate described by the same gamma          distribution used above for figs                gamma distribution parameters A  millimole a            b   min  In order to evaluate the          deconvolution methods for a more general input function          that cannot be described by a single gamma distribution          the procedures will also be tested for the case where the          input consists of two distinct gamma distribution a          large standard input and an additional smaller delayed          component This input mimics the case of an intestinally          absorbed solute that is excreted by the liver and then          reabsorbed enterohepatic circulation Only the low          resolution time points                   and  minutes will be used in this section          The high resolution time points used above do not          improve the estimate of the absorption rate since the          additional points are at early times before any          significant absorption occurs Although these low          resolution time points are quite sparse they are          representative of the limited sampling rate that is          experimentally available                          Gamma distribution Input Deconvolution          This is the approach that was used above in figs                bottom row to determine the intestinal          absorption function As shown in those figures when an          accurate bolus response function rt was used eg fig           this method returned a nearly perfect fit to the          model input function This is not surprising since the          model input was also a gamma distribution Figure shows          another test of this deconvolution method using noisy          venous concentration data The noisy data is generated by          adding random noise to each venous concentration data          point c i eq  generated using the gamma          distribution input to the binding PBPK model                     c            i             c            i             R            i             c            i             Noise            i           where R i and Noise i are normally distributed          random variables with a mean of  and standard deviations          of  and  millimolesliter respectively This adds          a random error of  to each point and an additional          absolute noise with a mean error of           millimolesliter          Each row in fig shows the results for a different          set of random noisy data The left hand column compares          the deconvolution intestinal absorption rate black line          with the model input rate green line The right hand          column compares the corresponding deconvolution based          venous concentrations red line with the noisy data          points squares that were used to calculate the          deconvolution input The calculated intestinal absorption          rate provides a good approximation to the actual input          for each noisy data set The total intestinal absorption          calculation from the deconvolution varies from           middle row to  bottom compared to the actual          input of  millimole This approach is inherently robust          since there are only  adjustable parameters and the          shape must be a gamma distribution                          Analytical Deconvolution          In this approach the venous concentration data are          fit with a spline function which is then used for an          analytical deconvolution The spline fit can either be an          exact interpolated fit that passes through each data          point or a smoothed fit that limits the degree of          curvature allowed in fitting the points see Methods for          details This latter case is essential when fitting          noisy data In the implementation of this method in          PKQuest the user sets a smoothing parameter that          varies from  interpolating spline to infinity The          parameter has been scaled so that for each deconvolution          method a value of smoothing   provides a good first          estimate          Figure shows the result of applying this approach to          the exact venous data for  different values of          smoothing Using an interpolating spline smoothing            provides a nearly perfect fit to the model data For          smoothing values of  or greater the deconvolution          results differ significantly from the model data Despite          the error in the shape of the curve the deconvolution          estimate of the total absorption remains accurate For          example for the smoothing   curve the total          calculated absorption is  compared to model input of           millimole          Figure shows the analytical deconvolution results          using the same  sets of noisy data that were used in          fig for the gamma input deconvolution method Each          panel in fig compares the intestinal input rate          determined by this method black with the exact model          input intestinal absorption rate green and the rate          determined by the gamma input method in fig red Each          column in fig is for one set of noisy data and the          results for  different values of the smoothing parameter          are shown in the  rows The best fits for the three          sets columns of noisy data are for a smoothing          parameter of  first column  second column and           third column although this choice is clearly          subjective This figure illustrates that for this method          the intestinal absorption rate may have nonphysical          negative values The negative region decreases as the          smoothing parameter is increased This is one of the          major limitations of this approach The other  methods          can be constrained see Methods for details to prevent          this                          Spline Function Input          This method uses the approach of Verotta     in          which the input is parameterized by a general Bspline          function and the deconvolution is obtained using a          constrained regression method that prevents the input          rate from having negative nonphysical values There          are two sets of user input adjustable parameters for this          method the choice of the time breakpoints for the          Bspline function and the value of the smoothing          parameter that penalizes the fits that have too sharp a          curvature see Methods for details As was the case for          the gamma distribution and analytical deconvolution          techniques this method also returns a nearly perfect fit          to the model data when applied to the exact data not          shown          Figure shows the results of the application of this          deconvolution method to one of the noisy data sets used          in fig first row and fig first column The two          columns in fig correspond to the results for two          different sets of breakpoints and the different rows are          for different values of the smoothing parameter These          results show the critical dependence of this method on          the choice of time points used for the breakpoints The          excellent fit on the left uses breakpoints at                 and  minutes The poor fit on          the right has  additional breakpoints at  and           minutes          The choice of time points for the good fit in the left          column of fig is based on the application of the new          approach introduced here If one knows a priori that          the absorption rate approximates a gamma distribution          then the spline break points can be chosen to provide an          optimal fit to this gamma distribution see Methods for          details In the implementation of the spline function          approach in PKQuest there are a number of options for          choosing the breakpoints One of these options is based          on first finding the gamma distribution approximation to          the intestinal absorption fig  and then using this          function to select the break points          The left hand column in fig also illustrates that          if this optimal set of breakpoints is used the quality          of the fit is relatively independent of the value chosen          for the smoothing parameter This is a major advantage of          this approach because it means that an accurate estimate          of the intestinal absorption can be obtained using the          default set of parameters without any subjective user          decisions          Figure shows the fit using this default set of          breakpoints using the gamma distribution approximation          and smoothing parameter    for the same  noisy data          sets that were used for the analytical fig  and          spline function fig  deconvolution methods The          intestinal absorption rate determined using this approach          is as good as the gamma distribution approach This may          not surprising since the gamma distribution has been used          to choose the break points A better test of this          approach to choosing the breakpoints is described below          where an input that is clearly not a gamma distribution          is used                          Uniform Input          In this approach the intestinal absorption function is          determined on a uniform dense sequence of time points          and the stochastic regularization procedure of Nicolao          et al    and Sparacino et al     is used for          the deconvolution This approach also constrains the          solution so that the input rate cannot be negative In          this approach one solves for the concentration at many          more time points then there are data points and the          system is highly underdetermined The system becomes          solvable by adding a constraint on the smoothness          regularization of the solution This means that the          solution is strongly dependent on the user input          smoothing parameter which can vary over a wide range          depending on the time interval number of points and          experimental data This is the main limitation of this          approach De Nicolao et al    have discussed several          different criterion for choosing the best value of this          parameter These criteria are quite CPU intensive because          they involve the repeated determination of the fits for a          large number of different values of the smoothing          parameter and then using statistical tests to select the          best value In this paper a new simpler approach is          used to estimate the value of this smoothing parameter          again based on the assumption that the intestinal          absorption rate can be approximated by a gamma          distribution see Methods for details Another user          adjustable parameter for this method is the unit time          interval tdel the corresponding time points where the          solution is obtained are at  tdel tdel tdel          There are several constraints on the choice of tdel This          interval should be a common divisor of all the          experimental time points so that the experimental points          fall on the uniform time grid The implementation in          PKQuest rounds the experimental points to the nearest          uniform point and if the rounding only amounts to a few          percent the error will be negligible The other          constraint on the time points is that the CPU time for          the constrained nonnegative solution in the PKQuest          implementation scales roughly as the square of the number          of time points and thus CPU time constraints limit the          size of the time interval Since solute absorption is in          general a slowly varying and smooth process relatively          long time intervals can be used and this latter          constraint is not usually limiting          Figure shows the intestinal absorption rate          determined with this approach for the exact data and the          same  noisy data sets that were used in figs  and           A time interval of  minutes was used for these          results The values of the intestinal absorption rate          determined by this method at the uniform set of time          points open squares is compared with the model input          green and gamma distribution deconvolution result          red All the fits use the default smoothing parameter          determined from the gamma distribution fit to this same          data fig  Although the fit is very good for the          exact data using this default smoothing parameter a          better nearly perfect fit to the model rate is obtained          not shown using a smaller  smoothing parameter          For the  noisy data sets the default value corresponds          to the best fit Although the intestinal absorption          rate determined with this method for the first noisy data          set is slightly worse than the other methods the fits          for the other  noisy sets is as good or better than          the other methods compare figs  and                           Two Component Intestinal Input  Comparison of          Different Deconvolution Methods          In this section a more complicated model intestinal          input function is used in which a small delayed component          is added to the major component The major component is          started at zero time and is a gamma distribution that is          identical to that used in figs      A            mm a   b  min  The second component          is a gamma distribution that has parameters A           millimoles a   b  min and that begins at          time   minutes This second component has a total          input of  millimoles   of the major input and a          time course that is spread over twice the time of the          major input The venous concentration for this  input          case is sampled at three additional time points at            and  minutes in order to resolve the delayed          absorption time points                      and  minutes This input          mimics the situation of an orally administered drug that          is excreted by the liver and then reabsorbed The ability          of the deconvolution techniques to identify this second          component using noisy data presents a difficult          challenge          Figure compares the deconvolution calculation of the          intestinal absorption black versus the actual model          input green for the four deconvolution methods using          the exact venous concentration data The gamma          distribution fit is poor because it assumes that the          input can be described by a single gamma distribution          The fits for the other  methods are very good The          spline function bottom row left and uniform          bottom row right deconvolution methods use the default          input parameters smoothing and breakpoints determined          using the gamma distribution fit to this data top row          left see Methods As described above for the          analytical approach the smoothing parameter must be          adjusted by the user for each experimental situation to          determine the best fit In fig  for this exact          data a smoothing parameter   is used corresponding to          the interpolating spline fit The total amount of          absorption determined using the  methods is actual          input   gamma distribution  analytical           spline  and uniform           Each column in figure compares the results of the           general deconvolution methods applied to same  sets of          noisy data rows As before the noisy data is          generated by applying eq  to each exact venous data          point c i with R i and Noise i normally          distributed random variables with a mean of  and          standard deviations of  corresponding to  of the          absolute value and  millimolesliter respectively          For the results in this figure it is assumed that the          user has no a priori information about the correct value          and therefore is required to use the previously          determined default values for the user input parameters          For the analytical deconvolution this is a smoothing          parameter of  For the spline and uniform methods this          corresponds to the default value determined see Methods          using the gamma input function for this same noisy data          set All  methods indicate qualitatively that there is          a second component Overall the spline function method          seems to be superior at least for inputs with this time          course                            Discussion and Conclusions                  Use of a PBPK Model to Evaluate the Accuracy of the          Bolus Input Function rt          For the simple PBPK model in which the solute          distributes in all the cell water with no binding the          bolus response function is accurately described by a          simple two exponential function fig  The average          fractional error for the data in the right column of fig          is  an error that would certainly be swamped by          experimental error This result is consistent with the          fact that a exponential function is used in most of the          recent experimental applications of deconvolution                For the more complicated pharmacokinetic PBPK          model where there is extensive tissue binding similar to          that for propranolol a exponential function fit is no          longer adequate fig  right column average fractional          error   while a  exponential function provides a          nearly perfect fit fig  right column average          fractional error   It is surprising that the          complicated compartment PBPK pharmacokinetics can be          fit with this degree of accuracy using a  or          exponential function          Although it seems obvious that one should try to make          the venous concentration measurements as early as          possible in order to accurately determine the bolus          response function the results shown in figs                provide the first quantitative analysis of this          relationship Based on the results for the  minute          fig  right column and  minute fig  constant          infusion the following simple rule can be inferred an          accurate determination of the response function requires          that the first sample point be obtained at or before the          end of the constant infusion Intuitively one might          assume that a true bolus IV injection should provide the          best estimate of the bolus response function However          this is not correct because of the unavoidable          circulatory and mixing and time delays which make venous          concentration measurements for time points earlier than           or  minutes unreliable For this reason a relatively          long constant infusion eg  minutes is superior to a          bolus infusion This is best illustrated by comparing the          left hand column if fig with the right hand column in          fig  the second infusion with the first data point          as early as  minutes does not provide as accurate an          estimate of rt as the minute infusion with the first          data point at  minutes          In the experimental application of the deconvolution          method it is a common procedure to evaluate the accuracy          of the bolus response function rt by comparing the          venous concentration determined from rt with the actual          experimental venous concentration data This analysis          shows that this may not be a reliable procedure For          example as shown in the left column of fig  there is          a large error in the bolus response function and the          corresponding calculation of the input function          determined using the second input even though the          response function provides a nearly perfect fit to the          discrete model data This error results from the very          poor fit to the venous concentration at times preceding          the first data point at  minutes                          Comparison of the Four Deconvolution Methods          Figures        quantitatively          compare the accuracy of the intestinal input determined          by deconvolution with the actual model input Any          differences in these two input rates must be the result          of errors in the deconvolution process since the bolus          response function that is used in these calculations          provides a nearly perfect description of the system          pharmacokinetics see fig  right column As shown in          fig  the parameter gamma distribution provides a          versatile and accurate description of a number of          different intestinal input functions One would expect          that in most cases intestinal absorption and          absorption from skin intramuscular and intraperitoneal          could be approximated by a gamma distribution For these          cases the gamma distribution deconvolution is obviously          the method of choice because it has only  adjustable          parameters and the fitting process averages out most of          the error in noisy data fig  Another major          advantage of the gamma distribution approach is that          there are no user adjustable input parameters eg          smoothing parameter eliminating any user bias          If the input cannot be described by a single gamma          distribution then one of the other three more general          deconvolution approaches must be used ie analytical          spline and uniform All three of these methods can          potentially provide a nearly perfect fit to the          absorption rate if the exact venous concentration data is          used figs    An important qualification of          this statement is that this nearly perfect fit depends on          the right choice of the user input parameters All           methods are dependent on the smoothing parameter that          limits the roughness of the absorption rate In          addition the spline deconvolution method is strongly          dependent on the choice of breakpoints see fig           An important criterion for evaluating the different          methods is whether the best value of the parameters can          be determined objectively without any user bias Verotta             and De Nicolao et al    discuss a number of          different criteria for choosing these parameters          including the Akaike criterion    and the          Generalized Cross Validation     However all of          these criteria are semiempirical and the different          criteria yield different best values In addition in          order to apply these criteria the deconvolutions must be          run many times greatly increasing the time of the          calculations          A new approach for determining these user parameters          for the spline and uniform deconvolution methods is          introduced in this paper A default set of parameters          is determined without any user input based on the          assumption that the input function can be roughly          approximated by a gamma distribution This new approach          works well for the single gamma distribution input case          with these default parameters providing best fits for          both the exact and noisy data sets figs    It          is perhaps not surprising that it works for this case          since the input is close to a gamma distribution A more          discriminating test of this approach is for the two input          case when a second smaller delayed gamma distribution          is added Although this input differs significantly from          a single gamma input fig  top left this approach          for choosing the input parameters still provided good          fits for the exact fig  and noisy fig  data          sets for the spline and uniform approach Of course          if the input function has no relation to a gamma          distribution one would expect this method to breakdown          However most physiological intestinal skin          intramuscular or intraperitoneal absorption processes          should resemble a gamma distribution and this method          should be applicable          As discussed in the background section the          analytical deconvolution method of VengPedersen             is the most commonly used experimental approach It has          the advantage that is the fastest of the different          methods and for exact data it provides a good estimate of          the absorption rate fig  However this method has           major handicaps The first is that it is strongly          dependent on the value chosen for the smoothing          parameter and there is no direct technique that can be          used to objectively determine this parameter Even          knowing the standard deviation of the experimental data          which is rarely the case is not enough to determine the          best value of this parameter As shown in fig for          three different sets of noisy data all generated using          the same random error parameters eq  the best          fit has smoothing parameters varying from  middle          column to  left column The second problem is that          for the noisy data sets tested here fig  this method          provides fits to the absorption rate that subjectively          seem inferior to those determined by the other two          general deconvolution approaches spline and          uniform Also unlike the other approaches the          analytical approach cannot be constrained from reaching          nonphysical negative values for the absorption rate          fig           Comprehensive quantitative evaluations of different          deconvolution approaches have been described previously                The evaluation in this paper is not          comprehensive using a single typical human bolus          response function and just two different input functions          one and two component that are representative of human          intestinal absorption rates For this reason the above          conclusions about the relative merits of the different          methods are quite limited A major advantage of having          the four methods and the PBPK model available in a          single user friendly software package is that it allows          other investigators to carry out similar evaluations          using their particular input and response functions          All of the procedures described in the paper are          implemented in PKQuest freely distributed at          httpwwwpkquestcom This software routine has a          simple user interface and the output is displayed in a          series of graphical plots some of which are illustrated          by the figures in this paper                    