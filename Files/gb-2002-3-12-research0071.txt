                    Background        Methods for analysis of cDNA microarray data include        those that cluster hierarchically   by principles of        selforganization   or by kmeans   These methods        yield enormous amounts of information about similarities of        cell state and coordination of gene regulation and are        useful for grouping genes or transcriptional profiles by        similarity They have the limitation that although        experimental replication enhances the significance of        groupings observed the groupings do not inherently        quantify signal and noise A foldvalue cutoff originally        was used for this purpose   and held double duty as a        signifier of true signal and a boundary beyond which        observed foldmeasures were considered to be reflective of        actual foldchange Other approaches use likelihoodbased        methods    to obtain Pvalues for gene expression        differences in replicated comparisons These methods make        the assumptions and have the power of modelbased        statistics but as yet are not formulated to handle more        than two genotypes environments or developmental states        within a single cohesive framework        One method for analyzing experiments that involve        numerous treatments is the use of analysis of variance on        microarray data Methods have been developed that can yield        a profusion of information about the sources of        experimental variation    or at a biological level        about the proportion of variation in expression profile        attributable to biological factors such as sex or genotype          These methods can estimate the magnitude of effects        as well as significance but also impose considerable        constraints on experimental design   and they are not        robust to missing or excluded data        Volcano plots   have highlighted well the important        distinction between biological and statistical        significance There are effects that may be biologically        important that may not be statistically significant and        vice versa Because many microarray experiments can have a        complex and unbalanced design owing to the technical        failure of certain hybridizations and the iterative nature        of the work itself we have developed an approach for        assessing statistical significance that could potentially        use all the available observations in any transitively        connected design Our goal is to identify effects of        biologically significant magnitude to statistically        significant precision        To that end we introduce a Bayesian analysis of gene        expression level BAGEL model for statistical inference of        gene expression and demonstrate its utility by reexamining        cDNA microarray data on the response of yeast to ethanol        shock   on transcriptional regulation by         SNF and         SWI   and on zinc regulation                             Results and discussion                  Ethanol shock          Alexandre           et al    examined the effect          of  minutes of ethanol shock on a culture of yeast          exposed during logphase growth by comparing the global          gene expression of the ethanolexposed cells to the          global gene expression of cells in the midlog phase of          growth Figure a If we arbitrarily assign the node          with the lower estimated expression to a level of unity          and assume an equal error variance in both treatment and          control there are only two parameters to estimate the          mean expression level of the higherexpressed node and          their common error variance  Figure ashows contour          plots of the likelihood functions see Materials and          methods for genes for three yeast transcriptional          regulators            MSN            HSF and           GCR  that could potentially be          responsible for observed downstream changes discussed          later in this text These three genes demonstrate typical          twodimensional likelihood surfaces in which the most          likely expression levels are equivalent different and          very different respectively Msnp is a zincfinger          transcriptional activator for many genes regulated by          Snfp When           MSN has a null allele          stressresponse genes including           HSP            HSP            HSP            HSP and           HSP are upregulated   Hsfp          is a heatshock transcription factor that binds to the          heatshock DNA element at both normal and raised          temperatures Abundant transcripts from           MSN and           HSF could have a role in the          upregulation of heat shock genes after ethanol shock see          below Abundant transcripts of           MSN and           GCR could have a role in the          concomitant upregulation of the trehalose pathway see          below          The observed           MSN ratios in two replicate          microarrays were inconsistent  and fold This in          fact gives very weak support to the hypothesis that the          nodes are expressed at nearly the same level This is in          part because conditional on higher error variances          larger differences in expression become increasingly          likely This effect is seen more dramatically in the          contour plot for           HSF  for which the highly          dispersed somewhat inconsistent ratios of fold          fold and fold were observed Consistent data even          when relatively dispersed ratios fold fold and          fold as for           GCR  shows this effect but with a          greater slope in the likelihood surface Although Figure          adepicts twodimensional surfaces from an ordinary          treatmentreference experimental design with a common          variance term it shows typical simple topologies of the          likelihood surface Increasing the amount of data in          larger datasets accelerates reliable convergence upon the          stationary distribution of the Markov chain which is          required for inference of the posterior distributions of          the parameters of interest Furthermore in larger          datasets these posterior unconditional distributions of          the parameters are unimodal By inference the          multidimensional likelihood surfaces are expected to be          fairly simple          These likelihood plots clearly convey the most          probable expression levels To determine statistical          significance we examine the posterior distributions of          the parameters as determined by Markov chain Monte Carlo          simulation In fact the credible intervals for the          expression level for all three of these genes overlap          Figure b There is not enough information in the          replicated comparisons of each genes ratio of expression          to constrain the variance parameter to a small enough          value so that expression levels could be inferred to lie          within a small range          In contrast to the lack of statistical significance of          the expression differences observed in these three          upstream transcription factors many of the downstream          conclusions of the original study are not only consistent          with BAGEL estimates but are statistically significant          by the conservative genebygene criterion of          nonoverlapping  credible intervals For instance the          authors concluded that the stressinduced chaperonins          heatshock genes were upregulated by  minutes of          exposure to  vv ethanol   Many of these genes are          clearly significantly abundant in the stressed state          Figure a although there is not enough data to          conclude that all of the set of           HSP family genes is          significantly abundant in the stressed state Figure b          On the basis of the large estimated expression          differences nearly always twofold or greater an effect          on the           HSP family may yet be large and          biologically important          In addition the trehalose pathway whose product aids          the cell in dealing with excess ethanol   is clearly          upregulated Figure  Interestingly the six genes           HXK            PGM  YHLw           TSL            TPS and           ATH  form a completely parallel          pathway from Dglucose to trehalose to Dglucose          Of those genes none is significantly upregulated          Teasing apart the biochemical modes of action of these          isoforms redundant genes will lead to a better          understanding of the modularity of genomes and of the          varied methods of response to environmental challenges of          organisms Alexandre           et al  propose a futile trehalose          cycle after observing high ratios of expression of           NTH in their ethanolshocked          sample   However the wide credible intervals around          the expression levels of the genes for the neutral          trehalase NTH Figure  and the acid trehalase ATH          the observed accumulation of trehalose in fermentations            and the potential for compartmentalization            indicate that more data are needed before one can infer          the extent of such a cycle          In addition to the results previously noted it is          interesting to observe significant abundant expression of          numerous open reading frames ORFs containing          transposableelement sequence under ethanol shock Figure           Although robust inferences are compromised by the          high sequence homology of these ORFs the fact that six          were significantly abundant and none was meagerly          expressed suggests an interesting biological phenomenon          One possible effector is the transcriptional regulator          Gcrp whose BAGEL estimate in ethanol shock is fivefold          greater than in normal log growth and whose credible          intervals in the two conditions barely overlap Figure           Gcrp elevates transcription of transposable elements          Ty and Ty   as well as of           GLK of the trehalose pathway            and Figure           There are many reasons why data points in microarray          experiments are wisely excluded from analysis Whole          sectors occasionally fail due to premature drying during          hybridization spots are occasionally malformed and          experimental signal is frequently so low compared to          background that a spot is best excluded from the data          Only  genes of  in these data passed the spot          backgroundforeground acceptance criteria see Materials          and methods in all three experiments Of these genes           were significantly different by a genebygene criterion          demanding nonoverlapping  confidence intervals A          further  genes had one observation missing their          credible intervals were appropriately wider after BAGEL          analysis of the data and only  were statistically          significant Genes with one acceptable observation were          not analyzed Use of an informative prior distribution on          the variance however would allow such analysis          Table gives an overview of informative pairwise          comparisons from the experiments analyzed here In the          ethanolshock experiments only the  genes listed in          Table are statistically significantly different out of          the onaverage  genes measured as greater than          twofold differentially expressed in these single          microarray experiments BAGEL analysis allows unambiguous          inference as to the expression levels and confidence          intervals of these genes of interest In this dataset          with only three replicates we detect no significant          differences at below a twofold level Datasets with          greater direct replication or with less dispersed          ratios or with transitively informative comparisons see          below and JPT unpublished data promise to do so                          Deletion of SWIand SNF          Sudarsanam           et al  undertook a study to          ascertain which genes were controlled by the SnfpSwip          chromatinremodeling and transcriptionalactivator          complex subunits whether the genes had any distinct          regulatory roles and how their regulatory roles compare          in rich and minimal media   and Figure b In rich          medium the credible intervals among mutant and wildtype          expression levels do not overlap for  genes more than           of the genome Importantly  genes with estimated          ratios greater than twofold have overlapping credible          intervals Figure a lower left and lower right          quadrants Moreover almost one quarter of the           significantly different genes have estimated ratios less          than twofold densely packed between the dashed lines          because the difference between estimates cannot exceed          the distance between credible intervals Figure a In          minimal medium similar results were acquired a greater          number of significant results were obtained due in part          to greater replication Figure b Table  The credible          intervals of mutant and wildtype expression levels do          not overlap for  genes almost  of the genome          Interestingly  genes with estimated ratios greater          than twofold have overlapping credible intervals and           more than  of the  significantly differentially          expressed genes are differentially expressed below the          twofold level          Whether these genes represent all of the genes          controlled by the SnfSwi complex depends of course on          what level of difference is deemed biologically          significant which in many cases depends upon the gene of          interest For many transcription factors it may be that          small changes in expression level cause very large          changes in biological state     and for many          metabolic genes very large changes in expression may          change pathway throughput very little   Note also          that these criteria do not distinguish between           cis and           trans effects on expression level          Presumably many           trans effects percolate into much          or all of the genome in very small ways some of these          effects may be overwhelmed by systematic error induced by          the technology but most should be detectable with          sufficient replication          Credible intervals determined using BAGEL make it          clear that even           SER  which Sudarsanam           et al  examine as a candidate gene          differentially affected in the           snf  and           swi  strains on the basis of cDNA          microarray and northern data   should not be          inferred to be differentially affected solely on the          basis of their cDNA microarray data Although estimates          of the abundance of           SER transcript differ by more than          twofold the credible intervals for these two mutants          have extensive overlap Figure a Examining the          richmedia cDNA microarray dataset for other candidates          for differential expression we observe that there are           genes in which only one of the two mutants has          nonoverlapping credible intervals with the wild type          More important there are just two genes in this          global dataset for which the credible intervals of          expression levels in           snf and           swi mutants do not overlap This          answers a question posed by Sudarsanam           et al  as to whether the          differences in gene expression between these mutants that          they observed were due to variation in microarray          measurements or to real differences between the mutants            Nearly all differences they observed in the          transcriptional profiles of these two mutants are          potentially due to variation in microarray experiments A          scatterplot of the log            estimates of geneexpression levels          for genes significantly different from wild type in the          two deletion mutants compared to wild type yields a          linear correlation of  Figure b The large number          of genes meagerly expressed compared to wild type in both          deletion mutants is consistent with the roles of Snfp          and Swip as transcriptional activators In addition          globally not a single gene shows a contrasting change in          expression in comparison to wild type This affirms the          conclusion   that the two genes work almost entirely          in concert in the media conditions tested The expression          levels of the two genes detected by BAGEL as having          significantly different expression in the two mutants           ECM and YOLw are shown in          Figure b The small magnitude of the difference observed          in           ECM between the two strains may          indicate that this highly statistically significant          difference is biologically irrelevant but certainly          further investigation of the significantly different          geneexpression levels observed in YOLw is          warranted          Quantitation of short transcript sequence tags by          serial analysis of gene expression SAGE   yields          absolute counts of expressed sequences in the yeast          genome   These quantitations may be used to put          relative expression values obtained from BAGEL on an          absolute scale There are issues with sampling error and          nonuniqueness of sequence tags in SAGE assays   as          well as with the linearity of cDNA microarray ratio          measures   and with differences between the          wildtype strain used in SAGE and in cDNA microarray          experiments These sources of error are many but small          and uncorrelated With these caveats in mind Figure          aassumes that SAGE counts are exact in order to provide          absolute expression levels inferred using BAGEL          normalized so that the wildtype strain on rich medium is          assumed to have the same expression levels as indicated          by SAGE assay   Figure ashows that as observed by          Sudarsanam           et al    the acid phosphatase          genes are meagerly expressed in           snf  and           swi  mutants          Note that although there is esthetic appeal to having          the measurements reported on an absolute basis of          transcripts per cell little additional information is          obtained by this transformation for most experimental          questions as the result is simply a rescaling of the           y axis for each gene Also          whereas the statistical significance of BAGEL results is          robust to considerable deviation from general linearity          of cDNA microarray results the quantitative result using          SAGE counts as a basis depends critically upon the          linearity of cDNA microarray measurements Lastly it is          unclear how to scale meagerly expressed genes that had a          count of zero in a SAGE analysis           PHO is such a gene in Figure b          we have arbitrarily charted a frequency that would be          appropriate if it were present at approximately one order          of magnitude below the SAGE experiments detection          threshold of  molecules per cell Neither           PHO nor           PHO shows significant evidence of          differential expression in           snf            swi  mutants Consideration of          the raw ratio data led Sudarsanam           et al    to thus conclude that                    PHO gene expression is directly          controlled by SnfpSwip           PHO  a constitutive acid          phosphatase shows the same relative abundance across           snf            swi  mutants as does           PHO data not shown The           identity of the nucleotide sequence of these genes means          that crosshybridization may confound inference about          their regulation However unlike           PHO  there is currently no          evidence that           PHO is regulated by           PHO or           PHO            PHO may share a direct SnfpSwip          regulatory mechanism with           PHO           Analysis presented here supports the result that           SWI and           SNF work almost entirely in          concert within the cell in rich medium   As          Sudarsanam           et al  noted however the          proteins may not always be produced together in all          conditions Moreover it should be noted that their          experimental design has the least power to detect these          specific differences This is because all comparisons of          expression level between the mutant strains are          transitive comparisons which inherit the variance          associated with the intermediary wildtype expression          level as well as the variance associated with the          expression levels of the two mutant strains The result          is that on a log scale the credible intervals of          geneexpression level are broader for the two mutants          than for the wild type This outcome is a recurrent          problem with a repeated referencesample experimental          design one learns the most information about the          reference sample which is frequently arbitrary and not          necessarily of interest An ideal addition to the          experimental design in Figure bwould be several direct          comparisons of the mutant strains Then both transitive          and direct information would contribute to the          statistical power of a BAGEL analysis for any comparison          It is also clear that an increase in number of          comparisons would yield more power to detect          differentially expressed genes and would indeed find          more of them Every single gene that was detected as          significantly differentially expressed in only one of the          two mutants compared to wild type in the rich medium was          significantly different in expression level only in the           swi  mutant The           swi  mutant comparison to wild          type had one more replicate than did the comparison of          the           snf  mutant Figure b                          Zinc regulation          Lyons           et al  examined wildtype and           zap mutant strains of yeast          growing in cultures containing three different          concentrations of zinc   and Figure c Zapp is a          transcriptional activator that appears to regulate          transcription of the zincuptake system genes in response          to zinc   Using the nonoverlapping  credible          interval criterion a BAGEL analysis on this data reveals           genes significantly more abundantly expressed in          cells grown in zincdeficient medium compared to cells          grown in zincsupplemented medium and reveals  genes          significantly less abundant in the same comparison This          is a total of about  of the genome and is two thirds          of the number found by use of an averaged twofold          criterion A considerable number of the genes viewed as          abundant by a twofold criterion then are not          significantly different by the credible interval          criterion Table  Figure c lower left and lower right          quadrants Moreover  of the genes significantly          different by the credibleinterval criterion are          significantly different at a ratio of below twofold          Figure c densely packed between the dashed lines          delimiting a twofold change As one might generally          expect making           ZAP nonfunctional in a          zincdeficient environment creates a similar relative          effect on most significantly differentially expressed          genes to that created by providing zinc to a          zincdeficient wildtype strain Figure d          A common technique to discover candidate genes of          interest in microarray studies is to pick out overlapping          sets of genes expressed at a ratio greater than some          cutoff from replicate andor different microarray          experiments for example Figure of   Figure of            BAGEL supplants any need to examine overlapping          gene sets in replicate experiments Moreover it provides          a statistically rigorous method for comparison of          multiple different experiments The equivalent of an          overlap in two lists of highly expressed genes is that          neither of the credible intervals for geneexpression          level in a given gene in two experimental conditions          overlaps the reference condition          For instance BAGEL analysis of the zincregulation          data revealed  genes whose levels of gene expression in          a wildtype genotype and zincdeficient medium were          significantly greater than both zincsupplemented          wildtype and           zap in zincdeficient medium This          is  more genes than were detected using the twofold          criterion Figure shows BAGEL results for two genes           PHM and YGLc discussed by            as well as results on four other genes A          zincresponsive element ZRE consensus DNA sequence          ACCYTNARGGT in the singleletter aminoacid code where          N is any nucleotide Y is C or T and R is A or G          compare Figure of   is located in close proximity          to           CTT chromosome VII location                     MNT VII  and           YOLw XI  and YNLw XIV  BAGEL          results shown in Figure convey not just the significance          but also the extent of differential regulation           CTT and YOLw are like the two          genes           PHM and YGLc discussed by            in that having the           zap            TRP genotype does not entirely          eliminate transcriptional response to zinc deficiency          These intermediate levels of expression indicate the          action of auxiliary zincregulatory mechanisms          Figure charts several transcription factors that are          significantly differentially expressed below the twofold          level For every gene shown the credible intervals          between wild type in  mM zinc and wild type in            nM zinc do not overlap For           VPS  in contrast to the other          four genes expression is greater when in zincdeficient          medium Expression levels in Figure are graphed          cosequentially with the experimental design structure          Figure c As a result the increasing size of credible          intervals as one scans from the middle expression nodes          to the expression nodes at the ends of the chain of          experiments is clear The largest credible interval is          for the           zap strain grown in  M zinc on          the far right of each cluster of columns This is as          expected given that it is at the end of the line of          comparisons and is informed by only one cDNA microarray          comparison In a balanced linear set of comparisons such          as this it turns out that for any gene on a log scale          the credible intervals around the geneexpression values          of the ends are greater than the credible intervals          around those in the middle of the chain data not          shown          For an analysis such as this one the statistical          power could be improved if expression nodes were compared          to more than two neighbors Specifically direct          comparisons between wild type in  mM Zn and           zap in  mM Zn would complete a          circle of comparisons increasing transitive information          on all expression nodes Crosscircle comparisons would          also contribute considerable power Generally          eliminating ends of chains of comparisons should be a          goal of any cDNA microarray experimental design                            Conclusions        Small datasets such as the ethanol dataset are very good        candidates for use of a more informative prior distribution        to keep variances within a reasonable range and yield        better results Analysis of larger datasets indicates that        true variances for microarray data within this model are        not larger than one The impact of using lessvague priors        especially for the variance when there are few        comparisons is under investigation by a number of        researchers A hierarchical Bayesian model   has been        used to analyze ratio data and provide  confidence        intervals for the log ratio of gene expression from        reference to control This method assumes normal        distributions of the log ratios rather than ratios of        normal distributions It has a hierarchical structure that        allocates error variance among microarrays and experiments        The authors suggest use of calibration data or        alternatively empirical evaluation of the distribution of        variances across all other genes in order to construct a        prior A subset of genes of nearly equal intensity can be        used to form a prior for variances   This prior was        used by the authors to input reliable variances in         t tests of significance Promising        advances have been made on Bayesian methods for correcting        misleading foldchange measurements made from lowintensity        spots   using a gamma rather than normal model of        ratio results        All these methods have considerable potential to be        incorporated as priors into a framework such as that        presented here so that the prior may be applied to        multiple samples from different genotypes environments or        developmental states Priors such as those above should        result in smaller credible intervals and detection of        increasingly significant differences because they curtail        the exploration of unrealistically high variances that        small datasets have too few observations to rule out on        their own Continued work in this area using an increased        amount of nonratio data provided from scanned microarrays        should be very fruitful   Furthermore posterior        distributions from such analyses of geneexpression level        have subsequent use in Bayesian methodologies for        clustering   and tumor identification          In summary the modelbased approach we have implemented        can accommodate complex and unbalanced experimental        designs Some research will continue to be carried out        comparing just two samples multiple times However complex        designs will increase in popularity as investigators        explore multiple genotypes environments and developmental        states within a single research project   The utility        of this approach in determining levels of gene expression        may be maximized if these designs incorporate certain        features        First compare samples of direct interest directly When        interested in the differences between two samples compare        them to each other rather than to an arbitrary reference        sample    Whenever possible study a few expression        nodes thoroughly rather than many superficially        Second replicate each comparison at least once          Whether this is done directly by incorporation of dye        during reverse transcription or preferably by labeling        incorporated aminoallyldUTP reverse the dye labeling to        ameliorate any dye effect thereof            Third eliminate ends of comparison chains by carrying        out hybridizations comparing one end to another This        allows reconciliation of transitive data around a circle of        comparisons The more circles created the more        reconciliation occurs The smaller the circumference of the        circle created the stronger the transitive power        Fourth connect nodes otherwise distantly located on a        chain of comparisons with extra crosscomparisons The        number of extra comparisons to make depends on what size        of effect is of interest The observation of a small but        significant effect on key regulatory genes may be of        greater biological interest than the same observation on a        metabolic enzyme The appropriate weighing of the cost of        additional comparisons against the greater precision of        measurement depends critically upon the question being        asked        For timecourse experiments or any other experiment with        an explicit ordered         x axis these guidelines may still be        followed as long as replicate comparisons are made among        nodes Inferred estimates at each node are assessed        independently of location along the         x axis so that regressions across        them are valid Ultimately experimental design may be        subject to limitation owing to lack of resources or        experimental failure Fortunately within a framework such        as that developed here missing spots or missing        comparisons do not require any special consideration or any        change in methodology Credible intervals acquired for less        well determined genes or less well determined expression        nodes are correspondingly larger This quantitative        information on geneexpression levels tendered by a        thorough analysis of microarray results should be carefully        considered in assessments of the biological effects of        genetic or environmental differences upon cellular        state                    Materials and methods                  Normalization          For the ethanolshock dataset   raw data from          GenePix files was processed as follows Any spot was          excluded from analysis if both the Cy and Cy          fluorescence signals were within two standard deviations          of the distribution of intensities of the background          pixels for that spot These lowintensity spots are those          most aberrant in foldchange and are those for which the          magnitude is adjusted most by the model of Newton           et al    Expression values          were normalized by linear scaling of the Cy values so          that the mean Cy and Cy values of nonexcluded spots          were equal Two of three experiments thereby achieved a          linear loglog intensity plot for included spots with          slope approximately  The third was linearized by          exponentiation of the Cy channel to  before          normalization of the means          For other experiments ratio and spot pass criteria          were used as reported in the papers In the dataset          released by Sudarsanam           et al    one of the three          reported microarray hybridizations between wildtype and           snf nodes was excluded from          analysis because it had an anomalous global mean log          ratio of  whereas for all others that value was          very nearly zero For the zincregulation dataset            no pass criterion had been used to ensure each spot on          each microarray carried considerably more signal than          noise The data appeared to be of high quality However          in a few cases one or two misleading data points from          lowintensity spots may have led to especially high          genebygene error variance estimates and thus concealed          otherwise significant differences          The best normalization method and spot pass criteria          are highly dependent on cDNA microarray protocol          methodology experimental experience and analytical          resources As long as normalization method and spot pass          criteria are applied uniformly within a dataset the          resulting ratios should be appropriate for analysis by          the model described here                          Model          In microarray experiments the original idea was that          with current technology spots on a cDNA microarray had a          number of confounding pseudolinear terms  whose          variation from experiment to experiment could be          minimized but not eliminated  which contributed to the          intensity measurements observed when a hybridization was          scanned Model parameters under this scheme differ from          those used for highdensity oligonucleotide microarrays            These terms included the density and size of the          cDNA deposition the correspondingly larger or smaller          amount of labeled mRNA hybridized to the microarray the          hybridization conditions and the sequence of the gene            With these assumptions the postnormalization          intensity in one fluorescence channel at a reporter spot          may be modeled linearly as                    where is the absolute quantity of mRNA per cell the           c                       m            are terms for any           q multiplicatively confounding          factors the           c                       l            are terms for any           q  t linearly confounding factors          and is an error term accounting for mild pseudorandom          departures from linearity and unavoidable small          variations in cellgrowth conditions Note that          multiplicative error associated with the sample must have          been compensated for by an appropriate normalization            reviewed by   if on the other hand there are          considerable multiplicative factors that are common to a          spot they are accommodated by the           c                       m            above This model cannot be directly implemented          because experimental replication to estimate each          confounding term is technically difficult These          difficulties led to a rapid conclusion that the          information that can be best obtained from a cDNA          microarray experiment is ratio information rather than          absolute quantification This is because the confounding          spot terms above will apply equally to two samples          competitively hybridized against a single spot on a          single microarray yielding a ratio that correctly          represents the ratio of expression levels in the          comparison of interest          When comparing just two samples ratio measurements          are nearly as good as absolute data However when more          than one genotype or environmental condition or cell          developmental stage is examined ratio measurements          rapidly become cumbersome because comparing across          numerous states requires a common unit of measurement          Therefore it is of interest to use these ratio          measurements within a statistical model to estimate          geneexpression levels in a common if arbitrary unit          and also to assess the significance of such a          difference          Consistent with the original interpretation of cDNA          microarray data that privileged ratio over absolute          quantification   the observed ratios of intensities                    y                       ij             maybe modeled as                    where                       i             and                       j            are the scaled quantities of mRNA in samples           i versus           j  This expression is true for any          terms that are consistent for both mRNA preparations          regardless of linearity which is fortunate as there are          known nonlinearities in microarray data acquisition            This yields                    Assuming that error terms are composed of many small          unbiased effects and scaling the error terms                       i            and                       j            by                    a constant for every microarray spot so that they are          distributed with variances specific to each sample                       i            and                       j             it follows directly that the observed ratio data                    z                       ij             are drawn from                    This can be true even if the distribution of          intensities across spots and arrays is decidedly not          Gaussian because confounding factors which vary linearly          or multiplicatively or even interactively across spots or          arrays are commonly presumed not to be different between          two labeled samples hybridized to a single spot            Note that samples may under this formulation have          different variances as well as different means          The ratio of standard normal distributions is a Cauchy          distribution which has the unpleasant property that it          has no moments The ratio of nonstandard normal          distributions is not much better Fortunately the          infinite tails of the normal distributions that result in          this property are not generally observed in real data in          fact a model that allows negative gene expression levels          is not valid The joint normal distribution may be          truncated at a considerable distance from its peak along          an elliptical probability contour within the positive          quadrant   yielding a ratio           z                       ij            distributed approximately as                    This approximation of the density of the ratio of two          nonstandard normal distributions is extremely good as          long as                       i                                   i             and                       j                                   j             which is certainly true for informative cDNA          microarray experiments It is not symmetrical like a          normal distribution but skewed with a long righthand          tail like gene expression data Moreover as implied          above if microarray data contain no negative expression          levels a natural proposition it is likely that the          distribution of           z above is closer to the true          distribution of microarray data than is the distribution          of the ratio of true normal distributions          Let us consider how this result may be used An ideal          statistical framework for the analysis of microarray          ratio data could be used to analyze microarray data of          any experimental design including any number of          treatments genotypes or developmental states would be          highly robust to missing data and would yield estimates          of the magnitude of expression differences and measures          of statistical significance across all treatments          genotypes and developmental states          The number of expression nodes           n  is equal to the number of          permutations of strain treatment and developmental          state that are examined Unless informative prior          information about expression levels or error variance is          used the following minimal requirements must be met          First every node of interest must be present in at least          one comparison Second every node of interest must be          connected to every other node of interest by an unbroken          chain of comparisons And third there must be as many          comparisons as there are mean and variance parameters to          be estimated          If separate error variances for each sample are to be          estimated as well as means the last requirement          indicates that there must be at least            n   measurements when each          expression node is assumed to have an independent          variance and there must be at least           n measurements when each expression          node is assumed to have the same error variance A few          measurements beyond the minimum contribute greatly to the          power to detect differences in gene expression and to the          ease with which significance of results is ascertained          within the Bayesian framework Figure shows the          comparison structure of experiments examined in this          paper The threedimensional matrix of ratio results from          these comparisons                       Z             may be constructed with dimensions           i denoting the sample labeled with          one fluorophore           j denoting the sample labeled with          another and           k denoting the replicate ordinate          of that particular comparison Then for any continuous          structure of comparisons among the nodes of interest the          likelihood density for the parameters                        l            and                        l                         l            n  is by Bayes rule                    where           g                        i                                   i                                   j                                   j             is the prior distribution of the parameters and          where the probability           f            z                       ijk             of empty elements in the data matrix                       Z            is evaluated as           Any genes for which  where           I is an indicator variable and           v            n when variances are common among          all samples within a gene and           v            n   when variances are not          yield improper posteriors unless an informative prior is          used These few genes are not analyzed here nor are          genes whose matrix                       Z            is reducible Note that diagonal entries in                       Z            are control selfself hybridizations in which the          same expression node has been labeled with two different          dyes In this framework these controls can and should be          included in the dataset if performed with all sources of          experimental error included in their preparation They          contribute to estimation of the error variance of          genes          Appropriate informative priors for the variance of          microarray data are currently under investigation by a          number of groups     An informative prior must          be clearly justified in order to prevent inappropriate          conclusions of statistical significance In this paper a          noninformative prior distribution uniform across          positive real numbers has been used for both the          expression levels and for their variance In theory we          use a uniform prior for the variance bounded from  to           In practice the upper limit beyond  or so makes          no difference as such high values are very improbable          and are never sampled by the chain in the datasets          analyzed here This uniform prior gives the microarray          data itself the greatest impact on the inferred means and          variances and implies that credible intervals          constructed are close to those that would be found by          maximum likelihood if analytical integration of the full          multidimensional parameter surface were feasible A          frequently used noninformative prior such as   is          in this case not desirable because in practice the          most likely variances observed are so small that this          prior has a considerable impact on the posterior          distribution          Fortunately we may use the constant denominator of          the Bayes rule formulation Equation  to assert          that                    This may be used to construct a Markov chain whose          stationary distribution is the posterior distribution of          the parameters given the data A vector and a vector of          initial expression levels                                    n             is chosen such that at step           t   and subsequent values in the          chain are determined iteratively by choosing successive          proposed values according to an acceptance rule          Our proposed values are constructed in two separate          steps First two of the           n geneexpression level parameters          from are chosen at random A step size is drawn at random          from a triangular distribution centered at zero with          range                          The first of the two chosen          parameters is incremented by the chosen step size and          the second is decremented by the same quantity so that          is maintained where the apostrophe indicates a proposed          parameter value In the next iteration the variance          parameters                       l            are incremented by an amount drawn at random from a          triangular distribution with range to form  Because          these operations have probabilities of transitions from          the current state to the proposed state equal to the          probabilities that the converse transitions would have          this proposal scheme satisfies Hastings   and can be          implemented in the Metropolis   algorithm Thus the          conjecture is accepted for the next state of the Markov          chain if                    Otherwise the original state is retained for the next          iteration of the Markov chain          These steps are repeated over many generations in          order to burn in the chain so that it converges from          the initial parameter settings to a stationary          distribution Subsequently states are sampled from the          chain at regular intervals to build a posterior          distribution for each parameter integrated across the          probable states of all other parameters An easytouse          standalone software program entitled BAGEL which          implements this Bayesian analysis of gene expression          levels on MacOS or Windows platforms is available on the          web with an online manual   It accepts tabdelimited          text files of ratio data as input          To decrease the number of parameters that must be          estimated we estimate a single variance parameter for          each gene across all expression nodes which is          equivalent to the assumption that                       i            and                       j             from the same distribution for every sample On          larger more highly replicated datasets where all          parameters could be estimated constraining the variance          has not led to substantially different results JPT          unpublished data and JM Ranz personal communication          All analyses in this paper were performed with           generations of burnin followed by  generations          during which the chain was sampled every  generations          to construct the posterior distribution Runs using          multiple starting vectors and were performed and always          converged to the same unimodal posteriors indicating          that this is a wellbehaved multidimensional likelihood          surface see Figure a Results reported here were the          outcomes of Markov chains started with the elements of          all equal to one and started with the elements of all          equal to  Step sizes            and were tuned for each gene so that          acceptance ratios for each parameter update were in the          efficient and wellmixed range     If          acceptance ratios for either parameter jump were less          than  or greater than  the chain was run again          with a bettertuned jump size until acceptable ratios          for both parameters were obtained In this way there is          no alteration of the jump size during any run There is          only the evaluation of pilot Markov chains to optimize          jump size          Output from the BAGEL software is in the form of a          tabdelimited text file with one header row Each row          thereafter displays the results for a single gene          including columns with the estimate of expression level          for each sample the median of the posterior          distribution the additions and subtractions to make           upper and lower bounds on that estimate the stationary          acceptance rates for the Monte Carlo steps for that gene          and a column that reads TRUE when those rates are          acceptable Further columns contain the posterior          probabilities for whether that genes expression level in          each expression node is greater or lesser than that          genes expression level in each other expression          node                            Additional data files        Estimates and credible intervals for expression levels        of all genes assayed in these experiments in all conditions        are available with the online version of this manuscript as        tabdelimited text output files with columns of data as        described in the methods section The files are entitled        EtOHtxt SwiSnfMintxtand SwiSnfRichtxt and        Zinctxt        Additional data file         Tabdelimited text output files for EtOH        Tabdelimited text output files for EtOH        Click here for additional data file        Additional data file         Tabdelimited text output files for SwiSnfMin        Tabdelimited text output files for SwiSnfMin        Click here for additional data file        Additional data file         Tabdelimited text output files for SwiSnfRich        Tabdelimited text output files for SwiSnfRich        Click here for additional data file        Additional data file         Tabdelimited text output files for Zinc        Tabdelimited text output files for Zinc        Click here for additional data file            