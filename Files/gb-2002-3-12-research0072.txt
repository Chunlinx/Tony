                    Background                  Modeling variable DNA sequence sites          The set of binding sites for a single DNAbinding          protein can be highly variable    and the degree of          nucleotide variation tolerated generally differs from          position to position within a site     This          sequence diversity can have important functional          consequences as the affinity between regulatory proteins          and their binding sites is modulated by changes in          bindingsite sequence   Large datasets of related DNA          sites are now available      Currently more          than  prokaryotic and eukaryotic genomes have been          completely sequenced permitting crossspecies          comparisons of even larger sequence assemblies than          collected here see for example    Computational          approaches can therefore be used to detect and model the          sequence patterns present within the bindingsite          variability The most useful models of variable DNA sites          provide classification algorithms for identifying          functional sites as well as insights that can help          elucidate the relationship between the structure and          function of these sites          Variable DNA sequence sites are frequently described          by a consensus sequence   or a weight matrix              Consensus sequences have limited utility for          even moderately variable sites because they preserve          little or no information about the variability within the          sequences they characterize Differences from consensus          are quantified by counting the number of mismatched          positions making no distinction between mismatches that          abolish function of the site and those that modulate          function          Weight matrices were introduced to characterize          transcription and translation initiation sites in           Escherichia coli   and have          become standard for characterizing binding sites for          transcription factors A weight matrix is a          twodimensional matrix in which each row corresponds to          one of the four nucleotides and each column corresponds          to one position in the site being described   The          elements of the matrix are the observed counts for each          nucleotide at each position in an alignment of the DNA          sites   or some function of these counts reviewed          in    Any sequence can be scored by summing the          matrix elements corresponding to the sequence            thereby quantitatively rating the sequences functional          potential          Weight matrices can be used to scan genomic DNA and          determine statistically significant matches to the          sequence pattern described by the matrix   Putative          sites are scored by the weight matrix so the number of          false positives and false negatives can be balanced by          choosing an appropriate threshold score defining          functional sites The scores of functional sites are          sometimes correlated with their level of function                               Weight matrices are typically based on order zero          Markov chains meaning they assume that individual base          pairs in the binding site affect binding affinity          independently Weightmatrix models based on order one          Markov chains assume that adjacent positions are          correlated       Ponomarenko           et al    constructed weight          matrices for many different transcription factor binding          sites using mono di and trinucleotide motifs allowing          correlation between nonadjacent positions by specifying          X            NX            and X            NX            NX            motifs where X           i is the nucleotide at position i of          the motif and N is any nucleotide While this approach          allows for correlation between more than two nonadjacent          positions the motifs may still be unnecessarily          restrictive The apposition of distant bindingsite          positions can be important to recruitment of the binding          protein for example through formation of DNA secondary          structure      or to the interaction of the          binding site with its binding protein   Therefore          correlation between distant positions is expected          Burge and Karlin   used hypothesis testing via           tests to detect significant correlations between any two          positions and introduced a modelbuilding procedure          maximal dependence decomposition to account for the          dependencies For each significant correlation this          method partitions the dataset into subsets of sequences          exhibiting no correlation the final model is a composite          of weight matrices order zero one for each subset Our          modelbuilding technique is based on crossvalidation          criteria rather than on hypothesis testing           per se  and we use a more general          model class for DNA sequences          Models that allow for pairwise correlations between          positions were developed in the context of Bayes networks          by Cai           et al    Bayes networks          represent a large class of models and in fact our model          can be recast as a Bayes network although it is not now          formulated in those terms          We have developed an approach to determine the          correlation structure present in a set of variable          sequence sites For each position in the site we          identify all other correlated positions placing no          restrictions on the number or spatial relationship of          correlated positions in the site Our approach          determines from all possible combinations of disjoint          probability distributions the set of distributions that          most effectively distinguishes functional sites from          nonfunctional sequences Although the family of models          we consider is very large we proceed by model selection          rather than hypothesis testing The selected probability          function is the product of these disjoint probability          distributions The natural logarithm of this probability          function can be used as a score for any sequence thereby          recognizing the presence of evolutionarily conserved          nucleotide associations We have applied this approach to          recombination signal sequences RSS a set of DNA          binding sites necessary for specific immunity                          Recombination signal sequences          Specific immunity depends on the ability of B and T          lymphocytes to recognize antigens molecular identifiers          of pathogens   The immune system does not anticipate          which antigen will be encountered but remarkable genetic          mechanisms have evolved that generate diverse          antigenreceptor repertoires The primary generative          mechanism is VDJ recombination the rearrangement of          Bcell receptor BCR or Tcell receptor TCR V D and          J gene segments to form functional genes the resulting          combinatorial and junctional diversity can produce around           BCR specificities and around  TCR specificities          in one animal   This extraordinary plasticity has a          price VDJ recombination can produce selfreactive          receptors leading to autoimmune disease    and may          err to create oncogenic chromosomal translocations                     VDJ recombination proceeds by the introduction of          doublestrand DNA breaks reviewed in   To prevent          DNA breaks that would cause cellular damage the VDJ          recombinase must be specifically targeted to the           Bcr and           Tcr loci This targeting is          regulated primarily by binding of RAG   an enzyme          in the recombinase complex to the RSS adjacent to each          V D and J gene segment   RSS were initially          identified as a conserved heptamer consensus CACAGTG          and a conserved nonamer consensus ACAAAAACC separated          by a less conserved spacer of either    or             basepairs bp   The initial CAC of the heptamer is          highly conserved but all remaining positions show          moderate to very low levels of conservation reviewed in                     RSS variability has important functional consequences          the efficiency with which each RSS mediates recombination          depends on its sequence   There is strong evidence          that differing recombination efficiencies of RSS result          in the biased utilization of their associated gene          segments reviewed in    In addition the biases          in gene segment use observed in the postselection TCR          repertoire are consistent with the biases observed before          selection suggesting that the primary immune repertoire          may be genetically patterned            The high level of diversity among RSS makes it very          difficult to evaluate their recombinogenic potential RSS          not associated with a V D or J gene segment but          participating in aberrant illegitimate VDJ          recombination are particularly difficult to recognize          These nonphysiologic RSS are important because of their          potential involvement in oncogenic chromosomal          translocation and receptor editing a process that alters          the specificity of autoreactive receptors          Nonphysiologic RSS that have simply arisen by chance can          be referred to as fortuitous RSS whereas those thought to          have descended from the same ancient transposon as          physiologic RSS can be referred to as cryptic cRSS             Generally the origin of a nonphysiologic RSS          is not known for simplicity we will refer to both types          as cryptic          To understand the role of RSS variability in the          formation of the primary immune repertoire and of cRSS in          illegitimate VDJ recombination it is necessary to          quantify the genetic variability among physiologic RSS          and the relationship between this variability and the          regulation of recombination Allowing for each of the           nucleotides at just  of the  or  RSS positions          results in over  different signals  it is not          feasible to measure the efficiency of all potential RSS          experimentally Statistical models of RSS variability          that allow prediction of recombination efficiency are          essential to furthering our understanding of the          biological function of RSS variability          One estimate of cRSS frequency in mammalian genomes is          one in every  bp   Promiscuous recombination at          this frequency however would result in significant          damage to the cell This suggests that complex patterns          underlie the high level of nucleotide diversity observed          at individual positions thereby increasing the          specificity of the signal governing recruitment of the          VDJ recombinase          We find significant correlations between nucleotide          positions in RSS suggesting they act cooperatively and          that nucleotide associations are conserved We used our          model selection procedure to determine the best models of          RSS correlation structure one model for bp spacer RSS          RSS and one for RSS We also modeled both types          of RSS with order zero and order one Markov chains The          scores from all six models are highly correlated with          measured recombination efficiencies but the models          arising from our technique are much better than the          Markov models at identifying physiologic and cryptic RSS          in genomic DNA                            Results                  Mouse RSS show limited sequence conservation          We analyzed  physiologic mouse RSS see Methods          While   of these RSS contain a consensus          heptamer just   contain a consensus nonamer          and only   contain both a consensus heptamer          and a consensus nonamer To measure the level of          nucleotide diversity at individual RSS positions we          computed the entropy            H                       i               for each position           i in an alignment of the  RSS          and an alignment of the  RSS Figure a A          strictly conserved position in which no variation is          tolerated has           H                       i              while a position in which the four nucleotides          are observed at nearly uniform frequencies has           H                       i                       The signal specified by the individual RSS positions          is very low especially in RSS Figure a The          average entropy is              for RSS and              for RSS for a randomly          generate string of A G C and T characters the          expected value for is one The patterns of nucleotide          diversity at individual positions are similar for both           and RSS the initial CAC of the heptamer is          invariant the remaining four positions of the heptamer          are moderately diverse the spacer is highly diverse and          the A tract of the nonamer positions  through  is          better conserved than the other nonamer positions Figure          a The average entropy for RSS is higher than for          RSS primarily because the RSS nonamers are much          more diverse than RSS nonamers                      N                        N    Figure a          It is known from experimental studies that nucleotide          substitutions at highly diverse positions influence          recombination efficiency    That a given RSS          position can be both highly variable and exhibit strong          effects on signal efficiency appears contradictory The          contradiction can be reconciled however by          hypothesizing correlations between nucleotides in RSS a          nucleotide substitution at one position may be          compensated for by a change at another position in the          RSS                          Significant pairwise correlations exist between          positions in the RSS          To test for correlation between pairs of positions in          the RSS we computed the mutual information           MI                     i            i     between all pairs of          positions           i and           i  in an alignment of the           physiologic mouse RSS and in an alignment of the           physiologic mouse RSS see Methods Figure b          Statistically significant           MI                     i            i  values result when there is          a correlation between nucleotide frequencies at the two          positions indicating selection pressure to maintain or          avoid a particular dinucleotide          In  and RSS we detect statistically significant          correlations between positions in those regions of the          RSS exhibiting high levels of positionwise entropy          These are the spacer especially the nonamerproximal          half and the positions of the heptamer and nonamer that          are adjacent to the spacer Figure b In general          correlation between two positions decreases as a function          of distance but there are examples of strong correlation          between widely separated positions Figure b For          example we observe RSS with A at positions  and           at a much higher frequency  than expected           from the independent frequencies of A at each position          In addition we find that the levels of correlation are          higher in RSS than in RSS Figure b this is an          especially interesting observation given that RSS are          much more variable than RSS Figure a                          Statistical models of  and RSS determine the          relevant correlation structure          The           MI computations give evidence for          strong pairwise correlations including between distant          positions and correlations may exist between any number          of positions We therefore developed statistical models          one for RSS and one for RSS that can account for          correlations between arbitrary positions without regard          for their distance from each other or the number of          correlated positions The models were developed using a          procedure that selects from all possible combinations of          disjoint probability distributions the set of marginal          for one position and joint for multiple positions          distributions that most distinguishes physiologic RSS          from other nucleotide sequences of the same length For          example positions  and  in RSS are highly          correlated Figure b They could be included in the          model either through the two marginal probability          distributions  the distribution over the four          nucleotides at position  and the distribution over the          four nucleotides at position  or through one joint          probability distribution  the distribution over the           pairs of nucleotides at the pair of positions Each model          computes a score for RSS information content           RIC            for bp sequences and           RIC            for bp sequences the formation          of joint probability functions is determined by          maximizing the mean score for physiologic RSS          The selected RSS model is                    RIC             ln            P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      where           P            is the marginal probability function          for position  and           P            is the joint probability          function for positions  and  The presence of the          joint probability function in the model indicates that          these three positions are mutually correlated The          selected RSS model is                    RIC             ln            P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      Most of the marginal probabilities have been merged to          form joint probability functions but the order in which          the joint functions were formed reflects the relative          strength of the correlations between the corresponding          positions positions with large           MI are grouped early in model          selection data not shown The groups of positions with          the strongest correlations are   and           in RSS Table  and            and  in RSS          Table  For both  and RSS the positions          exhibiting the strongest cooperative influence lie in the          nonamerproximal half of the spacer and in the heptamer          and nonamer positions adjacent to the spacer Figure           Interestingly these positions overlap substantially with          positions exhibiting ethylationmethylation interference          in RSS complexed with RAGRAG Figure and            suggesting that the correlations detected by the models          are relevant to RAGRSS interaction                          The selected models were compared with order zero          and order one Markov models          To determine whether the correlation structure          detected by our model selection procedure improves RSS          recognition and evaluation we constructed weight matrix          models based on order zero or order one Markov chains          Order zero Markov models            WM            for RSS and           WM            for RSS assume that all RSS          positions are independent and are therefore computed from          marginal probability distributions The score for an           N bp sequence is computed as                    where           P                       i            is the probability of observing nucleotide           X at position           i  Order one Markov models            WM            and           WM             assume that adjacent positions          are correlated the identity of the nucleotide at          position           i depends on the nucleotide at          position           i   and are computed from          conditional probability distributions                    where           P            is the marginal probability          distribution for position  and           P            i            i   is the probability of          observing nucleotide           X at position           i given the nucleotide at position           i            For physiologic  and RSS the score distribution          is shifted toward higher scores for models that include          correlation            RIC and           WM  Table  Figure  The          difference is most striking for RSS Table  Figure           The mean scores for the physiologic RSS are                           and              Table  the mean scores          for physiologic RSS are                           and              Table  There is          relatively little change in the value of low scores          across models so as the correlation structure of the          models increases in complexity the increase in high          scores results in an increase in the score range Table          and Figure                           Functional RSS are best discriminated by          RICscores          To test whether functional RSS can be recognized by          the sequence properties captured in the models we          characterized the score distributions for nonRSS DNA          Figure  These background distributions are          characterized by their means and ranges           WM WM and           RIC scores were computed for all           and bp segments in a bp fragment of mouse          chromosome  AC containing no known RSS We also          characterized the background distributions by computing          scores for a pseudorandom string PRS of A T C and G          the same length as sequence AC and having the same          nucleotideusage frequencies          As expected the           WM score distributions for          AC and the PRS are almost identical for both           and bp segments Table  Figure  For the models          that account for correlation however scores from          genomic DNA are higher on average than those computed for          the PRS Table  Figure  This is especially true for          the           WM models indicating that          whereas both the           WM and           RIC models are influenced by          correlations present in physiologic DNA the correlations          detected by the           RIC models are more specific to          RSS Importantly the distributions for           RIC scores are always shifted          toward lower scores than the corresponding           WM and           WM distributions Table  Figure                    We next compared across models the frequency of          signallength segments in AC that score above a          given threshold To determine test thresholds for a given          model we ranked the physiologic RSS by score in          ascending order and took the lowest  of scores under          each model as the test thresholds for that model Table           Figure  For example the lowest           RIC            is  It has rank zero and          zero physiologic RSS have a lower           RIC             Of   bp          segments in AC  have           RIC              Similarly threshold          zero under the           WM            model is  and  of            bp segments in AC have           WM              Under each model the          frequency of physiologic RSS scoring below threshold          estimates the probability of failing to recognize a          functional RSS and is a measure of the models          sensitivity The frequency of nonRSS scoring above          threshold estimates the probability of classifying          nonRSS as functional and is a measure of the models          specificity Both numbers should be small The          highscoring nonRSS segments may support recombination          however and if so would be classified as cRSS Those          not supporting recombination would be counted as false          positives          In general we find that the           WM models predict the highest          number of RSS in AC and the           RIC models predict the fewest          Table  Figure  Of  test thresholds there are          three for which           RIC does not predict the smallest          number of RSS for the RSS models the score for the          ninthlowest ranking physiologic RSS and for the          RSS models the scores for the second and          eighthlowest ranking physiologic RSS Table  Figure                    From Figure  we determine thresholds at which          excluding just one more physiologic RSS results in a          large drop in the models predicted number of cryptic          RSS We select  for           RIC            and  for           RIC            Figure  Only two of the            RSS have           RIC              and just  of               bp segments in sequence AC achieve                    RIC              The frequency of           RIC              from the PRS is              Similarly of the  physiologic          RSS only three  have           RIC              Just  of the               bp segments from sequence          AC and only  of the  segments from the PRS              have           RIC              We therefore set           and  as           RIC            and           RIC            thresholds respectively                          The RICmodels reliably recognize physiologic          RSS          We searched genomic DNA containing physiologic RSS to          determine if           RIC scores can resolve  and          RSS Sequences X  bp and X           encompass the mouse J locus and contain four RSS          three associated with functional J gene segments and one          associated with the pseudogene J   We computed           RIC            scores for  bp segments in          X and X the resulting           RIC            distributions are almost identical          to that for the chromosome  sequence with means well          below threshold Table  The           RIC            for RSS associated with functional          J gene segments lie well outside this distribution          Table  Figure a all three score                 Analogous searches of          mouse D           H AF and DJ AE          regions also demonstrated           RIC            values for physiologic RSS above          threshold Table  Of the  physiologic RSS          included in the search only the RSS associated with the          J pseudogene   scored below threshold Table                    Scans of the sequence containing D and J gene          segments AE described above and a bp          sequence containing  V genes AE showed that          physiologic RSS are also easily resolved by their           RIC scores Table  The two D          RSS have           RIC            well above threshold  and           Table  and the V RSS associated with          functional gene segments are also easily identified mean           Table  Figure b Again the only RSS not          scoring above threshold are associated with pseudogenes              V   V   V            nevertheless all three           RIC            scores fall above the background          mean  RSS flanking pseudogenes cannot be          stringently selected so we expect their           RIC to be below threshold but above          background          For comparison we scanned the five sequences          AE AE AF X and X using          the           WM and           WM models In all cases the mean          score for nonRSS is lower than the mean score for          physiologic RSS associated with functional gene segments          but the disparity between the two sets of scores is          always greatest for the           RIC models Table  showing that          discrimination between RSS and nonRSS is clearest using          the           RIC models This wider disparity          may be important when searching for functional but          degenerate signals such as cryptic and          pseudogeneassociated RSS                    RIC            scores for AE are directly          compared with           WM            or           WM            scores in Figure  The majority of          scores for nonRSS fall below the           y            x line indicating that they          receive lower scores under the           RIC            model than under either of the          Markov models Figure  The scores for RSS associated          with functional gene segments tend to fall above           y            x  indicating their better          discrimination by the           RIC            model Figure  Of the seven          pseudogeneassociated RSS in AE scores for three          fall in the cloud of background scores under all three          models whereas scores for the remaining four do not          Figure  Although the scores for these four RSS are          higher under both Markov models than under the           RIC            model they are better          discriminated by the           RIC            model because the background scores          are higher under the Markov models Figure           Parameters for all six models were estimated from the          full set of RSS  RSS and  RSS Of the           RSS contained in the search contigs  of the RSS          associated with functional gene segments were part of the          estimation set In contrast the pseudogeneassociated          RSS J J and seven V and three of the          functional J RSS were not part of the estimation          set                          RICscores identify functional cryptic RSS          cRSS in    orientation and embedded near the           end of V gene segments can mediate receptor editing          the replacement of the V gene segment portion of a          rearranged variableregion gene with an upstream V gene          segment reviewed in   To test whether our model          can recognize these cRSS we computed           WM                       WM             and           RIC            scores for all bp segments in             orientation in V           H gene segments known to participate          in receptor editing the V           H S gene segment   the V           H S gene segment   and the H          transgene   The cRSS were not part of the RSS set          used for parameter estimation While the cRSS in V           H S and V           H S have higher scores than any          other bp segment in their respective gene segments          under all three models the           RIC            and           WM            models are better at identifying          them because these models have lower background scores          than the           WM            model Table  The cRSS in H          however is best recognized by its           RIC            score Figure  While it has a          higher score under the           WM model its           RIC            score is more separated from the          background           RIC scores than its           WM            or           WM            score Figure  All          receptorediting events in H involved the cRSS          identified by           RIC                            RICscores are correlated with RSS recombination          efficiencies          To quantify any correlation between           RIC and RSS function we computed          Spearmans rank correlation coefficient            r                       s             between           RIC and published recombination          frequencies   The correlation coefficients are           r                       s              for RSS Figure  and           r                       s              for RSS Figure  for these RSS           RIC explains  of the          variation in recombination efficiency           WM and           WM are equally well correlated          with recombination efficiency           WM                       r                       s                        WM                       r                       s                        WM                       r                       s                        WM                       r                       s              Only  of  RSS and  of  RSS          included in this study   are part of our parameter          estimation set                            Discussion        We developed models of the correlation structure in         and RSS using a model selection procedure that finds the        models with the most power to predict the population of        functional RSS The procedure determines the groups of        positions such that the predictive power of the model is        increased by including the correlation between the        positions within each group Positions not correlated with        any other position are included in the models by the        probability distribution over the four nucleotides at that        position groups of correlated positions are included by        the probability distribution for the set of motifs        prescribed by the number of positions within the group for        example a group of four positions would be modeled by the        probability distribution for the  possible quadruplet        motifs The models compute an RSS information content        score         RIC  for any RSSlength sequence        that is bp segments are scored by the RSS model and        bp segments are scored by the RSS model        Model selection evaluates all possible combinations of        probability distributions in a stepwise fashion so the        correlation structure of RSS is not specified nor assumed        but rather detected Interestingly the positions        exhibiting the strongest correlation overlap substantially        with the RSS nucleotides that contact the recombinase        Figure and   offering support for the hypothesis        that positions acting cooperatively to influence binding by        the recombinase coevolve This overlap also suggests that        the correlation structure detected by our model selection        procedure is relevant to RSS function        To determine if modeling the correlation structure        specific to RSS improves RSS recognition and evaluation we        compared the         RIC models with models that assume        RSS positions are independent order zero Markov models         WM  and models that assume adjacent        positions are correlated order one Markov models         WM  In general we find that while        all models predict RSS function equally well with        Spearmans rank correlation coefficients around  for        RSS and  for RSS the         RIC models are better at        discriminating between RSS and nonRSS segments This is        especially true for the degenerate relatives of RSS  cRSS        and pseudogeneassociated RSS        Under each model we compared the score distribution for        physiologic RSS with that for nonRSS segments We find        that the two distributions are most disparate under the         RIC models Figure  While        including correlation in the models increases the scores        for most physiologic RSS Figure  assuming adjacent        positions are correlated increases scores nonspecifically        raising the background scores Figures   The        distribution of scores for nonRSS was approximated by        computing the score for all RSSlength segments in a kb        region of chromosome  containing no known RSS and also in        a pseudorandom string of A G C and T characters the same        length as the chromosome  region and having the same        nucleotideusage frequencies        We determined threshold scores to discriminate between        functional RSS and nonRSS The lowest  of scores for        physiologic RSS under each model were used as test        thresholds for  of  thresholds the frequency of        nonRSS scoring above threshold was lowest under the         RIC models Figure  We selected        threshold         RIC scores  and  for         and RSS respectively at which more than  of        physiologic RSS score above threshold and the predicted        frequency of functional signals in the mouse genome is on        the order of  Table  Many of the signals identified        by the models may mediate recombination and so this        frequency overestimates the falsepositive rate The        falsepositive rate can only be estimated by testing a        random sample of these putative cRSS for function        We show that the threshold scores can be effectively        used to screen genomic DNA for functional RSS We screened        over  kb of genomic DNA containing  physiologic RSS        Table   of which are not part of the RSS set used for        parameter estimation Under all models the mean score for        nonRSS is lower than the mean score for physiologic RSS        associated with functional gene segments but the disparity        between the two sets of scores is always greatest for the         RIC models Table  Only four RSS        one RSS and three RSS have         RIC scores below their respective        threshold scores and all four are associated with        pseudogenes The remaining four pseudogeneassociated RSS        included in our search are better recognized by         RIC than by         WM or         WM Figure  Furthermore we        computed the         RIC          scores for all potential           oriented cRSS in three V         H gene segments observed to mediate        receptor editing Importantly cRSS were not included in        the estimation set Two cRSS are recognized by all three        models but the third is recognized only by         RIC Figure  We expect cRSS and        pseudogeneassociated RSS to be under less stringent        selection pressure than physiologic RSS and therefore to        have lost some of their sequence similarity to RSS An        important future test of the         RIC models will be to scan genomic        DNA prospectively for cRSS and show that the cRSS        identified mediate recombination by the VDJ recombinase        We have successfully used the model selection procedure        introduced here to develop models for two sets of highly        variable and complex binding sites An advantage of this        procedure is that the correlation structure of the site is        determined from the statistical properties of the sequence        set alone therefore the sequence properties governing        recognition of the site by the binding proteins can be        identified in the absence of experimental evaluation of        function Often there is an abundance of sequence data that        has not yet been or perhaps cannot be experimentally        evaluated Information about the correlation structure of a        binding site can give important insight into how the        binding site and binding proteins interact and may        suggest important experiments In addition by choosing the        positions to be correlated independently of their relative        positions we are able to model highly complex patterns        with a relatively reduced increase in model complexity        Inclusion of highly complex correlation patterns in models        of DNAsequence sites can improve the precision with which        sites are identified and functional levels are        predicted                    Materials and methods                  RSS sequence set          We analyzed  physiologic mouse RSS from all           Tcr and           Ig loci available   About            of the RSS are associated with functional V D          or J gene segments Immunogenetics database              Two are associated with pseudogenes known to          rearrange and two are associated with open reading          frames ORFs also known to rearrange see Immunogenetics          database     The ability of the remaining RSS          to rearrange is unconfirmed                          Calculation of positionwise entropy and mutual          information          For a DNA sequence alignment the positionwise          entropy           H                       i              measures the level of nucleotide diversity          minimum           H is  and indicates strict          sequence conservation maximum           H is  and indicates that the four          nucleotides occur at nearly uniform frequencies The          estimated entropy at the           i th position in an alignment is          given by where           p                     i            j  is the estimated probability          of nucleotide           j at position           i           The estimated mutual information            MI    between two positions           i and           i  is computed as           MI                     i            i             H                       i                       H                     i             H                     i            i   where           H                       i            is the estimated entropy computed from the frequency          of the four nucleotides at position           i and           H                     i            i  is the entropy computed          using the frequency of the  pairs of nucleotides at the          two positions          Nucleotide and nucleotide pair probabilities are          themselves estimated using the Bayesian posterior mean                               where           m                     i            s  is the frequency of          nucleotide or nucleotide pair           s in positions           i of the alignment           N                       i            is the total number of sequences in the alignment at          positions           i  and           r is the number of distinct classes          in the probability distribution for single nucleotides           r   for nucleotide pairs           r   and so on          Under the null hypothesis of no correlation between          nucleotide positions in RSS positive           MI                     i            i  values may still be          observed To test if the           MI                     i            i  values differ significantly          from  we randomized the order of the sequences in          position           i  and recomputed           MI                     i            i   By randomizing the order          of the sequences in one position but not the other we          preserve both marginal distributions but disrupt any          correlations The proportion of  permutations giving           MI                     i            i  values higher than that          observed in the data is our estimate for the           p value under the null          hypothesis                          Statistical models of RSS structure          Single models for RSS and RSS define the set of          probability distributions that contain the most          information about RSS structure We developed the models          by stepwise model enlargement and selection We begin          with the smallest models order zero Markov models          estimated under the assumption of pairwise site          independence These models take as the probability of          observing a sequence           S  the product of the individual          marginal probabilities over the RSS positions           P            S                          i                      P                       i                       s  where           s is the nucleotide observed in          sequence           S at position           i  The marginal probability          distribution for a position defines the probability of          observing each of the four nucleotides at that position          and is estimated from the RSS dataset using the Bayesian          estimator for           P                       i                       s  described above Each potential          model enlargement is accomplished by replacing the          product of an independent marginal probability and           k variate joint probability by a          corresponding           k  variate joint          probability          For example the first step of model enlargement for          RSS of length           N compares all possible          combinations of one joint probability distribution for          two positions and marginal probability distributions for          the remaining           N  positions for every pair of          positions           i and           i  there is the model                    Under each of these models we compute scores by taking          the natural logarithm of           P            S  ln           P            S  for each RSS in the dataset          using leaveoneout crossvalidation   Briefly for          each model we exclude one RSS from the dataset estimate          the probability distributions used in the model from the          remaining RSS and compute ln           P            S  for the excluded RSS We          perform this computation for each RSS and take the          average ln           P            S  over all RSS We then select          the combination of probability distributions giving the          largest average ln           P            S           The second step of model enlargement expands the model          selected in step one by comparing all models within two          classes those based on two joint probability          distributions the one formed in step one and one for an          additional pair of positions and marginal probability          distributions for the remaining           N   positions and those based on          one joint probability distribution for a group of three          positions the pair joint selected in step one expanded          to include one additional position and marginal          probability distributions for the remaining           N   positions We again compute          ln           P            S  under each model for each RSS          using leaveoneout crossvalidation and select the model          giving the largest average ln           P            S           We continued the stepwise model enlargement and          selection iteratively expanding the models until the          mean ln           P            S  ceased improving The final          model is not necessarily optimal however we perform the          maximization in a stepwise manner and so as in any          stepwise statistical procedure are not guaranteed to          achieve the global maximum          Once the final set of probability distributions has          been selected the mean ln           P            S  no longer improves the          parameters of each probability distribution are estimated          on the complete set of RSS ln           P            S  for an RSS is a value between            and  If RSS were strictly conserved the consensus          RSS would have ln           P            S    We define the ln           P            S  of a sequence computed from the          final model as its RSS information content            RIC  The final models take the          form                    RIC             ln            P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      and                    RIC             ln            P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      P                      The CA dinucleotide at positions  and  of the          heptamer is required for rearrangement              Therefore the models assign a probability of  to any          RSS not beginning with CA          RSS in the dataset receive higher           RIC values and           WM and           WM values see below during          genome searches than during model development because          the sequence for which           RIC is calculated is excluded from          the dataset during model development a property of          leaveoneout crossvalidation   In contrast          nucleotide frequencies used in the searches are estimated          on the complete set of RSS The difference between the          two           RIC values is greatest for rare          sequences and in general the differences are larger for          RSS The difference between the two scores is            for  of RSS and for  of RSS                          Markov models          We also modeled RSS with weight matrices based on an          order zero or order one Markov model reviewed in            The order zero Markov model assumes that all RSS          positions are independent so the probability of          observing a sequence           S that is           N bp long is                    where           P                       i                       s  is the probability of observing          nucleotide           s at RSS position           i            P                       i                       s  is estimated as described above          from the set of physiologic  or RSS The score for          sequence           S is then the natural logarithm of          the probability           P            S                     The order one Markov model assumes that all adjacent          positions are correlated so the probability of observing          sequence           S is based on conditional          probabilities                    where           P            s                       i                       s                     i   is the probability of          observing nucleotide           s                       i            in position           i given that nucleotide           s                     i  occupies position           i   From Bayes rule                    where           P            s                     i             s                       i             is the joint probability distribution for the          dinucleotide           s                     i            s                       i            occurring at the pair of positions           i   and           i  Again the probability          distributions are estimated from the physiologic  or          RSS and we take the natural logarithm of the          probability           P            S  as the score for sequence           S                               