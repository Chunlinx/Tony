                    Background        Genetic heterogeneity is a hallmark of RNA viruses in        general and the hepatitis C virus HCV in particular due        to the lack of fidelity of viral RNAdependent RNA        polymerases      In HCV this genetic diversity has        been organized into six major genotypes and numerous        subtypes over  Isolates of the same genotype have an        average DNA sequence identity of  but different        genotypes have DNA sequence identity close to  on        average               Nucleic acidbased assays such as the polymerase chain        reaction PCR the ligase chain reaction LCR nucleic        acid sequencebased amplification NASBA branched chain        DNA bDNA and sequence analysis itself rely on the        efficient hybridization of oligonucleotides to the targeted        sequence Mismatches between the oligonucleotides and the        targeted nucleic acid can affect duplex stability and may        compromise the ability of a system to amplify and detect        the targeted sequences Numerous factors determine the        effect of mismatches including the length of the        oligonucleotide the nature and position of the mismatches        the temperature of hybridization the presence of        cosolvents and the concentrations of oligonucleotides as        well as monovalent and divalent cations            The sequence heterogeneity of HCV challenges efficient        detection with nucleic acidbased assays PCR is widely        used for the detection of HCV specific nucleic acids due to        its sensitivity Generally speaking however effective        primers require the genotype of the sample to be known in        advance and even then will often be less than         effective due to minor variations in the isolates        Design of robust primers to maximize success with        unsequenced isolates          ie  clinical samples is a common        challenge facing the molecular virologists A number of        software products exist to facilitate primer selection with        defined genomes Many factors are considered in these        programs for example melting temperature of primers        avoiding primer dimers avoiding selfcomplementary primers        etc eg Primer Premier     Primer     PRIDE            These algorithms deal mostly with a single template or        a small number of sequences Little effort has been made to        handle large number of heterogeneous variants of a given        genome        A large number of HCV related sequences have been        deposited in GenBank making genome wide comparison of all        different HCV genotypes and subtypes possible In this        report more than  complete and  partial sequences        deposited in GenBank Release  April   have        been used to generate a genome wide consensus sequence and        Position Weight Matrix PWM for the HCV genome A PWM        based approach for identifying highly conserved regions is        proposed which should aid in robust primer design for        nucleic acidbased assays This approach is general enough        to be used to optimize any set of genomes with a high        degree of heterogeneity                    Results and Discussion                  Aligning genomes and generating a position weight          matrixPWM          One HCV genome D was used as a template and was          separated into pieces based on known gene boundaries All          complete and partial sequences that contained a given          region were collected by TBLASTN    against HCV          sequences from the GenBank nonredundant nucleotide          sequence database nt An alignment was then made for          each part of the genome using ClustalW     A weight          score for each position in each fragment was calculated          and a PWM was created for that fragment A whole genome          PWM was created by joining the individual PWMs Finally a          bp window representative of a typical primer was          walked through the genomePWM to identify the most          conserved locations for primer design          Due to the extreme genetic heterogeneity of the HCV          genome and the nature and large number of complete and          partial sequences in the public database a direct genome          wide sequence alignment was not feasible The approach          taken to break the HCV genome into  pieces according          to the gene boundaries proved to be successful HCV          sequence D was chosen arbitrarily as the template          sequence and the number of sequences included for          alignment of each region is indicated in Table           Some regions of the HCV genome share only  percent          identity across strains Figure shows a plot of          conservation score using a bp window for the whole HCV          genome Region  which corresponds to the  UTR is          very conserved across all strains while region           corresponding to the E protein is very heterogeneous          In addition third position wobble causes mismatching at          virtually every third base in the coding region          leading as expected to less identity at the DNA level              In the process of collecting sequences for each          HCV region using a nucleotide level comparison algorithm          like BLASTN a lot of sequence entries will be missed To          solve this problem a protein level comparison algorithm          TBLASTN was used via a sixframe translation Different          stringency scores were used to ensure that as many          sequences as possible were retrieved A sequence was          chosen for alignment for a given region if it shared at          least  identity over a  amino acid stretch or            identity over a  amino acid stretch or over           identity over a  amino acid stretch with the template          sequence These cutoffs were chosen following inspection          of the blast hits for the different regions Only  of          the available sequences were discarded due to failure to          meet the aforementioned criteria          For each regional alignment flanking sequences were          trimmed prior to generating the PWM The genome wide PWM          was created by combining all individual PWMs see          additional file  Insertions represented by  in          additional file  were added to the template sequence          only if greater than  of the sequences contained this          insertion This was done to reduce the inclusion of          spurious insertions that are caused by sequencing errors          or that exist in only a single isolate A consensus          sequence was derived by picking the most frequently          occurring base at each position          Additional file           HCV whole genome PWM The first line is the consensus          sequence and the second line is the template sequence          D          Click here for file                          Choosing a conserved region for optimized primer          design          Using the PWM the most conserved stretches were          rapidly identified making possible the design of robust          primers based on the criteria described in Methods The          bp segments in Table and Table are listed by          positions in the genome The higher the odds score the          more conserved the region Figure shows samples from the          final PWM one bp region in NSB has a very low          conservation score A a second bp region shows a          very high conservation score B This approach allows          rapid identification of the most conserved regions of the          genome with no regard for selfcomplementarity of          primers optimizing melting temperature avoiding primer          dimers etc Once potential regions of interest are          identified other primer design algorithms can then be          used to ensure that selfcomplementarity etc will not be          a problem This two step strategy for designing robust          primers can be applied to any set of genomes with a high          degree of heterogeneity such as viruses bacterial genes          etc Once a specific sequence has been identified          partially degenerate or multiple oligonucleotides can          easily be generated as deemed appropriate for the          particular application Empirical validation of all          primers is still prudent                            Methods                  Databases and Resources          Genbank Release  was downloaded from          ftpncbinlmnihgov Pairwise alignment TBLASTN             was used to determine whether or not two sequences share          similarity ClustalW    was used for multiple          sequence alignment All noncommercial softwares used in          this study were written in PERL                           Construction of alignment          All HCV related sequences were extracted from GenBank          Release  by using keyword HCV or Hepatitis C D          was chosen as the organizing template for its fully          annotated genome in the GenBank Other organizing HCV          genomes yielded virtually identical consensus sequences          and PWM profiles The genomes were separated into           regions according to Ds annotation  UTR core          E EP NS NS NSA NSB NSA NSB The DNA          sequences for each of these regions were retrieved and          used for TBLASTN analysis against all HCV sequences If a          sequence shared  identity over bp  amino acids           identity over bp  amino acids or  over          bp  amino acids with the query template region it          was considered to contain part of the corresponding gene          from a HCV genome in that region and therefore was used          for multiple sequences alignments of this region For          each region a multiple alignment was done using          ClustalW Alignment was manually curated to eliminate          obvious false alignments due to bad sequence quality or          inappropriate BLAST hits                          Construction of PWM          A PWM and a consensus sequence were built for each          region of HCV and subsequently assembled into a whole          genome consensus sequence and PWM For each of the           regions the number of occurrences of each base at a          given position was compiled These counts were converted          to frequencies that were used to calculate log odds          scores The odds score is the frequency observed divided          by the theoretical frequency expected            ie the background frequency of          the base usually averaged over the genome base          For example if the base frequency is  and the          estimated background frequency is  the odds score          would be    Finally odds scores were          converted to log odds scores by taking the logarithm base                    W           ij  log            F           ij P           i           Where          W           ij is the scoring matrix value of          base i in position j          F           ij is the frequency of base i in          position j P           i is the background frequency of base          i          As the logarithm of zero is infinity a zero          occurrence of a particular base in the matrix creates a          problem In this case a large negative log odds score          may be used at such a position in a scoring matrix A          formula proposed by Hertz and Stormo    was used          instead in our calculations          W           ij  log            C           ij  P           i N  P           i   log            F           ij P           i           Where C           ij is the count of base i in position          j N is the total number of sequences                          Choosing a conserved region for primer          design          By sliding  bp window representing average primer          length incrementally along the genome in bp intervals          an average of the highest log odds scores for each          position either A C G or T was calculated to generate          the overall degree of conservation conservation score          for this bp region                    where L is the length of the region bp in this          case          For PCR applications or those involving          polymerization where homology at the  end of the          primer is most critical it is recommended that the           end and the penultimate position be G or C with          frequencies of  It is also beneficial if the          previous position   is a G or C with a frequency of           or alternatively an A or T with a frequency of           Regions that contain insertions should in          general be avoided                            Authors contributions        PQ carried out the data analysis PQ XC LW JG and BM        participated in the design of the study PQ and BM drafted        the manuscript        All authors read and approved the final manuscript            