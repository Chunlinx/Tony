                    Background        The identification of individual genes governing        phenotypic variation is crucial to understand the        mechanistic basis of quantitative inheritance and        ultimately provide information about the design of optimal        breeding strategies in both plants and animals        Quantitative genetics based on new statistical and        computational technologies has advanced to the point at        which individual genes can be detected and mapped on        chromosomes      The underpinning for the detection        and mapping of genes is founded on their particular        segregation pattern For a pedigree derived from inbred        lines the segregation pattern of a gene can be exactly        predicted In this situation quantitative genetic theory        can lay a sufficient foundation for gene detection and        thus the properties of a detected gene can be adequately        described by its effect and genomic location However for        outcrossing populations such as forest trees in which        inbred lines are not available genes also display        population genetic properties     Hence the foundation        for gene detection in these populations should be        established on a combination of quantitative genetics and        population genetics The estimation of the population        genetic properties of genes such as allele frequencies and        the degree of disequilibrium can not only enhance the        precision and power of gene detection but also is        fundamentally important to our understanding of population        differentiation and evolution             We present a strategy for investigating the existence of        genes in an arbitrarily complex progeny test based on        phenotype data and estimating the effects of these genes on        a quantitative trait and their population properties under        the maximum likelihood framework Only a limited number of        statistical studies have been performed to detect genes        based on the phenotypic data            and        none of these studies have considered the population and        evolutionary genetic properties of genes Our study        population can be derived from a natural population instead        of inbred lines as used for general agronomic crops A        finite number of unrelated parents are randomly selected        from a natural population and are mated to produce progeny        tests under a mating design such as factorial or diallel        In a recent paper we used such progeny tests to derive a        model for detecting major genes affecting a quantitative        trait     This model has power to estimate the effect        of drift errors on genetic variation during hybridization        thus providing information about dynamic changes of the        genetic architecture of a population under artificial        hybridization However the estimates of population genetic        parameters from the progeny test using the above model        cannot be generalized to the original population from which        the mating design is derived In this paper we developed a        hierarchical model for analyzing the pattern of gene        segregation at both population and family levels which        thus can provide estimates of genetic parameters in two        successive generations of the population Estimates of        population genetic parameters using this hierarchical model        can reasonably infer the genetic structure of the original        population A forest tree example is used to demonstrate        the application of the new statistical model for gene        detection                    Model                  Population genetic structure          Suppose there is a segregating major gene responsible          for a quantitative trait in a natural or experimental          diploid population This gene has           s different codominant alleles           A                       A                       s             whose frequencies in the population are denoted by                    p                       p                       s            with           p              These           s alleles randomly unite to form           s            s   distinguishable genotypes          including           s homozygotes and           s            s   heterozygotes The          population frequencies of the genotypes are denoted by           p                          s  If the population is at          HardyWeinberg disequilibrium HWD the genotypic          frequency is the product of the two corresponding allelic          frequencies plus the coefficient of HWD            d             ie           p                       p                      p                       d             where           d            has the restrictions max           p                        p                        p                        p                        d                       p                      p            and                       d                                  v            d                                           Mating design          A finite number of unrelated individuals are randomly          selected from the population as female and male parents          to generate a           I            J factorial mating design Based on          sampling theory these selected individuals have          genotypes at the major locus whose counts follow the same          multinomial distribution as those in the original          population with probability vector                       p                        p                           n  The segregation of progeny          genotypes in the mating design depends on how the          majorlocus genotypes segregate  among the selected          female or male parents and  within each of the          fullsib families Table  The segregation among the           I female or           J male parents having the same          pattern as in the original population is viewed as the          populationlevel segregation The segregation within a          fullsib family of size           n                       ij            derived from the           i th female and           j th male parent follows the          Mendelian segregation ratio viewed as the familylevel          segregation To understand the genetic structure of the          original population different genetic information          derived from this twolevel segregation will not be          mixed but rather combined within a maximum likelihood          framework                          Estimation method          Let           y                       ijk            denote the phenotypic measurement for the           k th offspring from           i th female parent and           j th male parent and           g                       ijk            denote its genotype at the major gene           i              I            j               J            k              n                       ij             The statistical model describing the          phenotypegenotype relationship can be expressed as                    where             is the genotypic value of genotype           A                      A             and           e                       ijk            is the error term with the normal distribution           N            Let be the genotype for the           i th female parent and for the           j th male parent We denote by                       y            the collection of the observed data and by                       z                                    g                                   g                                  f                                   g                                  m             the collection of the majorlocus genotypes for          offspring female parents and male parents We assume the          following hierarchical model                    where           f denotes the normal distribution          of the phenotype           N                          h is distributed according to the          Mendelian segregation pattern and  is multinomially          distributed with probability vector                       p             Note that genotypes for siblings are dependent          and given genotypes the traits are independent of each          other Under the above model                        y z             has a joint distribution as follows                    Statistically equation  is a mixture model in          which each component is represented by a genotype within          a fullsib family       The maximum likelihood          estimates for                            p  can be obtained using the EM          algorithm      At the           t           th step of the EM sequence the          expected loglikelihood is proportional to                    where                        G            sums over all possible genotypes are the posterior          distributions of offspring genotypes and           iG            jG are the posterior distributions          of parent genotypes Conditional on  these posterior          probabilities can be evaluated as follows                    The EM sequence is defined by                    Suppose the major gene has two different codominant          alleles the posterior probablities in equation  can          be exactly calculated for a usual mating design However          for large designs with many parents or for the case where          the major gene has many different alleles we have to          rely on a Monte Carlo version of the EM algorithm For          example we can sample from the conditional distribution          of                       z                                    g                                   g                                  f                                   g                                  m             given using the following Gibbs sampler                                                   Example        We use data from aspen trees to illustrate the        appication of our statistical model for detecting a major        gene The example is derived from a    factorial mating        design of         Populus tremuloides and         P tremula The parents for the        crosses were randomly selected from a mixed breeding        population of two different species established at the        University of Minnesota Originally the         P tremuloides trees used as the        female parents from the Upper Peninsula of Michigan and        northern Wisconsin and the         P tremula male parents came from        northeastern Poland and Germany     The seedlings from        the progeny population were planted in two different        locations one on a cutover forest site near Grand Rapids        Minnesota and the other on farmland near Rhinelander        Wisconsin Both trials were laid out in a randomized        complete block design with  replicates and six seedlings        per family in each replicate at    spacing At the        end of the second year in the field all trees were        measured for stem height        Figure presents density estimates of the second year        height from each family pooled over the two locations        Trees from eight families did not have growth data due to        mortality The phenotypic distributions suggest the        existence of a major gene in the progeny test For example        in the family derived from Clone  TA the        phenotypic distribution is a mixture of at least two        components showing the existence of a segregating gene        Figure also indicates different segregation patterns among        the families with some more smooth and others more waved        thus suggesting that some parents are heterozygous with        their alleles segregating in the progeny        The effect and genotypic frequencies of the major gene        are estimated using the hierarchical model assuming two        alleles Since no significant difference is detected        between two locations we only report the result based on        pooled data With probability of almost one parents        TA TA TA XTA have genotype         A                  A           parents TA TA CLONE        TA have genotype         A                  A          and the rest parents have genotype         A                  A           The estimates of the genotypic        values of         A                  A                   A                  A          and         A                  A          are                           and              respectively The        estimate of residual variance is     Here        the estimates of standard errors for the parameter        estimators are obtained based on the Fisher information        matrix     We also fitted the model under the null        hypothesis that there is no major gene with a single normal        distribution The likelihood ratio test has          p   suggesting the        existence of a major gene for height growth The ratio of        the dominant to additive effect for this major gene is less        than  which implies that it affects the stem height        growth in an additive manner        The population genetic parameters of this major gene are        estimated based on the genotypes of the parents detected        The genotype frequencies estimated are identical for the        three genotypes ie                                In consequence the allele        frequencies are also same                       Thus the mixed breeding        population of         P tremulodes and         P tremula is not at HardyWeinberg        equilibrium because the genotype frequencies are not        products of the corresponding allele frequencies The        coefficient of HardyWeinberg disequilibrium is estimated        as  The estimate of allele frequencies and HardyWeinberg        disequilibrium using our hierarchical model can be well        generalized to the original breeding population from which        the parents were sampled However one should be cautious        about the accuracy of the estimator due to the small sample        size                    Simulation        The behavior of the EM estimators is evaluated by two        simulation experiments In the first simulation a  by         mating design same as our real example is assumed The        major gene is assumed to have two codominant alleles         A          and         A          whose frequencies in the population        are         p            and         p            The genotypic values are set to        be   and  with standard deviation  Based on the        hierarchical model defined in equation  we first        simulated a set of the parental genotypes          A                  A                   A                  A                   A                  A                   A                  A                   A                  A                   A                  A          for females and         A                  A                   A                  A                   A                  A                   A                  A                   A                  A                   A                  A          for males Then we randomly generated         offspring genotypes and observations for each        family        Our EM estimating procedure converged to the correct        parental genotypes after only a few iterations normally         or  A loglikelihood test is highly significant with        loglikelihood ratio equals  df   The estimates of        genotypic values from a single simulation replicate are           for         A                  A              for         A                  A          and and    for         A                  A           The estimate of residual variance is                  In our second simulation we studied a  by  mating        design We used  replications to investigate the        empirical accuracy of the estimators We assume the major        gene has  alleles and randomly generated parental        genotypes The parental genotypes were randomly generated        based on allele frequence         p            That resulted in female        genotypes          A                  A                   A                  A                   A                  A                   A                  A                   A                  A           and male genotypes          A                  A                   A                  A                   A                  A                   A                  A                   A                  A           For each family we simulated the         genotypes for its offsprings and then simulated its trait        measurement using a normal and lognormal distribution        The results from the second simulation study are        summarized in Figure  The top panel of the plots is for        the simulation where trait measurements are simulated from        a normal distribution The bottom panel corresponds to        lognormal data In each plot we graphed the ideal estimates        of the parameter assuming that we know the genotypes of        each offspring versus our estimates based on the EM        algorithm Mean squared errors are also indicated in the        plots It is seen from Figure that all four parameters can        be estimated quite accurately in the normal case while they        are slightly biased for the lognormal data                    Discussion        We have derived a hierarchical model for detecting major        genes affecting a quantitative trait based on progeny tests        of outcrossing species The new model takes into account        the population genetic properties of genes and is expected        to enhance the accuracy precision and power of gene        detection The information about the population behavior of        genes estimated from this model is fundamentally important        to our understanding of the genetic architecture of a        natural or experimental population and is also useful for        the design of sound breeding strategies for agricultural        crops and forest trees        We used an example from interspecific aspen hybrids to        illustrate the application of our genedetecting model The        model has successfully identified a major gene with        additive effects on second year stem growth in the hybrid        aspens The additive effect of genes on height growth in        young poplars was also observed in a molecular marker        experiment     In this marker experiment an additive        quantitative trait locus was found to explain almost a        quarter of the total phenotypic variation in second year        height growth The result from the aspen hybrids was        consistent with that from a simulation experiment based on        a mating scheme analogous to that used in our real example        The consistency of the results from the simulation study        suggests that the model proposed here can be adequately        used to detect genes of large effect on the phenotypes        The model will have immediate applications for many        species in which progeny tests have been established for a        number of years     Most of these tests are maintained        in different locations and measured annually thus offering        desirable opportunities to address two important questions         How does the genes interact with environment  What        is the developmental plasticity of gene expression In our        real example no evidence has been obtained for the change        of gene expression at the major locus detected over the two        field trials despite their dramatic differences in        climate soil properties and silvicultural measures            If the stability of the expression of this gene over a        range of environments is confirmed by more accurate        genotype determination methods eg based on genetic        markers It will have a tremendous application in breeding        for stable cultivars of forest tree species        Our analysis and simulation is based on diallelic        inheritance But multiallelic inheritance can be similarly        considered although more parameters should be introduced        Also our model assumes the segregation of a single gene in        progeny tests The principle behind the model can be        extended to consider two or more genes Modelling multiple        genes may be closer to biological reality because the        linkage epistatic interaction and genetic association        among genes are considered However the consideration of        these relationships needs to estimate an increased number        of unknown genetic parameters Finally our model is based        on a balanced factorial design For some populations like        mammals mating designs are frequently unbalanced because        of limited resources or reproductive difficulties It is        very important to extend our analysis and model to an        unbalanced mating design of any complexity For all of        these extensions mentioned above maximum likelihood        approaches may not be sufficient owing to an increasing        dimension of parameter space A more powerful computational        tool eg Markov chain Monte Carol methods may be needed           to make our model more tractable in real        applications            