                    Background        The introduction of small subunit ribosomal RNA as a        tool in microbial taxonomy by Carl Woese and George Fox           led most microbiologists to assume that the concepts of        animal and plant taxonomy could be extended to the realm of        prokaryotes In particular it was assumed that a natural        taxonomic system for microorganisms was feasible            The goal of a natural taxonomic system is the formation of        taxonomic groups that are defined by shared ancestry            By definition an ancestor that defines a monophyletic        group can only give rise to members of this group No        organism outside this group has a lineage that traces back        to the same ancestor paraphyletic group however there        might be earlier ancestors that define more inclusive        monophyletic groups The metaphor for organismal evolution        that underlies a natural taxonomic system is a strictly        bifurcating tree of species A decade ago ribosomal RNA        promised that one day it might be possible to place every        extant organism on a universal tree of life and the hope        was that more genomic sequences would make this placement        more accurate        However the analyses of completely sequenced genomes        initiated a reassessment of concepts in microbial evolution            While some molecular markers were found to agree        with one another eg     others do not                  Transfer of genetic information between divergent        organisms has turned the tree of life into a net or web            and genomes into mosaics Different parts of genomes        have different histories and representing the history of        genome evolution as a single tree appears inconsistent with        the data Nevertheless the assumption of a treelike        process still underlies many approaches Genome content        trees have been calculated based on the presence and        absence of genes      or types of protein folds            While there is limited agreement between genome and        rRNA phylogeny at present it remains unclear whether this        similarity is based on shared ancestry of part of a less        frequently exchanging genome core     or if the        apparent congruence is itself the result of horizontal gene        transfer            Overall genome content is not best represented on a        single tree Fig gives an example of an alternative        depiction where thickness of a line reflects percentage of        genes shared between two genomes The coherence among the        three domains of life Bacteria Archaea Eucarya            is clearly reflected in genome content ie Archaea share        more genes with other Archaea than with Bacteria but many        features are incompatible with representing the        relationships between different genomes as a tree For        example the mesophilic euryarchaeon         Halobacterium sp has more genes in        common with the mesophilic Bacteria than does the        thermophilic crenarchaeote         Aeropyrum pernix  However the        extremophilic euryarcheote         Archaeoglobus fulgidus shares many        more genes with the extremophilic bacteria         Aquifex aeolicus and         Thermotoga maritima than does         Halobacterium  While this example        illustrates the weblike relationships among genomes        recent phylogenetic reconstructions from molecular data        have explored only few alternatives to the treeparadigm        eg             One obvious drawback of the starlike representation in        Fig is that it utilizes BLAST search results only Any        phylogenetic information retained in the sequences is not        utilized beyond the presence or absence decision based on a        single expectation value cutoff Because of recombination        individual genes themselves might be mosaic            however withingene recombination of protein coding genes        occurs mostly between closely related organisms The        redundancy of the genetic code greatly reduces        recombination between divergent proteins Even if a region        is  conserved on the amino acid level the encoding DNA        can be so different as to allow the mismatch repair system        to prevent recombination For studies of single divergent        orthologous protein encoding genes the assumption of a        treelike evolutionary history remains a reasonable        expectation In this manuscript we focus on methods that        utilize the phylogenetic information that is retained in        molecular sequence data while not presuming that genomes        as a whole evolved in a treelike fashion        In an elegant approach Korbinian Strimmer and Arndt von        Haeseler    utilized Bayesian posterior probabilities        to assess the phylogenetic information contained in an        alignment of four homologous sequences With four sequences        there are only three possible tree topologies and thus the        three posterior probabilities corresponding to these three        trees must sum up to one Utilizing a barycentric        coordinate system the resulting probability vector is        represented as a point in an equilateral triangle Fig         where the distances of the point P to the three sides        represent the three probabilities Strimmer and von        Haeseler applied this approach to depict the phylogenetic        information content present in a multiple sequence        alignment They plot the results from the analyses of all        possible quartets where the four sequences are selected        from a single multiple sequence alignment in the same        coordinate system If there is a lot of phylogenetic        information in the alignment then most probability vectors        will fall close to one of the corners conversely datasets        containing little phylogenetic information will mainly        result in vectors falling into the center of the triangle        Here we explore the application of this and similar        approaches in comparative genome analyses In particular        we compare different approaches to calculate Bayesian        posterior probabilities and we compare these probabilities        to the more widely used bootstrap support values We assess        the reliability of the different probability mapping        approaches through their application to mitochondrial        genomes and we illustrate their usefulness by mapping        selected interphylum and interdomain relationships                    Results and Discussion                  Overview of data flow in probability mapping          An outline of our approach to genome probability          mapping is given in Figure  Using SEALS    and          MySQL we developed scripts that identify and retrieve           quart ets of           o rthologous           p roteinencoding open reading frames          QuartOPs from four selected genomes We use the term          genome to denote the collection of all ORFs identified in          a genome In the case of genomes that are not well          annotated it is feasible to use a very wide definition          of ORF eg all amino acid sequences encoded between two          stop codons in any of the six possible reading frames As          long as one of the genomes included in the analyses is          properly annotated only those identified ORFs that are          actually homologous to an identified ORF will become part          of a quartet of orthologs We utilize an operational          definition of an ortholog two open reading frames are          considered orthologous if and only if they are each          others top scoring BLAST hit when one is used as a query          to search the other genome A QuartOP is formed when each          of the open reading frames picks the other members of the          quartet as the top scoring hit in searches of the          respective genomes QuartOPs are similar to the clusters          of orthologous groups COGs maintained by the NCBI                but differ in that COGs require only          unidirectional circular best hit relationships for three          of the reference genomes whereas we require the          reciprocal top hit relationship for the four genomes          included in a quartet and we do not limit our          identification of QuartOPs to a number of reference          genomes Montague and Hutchison utilized a comparable          approach in their definition of congruent COGs              So far we have analyzed  genome quartets see          supplementary material The number of QuartOPs          identified per genome quartet ranges from  for genome          quartet            Deinococcus radiodurans Treponema          pallidum Escherichia coli and           Halobacterium sp  to  for          genome quartet            Agrobacterium tumifaciens          Sinorhizobium meliloti Mezorhizobium loti and           Caulobacter crescentus           Each of the aligned QuartOPs from a genome quartet was          analyzed with respect to the posterior probability of the          three possible tree topologies given the aligned QuartOP          Routinely we calculated these probabilities using          Strimmers and von Haeselers approach     Using          each of the three topologies as a usertree we calculated          the maximum likelihood for each of the three topologies          given the data We then use the three maximum likelihoods          to calculate the probability for topology           i according to the formula           P                       i                       L                       i                       L                       L                       L             where           L                       i            is the likelihood for the best tree given topology           i  Other types of reliability          measures used to evaluate QuartOPs were bootstrap support          values and Bayesian posterior probabilities estimated          using MrBayes program see below          An example for the comparison of four genomes from          different phyla is given in Fig A Surprisingly each          of the three tree topologies is strongly supported by          more than  QuartOPs and most of the QuartOPs appear to          strongly support one of the trees None of the three          possibilities has majority support Figure lists the          functional categories of those QuartOPs that strongly          support the different tree topologies None of the          categories shows a preference for a particular tree          topology For each tree topology more than  of the          strongly supporting QuartOPs belong to the category          information storage and processing while this category          contains only about  of the genes present in the          genomes While the genes in this category appear more          conserved and phylogenetically informative the strong          support that the genes in this category provide is nearly          evenly split between the three possibilities                          Impact of model parameters and sequence          conservation          To test if illaligned sequences might have had an          impact on the analyses we repeated the analysis of          genome quartet   see Figure  using only QuartOPs          that contained very similar sequences By default we only          excluded top hits with an Evalue larger than   We          repeated the example given in Fig Awith a cutoff of            ie we not only required the sequences in a          QuartOP to be each others top hit but in addition we          asked for a high similarity between the two sequences As          a result the support for the three topologies in genome          quartet  dropped to                   the numbers in parenthesis are the numbers of          quartets that support the topology with posterior          probability larger than  and  respectively To          access the level of sequence conservation within the          QuartOPs sequences we calculated the average percentage          of pairwise identity per QuartOP It varied from            to    when the Evalue cutoff was          varied between  and  see supplementary material          for the summary table While pairwise sequence identity          is not a universally dependable measure of phylogenetic          information content these values illustrates that the          sequences within a QuartOP are neither identical to one          another nor so divergent as to be saturated with          substitutions and of questionable homology     Using          only the most conserved QuartOPs does not change the          qualitative result each of the three possible tree          topologies is supported by about an equal number of          QuartOPs see supplementary material          We recalculated the likelihoods for all QuartOPs in          genome quartet  using a model that incorporates           a mong           s ite           r ate           v ariation ASRV The posterior          probabilities calculated according to Strimmer and von          Haeseler did not change dramatically and each of the          three tree topologies is still supported by roughly equal          number of QuartOPs The maps for this analysis are          available in the supplementary material                          Estimating Bayesian Posterior Probabilities          The formula used by Strimmer and von Haeseler             to calculate posterior probabilities ie the          probability that tree topology           T                       i            is true given an aligned set of four sequences          considers only three trees ie branch lengths and          topology each with the same prior probability These          three trees are those that have the highest likelihood          for the three possible topologies However there are          infinitely many other trees that differ from the three          chosen ones only by differences in branch lengths What          is the effect on the calculated posterior probability of          using only the single best tree as a representative of          all the trees with the same topology There is no           a priori reason to exclude the          other trees that have slightly lower likelihoods          A different approach that does not make these          assumptions is the use of Markov Chain Monte Carlo          methods to explore tree space We used the program          MrBayes written by Huelsenbeck and Ronquist              Using a QuartOP with posterior probabilities of            and  we explored different parameter choices for the          biased random walk through treespace We chose two          chains with  burnin cycles and  cycles with          sampling after every cycle as a compromise between          increased precision of the probability estimate and          computation time see Materials and Methods for more          details          The result of calculating the posterior probabilities          of all QuartOPs in genome quartet  is given in figure          B Again all of the three tree topologies are strongly          supported by some QuartOPs When we repeated this          analysis using the same settings none of the          probabilities changed by more than a few percent The          support for the three tree topologies changed from            and  the three numbers          indicate total support and QuartOPs that supported a          topology with more than  and  respectively in the          first run to   and  in the          second indicating that the chosen parameters provided          satisfactory reproducibility Plots of both analyses are          available in the supplementary material Comparing figure          Bwith Ait is clear that in this case the Bayesian          posterior probabilities estimated with MrBayes are more          conservative assessments of reliability than the ones          calculated according to     The  support level          calculated according to    approximately corresponds          to the  support level calculated with MrBayes                          Bootstrap support values versus posterior          probabilities          To facilitate comparison of Bayesian posterior          probabilities with a more widely used confidence measure          we generated  bootstrapped samples    from each          QuartOP in case  Each of the bootstrapped samples was          analyzed using maximum likelihood with the same model of          substitution as before Each of the bootstrapped samples          supports one of the three possible topologies thus the          sum of the bootstrap support values for the three          topologies adds up to  and the percentage of          bootstrapped samples for each QuartOP that best supported          each tree was again plotted in a barycentric coordinate          system Fig C Many more QuartOPs map into the central          region of the triangle as compared to Figure Aand B          Clearly for this test bootstrap support values are more          conservative measures of support than either of the          posterior probabilities calculated above Nevertheless          there are still several QuartOPs that strongly support          each of the three tree topologies however there are           QuartOPs that support grouping           E coli with           Treponema pallidum with better than           bootstrap support whereas the alternatives are          supported by only  and  QuartOPs respectively          Comparing Figures Aand Cit appears that in analyzing          quartets  bootstrap support is comparable to           posterior probability calculated according to                                       Comparison of the different reliability assessment          tools          MLmapping according to    is the least          conservative of the tools explored For the test cases          analyzed a posterior probability of  according to              corresponds to a Bayesian posterior probability of           calculating using a Markov chain exploration of          treespace using    and about  bootstrap support          We did not find a strong dependence of the results on the          substitution models used in calculating likelihoods and          separate runs indicated satisfactory precision of the          calculated probabilities and bootstrap values Given that          we only analyzed about  QuartOPs using all three          approaches it would be premature to generalize our          findings however other analyses that utilized both          bootstrapping and Bayesian posterior probabilities also          found bootstrapping to be more conservative than          posterior probabilities calculated using Bayesian methods          with Markov chain Monte Carlo sampling eg                                         Mitochondrial genomes          While gene transfer into the mitochondrial genomes has          been inferred        mitochondrial genomes are          expected to have undergone many fewer legitimate and          illegitimate recombination events than freeliving          prokaryotes Clearly if probability mapping is to be          considered a reliable approach we expect that when          analyzing quartets of mitochondrial genomes the          different genes should all support the same tree          topology          In most instances this expectation is fulfilled see          Table  even though we selected instances in which the          splits could be expected to be ill resolved eg          echinoderm mammal insect mollusk m or protist          fungus animal plant m The only exception was an ORF          in quartet m that encodes the cytochrome oxidase subunit          II This ORF did not support grouping the animal with the          fungal homolog as expected rather it grouped the protist          and animal homologs together posterior probability          according to    was   Inspection of the          aligned sequences Fig  revealed that there are more          residues shared between the homologs from           Cafeteria roenbergensis and           Homo sapiens thanbetween the          homologs from           Cafeteria roenbergensis and           Arabidopsis thaliana  No artifact          that could be responsible for this unexpected grouping          was detected The same high support for this unexpected          grouping is also recovered in bootstrap analysis and in          posterior probabilities calculated with MrBayes                       The finding of a QuartOP in a mitochondrial genome          quartet that supports a nontraditional grouping could          either reflect a rare recombination event selection          pressures that led to convergent evolution in two          lineages or a chance event  if one looks at enough          samples one will find some that considered by          themselves appear significant At present it is not          possible to decide between these three possible          explanations Our analysis of mitochondrial genomes shows          that in most instances the calculated probabilities          MLmapping Bayesian posterior probabilities or          bootstrap values support the expected tree topologies          albeit with surprisingly strong support values Rarely          unexpected groupings can be recovered and support for          these probably erroneous groupings can be high In most          instances the MLmapping approach accurately revealed the          expected relationships between the mitochondrial genomes          This confirms the suitability of this approach in genome          analyses                          Interphylum genome quartets          Here we focus on examples that illustrate the utility          of the probability mapping approach Focusing on the          relationships between the cyanobacteria with other          bacterial phyla we calculated several genome quartets          that include the           Synechocystis sp genome and three          members each of other bacterial phyla see Table  In          all cases that included both           Bacillus subtilis as a          representative of the low GC Gram positives and           Synechocystis sp the majority of          QuartOPs supported the topologies that grouped these two          organisms together The alternative topologies were          significantly supported by some QuartOPs but the number          of strongly supporting QuartOPs was lower than for the           B subtilis            Synechocystis grouping This also          was true when one of the other two genomes was from a          high GC Gram positive genome quartets    and           Only when two low GC Gram positives were included          in the same quartet was the intraphylum grouping of low          GC Gram positives supported by many more QuartOPs than          the grouping of           B subtilis with           Synechocystis sp genome quartets           and           Previous analyses based on a limited number of          proteins and signature insertions and deletions had          suggested different bacterial groups as closest relatives          to cyanobacteria Among the suggested sister groups were          the Deinococcales    and spirochetes      Our          analyses do not support these earlier claims but are in          agreement with the recent analyses of genes involved in          chlorophyll biosynthesis     which indicated that          the low GC Gram positive heliobacteria are closest to the          last common ancestor of all oxygenic photosynthetic          lineages The analyses summarized in Table also          illustrate that interphylum HGT while turning genomes          into mosaics has not eroded all associations between          bacterial phyla In the case of cyanobacteria a close          association between low GC Gram positives and the          cyanobacteria is supported by the majority of conserved          genes Similar observations of reproducible associations          between phyla based on genome wide comparisons were          recently published        However at present          it cannot be decided to what extent these closer          associations reflects shared ancestry or are due to          preferred HGT                              Interdomain genome quartets          In our search for the sisterphylum to the          cyanobacteria we also analyzed a few quartets including          Archaea One noteworthy finding was that in the genome          quartet including           Synechocystis sp           Halobacterium sp           Aquifex aeolicus and           Thermotoga maritima the grouping of                    Halobacterium sp with           Synechocystis sp was recovered by          many more QuartOPs  with p   than the grouping          that would be expected following S rRNA phylogeny           QuartOPs with p   see Table  To test if this          association was specific for           Synechocystis sp we repeated the          analyses replacing           Synechocystis sp with           Bacillus subtilis  The result was          qualitatively the same at the p   level           QuartOPs supported grouping           Bacillus subtilis with           Halobacterium sp and only           supported grouping           Aquifex aeolicus with           Halobacterium sp Fig           Clearly there are many artifacts possible in          analyzing divergent sequences For many QuartOPs the          ortholog from           Halobacterium sp is expected to be          the longest branch To test for the possibility that long          branch attraction    might be the reason for the          strong support of           Halobacterium sp grouping with           Synechocystis sp we repeated the          analysis replacing the           Halobacterium sp genome with that          from           Archaeoglobus fulgidus  another          archaeon Gratifyingly many more QuartOPs supported the          grouping of the thermophilic archaeon           Archaeoglobus with the thermophilic          bacteria           Aquifex and           Thermotoga  The different          interdomain genome quartets that include a meso or          thermophilic archaeon are summarized in Table           An analysis of the putative functional assignments of          the QuartOPs that grouped           Halobacterium sp with the          mesophilic bacteria is given in Table  To assess which          of these categories have an increased percentage of          QuartOPs as compared to distribution of ORFs within the          genome we also calculated the distributions of ORFs          among functional categories in the           Halobacterium sp and           A fulgidus genomes Open reading          frames within a genome are distributed almost evenly          among the four metacategories see columns labeled H          and A However the QuartOPs that group the          halobacterial orthologs with those from mesophilic          Bacteria are distributed differentially among the          metacategories Most of the QuartOPs are in the          Metabolism and Information Storage and Processing          metacategories These are also the categories in which           Halobacterium sp shows many more          OuartOPs in support of topology  than           A fulgidus           The analyses described in this section reconfirm that          genes have been transferred across domain boundaries                    Not surprisingly these transfers          appear to occur preferentially between organisms living          in the same or similar environment The genome of the          mesophilic           Halobacterium sp contains many          genes that group with the orthologs from mesophilic          bacteria whereas the majority of genes from the          thermophilic archaeon           Archaeoglobus fulgidus group with          the orthologs from the extremely thermophilic bacteria          The majority of QuartOPs that group the halobacterial          orthologs with the ortholog from the mesophilic bactria          belong to two of four metacategories Information          Storage and Processing and Metabolism QuartOPs in          Information Storage and Processing metacategory that          support the grouping of           Halobacterium sp with           SynechocystisBacillus are listed          in the Table  A complete listing is available in the          supplementary material As expected this list includes          several tRNA synthetases which were previously found to          be frequently transferred       and enzymes          involved in DNA repair            cf      More surprisingly          this list also includes translation initiation factors          and several ribosomal proteins The latter were assumed          to be infrequently transferred but recent analyses          reported them to be horizontally transferred among          bacterial lineages      The initiation factor IF          in           Halobacterium sp was previously          shown to have strong similarity to the initiation factor          IF from Bacteria     Most of the genes that group           Halobacterium with the mesophilic          bacteria encode functions that were postulated to be          frequently exchanged     While no metacategory          appears exempt from HGT some functions appear to be more          often transferred than others cf Table           Additional file                     Click here for file          Additional file                     Click here for file                            Conclusions        Maximum likelihood mapping is a useful tool for        analyzing and depicting the mosaic nature of genomes        MLmapping is much less conservative than other approaches        of estimating Bayesian posterior probabilities If        MLmapping is used as the only probability mapping tool        the overestimation of supporting probabilities has to be        taken into consideration A posterior probability of         calculated with MLmapping often corresponds to a posterior        probability of only         Many relationships among prokaryotes cannot be depicted        by a treelike pattern reflecting a core of rarely        transferred genes Rather prokaryotic genomes are mosaics        where different parts have different evolutionary        histories However HGT between divergent organisms has not        erased all patterns of interphylum relationship For        example the majority of QuartOPs group the cyanobacteria        with the low GC Gram positives as sister phyla        Due to horizontal gene transfer even organisms from        different domains living in the same or similar        environments share more genes with each other than        organisms with a similar degree of divergence that live in        different environments These interdomain horizontal        transfers mainly concern proteins involved in nucleotide        carbohydrate and amino acid transport and metabolism        however proteins that are part of the translation        machinery or are involved in DNA repair appear to be        transferred across domain boundaries as well                    Materials and Methods                  Genome Data          Completed genomes were retrieved from the NCBIs FTP          site ftpncbinlmnihgovgenbankgenomesin the form          of amino acid sequences encoded by open reading frames          ORFs as identified in the annotated genomes          Mitochondrial genomes were obtained from the Organelle          Genomes Page at NCBI          httpwwwncbinlmnihgovPMGifsGenomeseukohtml          The genomes were formatted using the           formatdb program from the          standalone BLAST package initially of version           and later of versions  and  as they were          released     All analyses were performed          locally                          Data Flow in Quartet Analyses          For each set of four genomes BLAST     searches          of every ORF in one genome against the other three          genomes were performed using the           blastp program The Evalue cutoff          for the BLAST searches was set to  in one test case          an Evalue cutoff of  was used For every BLAST          search the GI number of the top hit if it was below the          cutoff was saved along with the GI number of the query          sequence forming a GI pair This resulted in twelve lists          of GI pairs for each of the twelve possible pairwise          genome comparisons This information was further used to          identify quartets of orthologous proteins QuartOPs          Following Tatusov et al    we defined QuartOPs as          those sets of genes that mutually pick each other as the          top scoring hit in the BLAST comparisons The detection          of the QuartOPs was performed using the MySQL database          software httpwwwmysqlcom The lists of GI pairs were          entered into twelve tables of a database The tables were          joined into one table under conditions that satisfy the          definition of the QuartOPs see above This resulted in          a table with four columns of GI numbers for QuartOPs The          amino acid sequences for each QuartOP were retrieved from          GenBank at NCBI and were aligned using ClustalW               QuartOPs were analyzed using the MLmapping approach          according to Strimmer and von Haeseler Bayesian          probabilities mapping and bootstrap support values          mapping techniques see details below                          Posterior probabilities according to Strimmer and          von Haeseler          For all three possible unrooted tree topologies          maximumlikelihood values and posterior probabilities          were calculated using inhouse JAVA programs that were          written utilizing classes from the Phylogenetic Analysis          Library version     and parts of Vanilla package          version      If not indicated otherwise          likelihood values were estimated using the automatically          selected suitable substitution model chosen from          BLOSUM CPREV Dayhoff JTT MTREV VT and WAG with          no ASRV The maximumlikelihood mapping approach was          further used to visualize support for each tree topology              ie the posterior probability vector for each          QuartOP was plotted into an equilateral triangle          Maximumlikelihood maps were generated using GNUPlot v           httpwwwgnuplotinfo                          Posterior Probabilities calculated with MrBayes          program          Posterior probabilities were also calculated with          MrBayes version      Each QuartOP was analyzed          with two simultaneous Markov chains for  cycles          under the JTT substitution model    without ASRV One          chain was heated with the temperature set equal to the          default value of  Samples were taken at each cycle          The burn in option was set to  cycles The          remaining  cycles were used to calculate posterior          probabilities for each of the three tree topologies The          posterior probabilities were plotted to equilateral          triangle as described above For discussion of the choice          of the parameters see below                          Bootstrap Support Values          As an alternative to posterior probability vectors          bootstrap support values were calculated and plotted          Each QuartOP was bootstrapped  times and the          proportion of bootstrapped datasets supporting each tree          topology was recorded as a bootstrap probability vector          The bootstrap probability vectors were plotted into an          equilateral triangle with the zones changed to total           and  see Fig                           Empirical Search for Optimal MrBayes          Parameters          To find parameters that will return consistent          posterior probabilities within reasonable computation          time one QuartOP from mitochondrial genome quartet m          was analyzed multiple times with different parameters          According to Strimmer and von Haeselers approach             this QuartOP has posterior probabilities of            and  In all runs samples were taken at each cycle          two chains and the JTT substitution model    without          ASRV were used          First we analyzed the dataset with  cycles We          tried different burn in options in the range of           The posterior probability values changed by          less than  from case to case We selected a burn in          of  cycles in further analyses Second we tried          different numbers of cycles to calculate posterior          probabilities The probabilities were calculated using           cycles with increment of  cycles          Again the posterior probability values did not change          significantly from case to case Third we raised the          temperature parameter           T to  for the second heated          chain This did not result in changes of the estimated          posterior probabilities Fourth we used  cycles          and repeated the analysis  times calculating average          and standard deviation of all runs For all three          probabilities the standard deviation was less than           Based on these analyses we selected  cycles with a          burn in of  as a compromise between precision of          probability estimation and computational time spent As a          final test we performed the analysis of the quartet           twice with selected parameters This did not result in          significantly different maps Graphs and tables depicting          the results of these analyses are given in the          supplementary material                          Mapping taking ASRV into account          For the genome quartet  we calculated posterior          probabilities under the model which takes ASRV into          account with Strimmer and von Haeselers    approach          and with the MrBayes program version               TREEPUZZLE     was used to calculate posterior          probabilities according to Strimmer and von Haeseler              A discrete approximation of the gamma distribution             was used to describe ASRV Eight rate categories          were used in TREEPUZZLE     and four rate          categories were used in MrBayes     The maps are          available in the supplementary material Due to the          amount of time required for calculations the analyses          were not performed for other genome quartets                          Functional assignments using the COG          database          Datasets for QuartOPs with strong preference for a          particular tree topology ie with posterior probability          above  for that particular topology or in other words          the QuartOPs located in the very corners of the          equilateral triangle were extracted For each of those          QuartOPs the COG functional category    was          identified In order to detect the functional categories          the COG database was downloaded from NCBIs FTP site          initially the year  release and later the year           release The COG database was formatted using the           formatdb program of BLAST package          Every QuartOP was compared to the COG database using the           blastp program The category of the          each sequence in the QuartOP was assigned according to          the category of the top hit of each BLAST search The          numbers of QuartOPs in each functional category were          calculated for each of the three tree topologies                          Distribution of ORFs among COG categories for          complete genomes of Halobacterium sp and Archaeoglobus          fulgidus          Every predicted ORF in a genome was compared to the          COG database release of year  using the           blastp program with Evalue cutoff            The category of each ORF was set to be equal to          the category of the top hit of the corresponding BLAST          search Category Q was dropped from the results because          the corresponding genome quartets were analyzed with the          previous release of the COG database release of year           that did not contain the Q category                          Data Analysis Automation          The repetitive tasks of analyses were automated using          the SEALS package version      The tasks that          were not available through SEALS package were programmed          in PERL v  The PERL scripts and JAVA programs are          available upon request                          Mitochondrial Genome Quartets Analyses          Seven mitochondrial genome quartets were used as          controls and were analyzed with the three approaches for          genome quartet analysis described above For calculation          of posterior probabilities with MrBayes at least           cycles were used                            List of Abbreviations                HGT horizontal gene transfer                COG cluster of orthologous groups                ML maximum likelihood                rRNA ribosomal ribonucleic acid                sp species                BLAST Basic Local Alignment Search        Tool                QuartOP quartet of orthologous        proteins                SEALS System for Easy Analysis of Lots        of Sequences                NCBI National Center for Biotechnology        Information                ASRV Among Site Rate Variation                    Supplementary Material        Supplementary material is located at the QuartOP web        page httpcarrotmcbuconneduquartets This web page        includes the summary of all genome quartets analyzed with        maps the results of control analyses and a form to        request the scripts described in this article ML maps are        available in postscript and PDF formats An offline version        of the QuartOP web page is available as a compressed        archive named suppmaterialzip and as a selfextracting        archive suppmaterialexe for Microsoft Windows users The        archive can be expanded using WinZip        httpwwwwinzipcomfor Windows StuffIt for Macintosh        httpwwwstuffitcom or unzip utility for Unix The        uncompress utilities have to be run with the option to        preserve the subdirectory structure inside the archive To        access the information in the archive the file indexhtml        has to be opened using an Internet browser This indexhtml        file is located in the root directory named        offlinequartops All the files in the archive are        hyperlinked and accessible through the indexhtml file            