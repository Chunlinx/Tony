                    EEG        The electroencephalogram EEG recorded from electrodes        placed on the scalp reflects the electrical activity of        the brain        First registered from human scalp in      until        today EEG remains an important tool in neuroscience and        clinical neurophysiology For a long time it was the only        objective parameter providing information on brains         function  Recently emerging dynamic        imaging techniques like fMRI and PET offer a complementary        information on brains functioning Their drawbacks include        significantly lower time resolution high cost and        invasiveness Nevertheless in spite of those drawbacks        they are often preferred for the straightforward        interpretability On the contrary visual interpretation of        EEG is a difficult tedious and complicated task requiring        many years of experience And even then it contains a        significant subjective factor        Every experienced electroencephalographer has his or her        personal approach to EEG interpretation  there is an        element of science and element of art in a good EEG        interpretation it is the latter that defies        standardization        writes Prof Ernst Niedermayer in the recent edition of        a fundamental reference            In spite of this discouraging opinion application of        various signal processing methods in this field is still        very popular First introduction of Fourier analysis to EEG        is dated      Since then spectral analysis has        become a standard tool in this field But until today        basically no other method gained a general acceptance  the        few widely accepted and applied methods of EEG analysis        still amount to             visual analysis of raw EEG traces         Fourier estimation of spectral power in selected        frequency bands         description of evoked potentials averaged in the        time domain        One of the reasons of this unsatisfactory situation is        that among the variety of new methods proposed each year        for the analysis of EEG very few have any direct        relationship to the traditional visual analysis That        means that their results usually cannot be directly related        to the most valuable knowledge base of  years of        experience collected by means of the visual analysis of        EEG On the contrary each new method needs to be evaluated        from the scratch in many laboratories and over many        repeated studies before it can be considered as a        clinically usable parameter And since there is a multitude        of new methods being proposed with few         a priori hints for their possible        performance this process seems to be hardly        convergent                    Wavelets the first step towards timefrequency        analysis                  Limitations of linear and quadratic timefrequency          representations          Further attempts to apply wavelets to the analysis of          ongoing EEG activity encountered a major drawback          Representation of the signal obtained from orthogonal          wavelet representation is not timeshift invariant This          property is illustrated in Figure           This limitation is not present in the continuous          wavelet transform as well as several quadratic          representations of signals energy density in the          timefrequency plane cf    and Figure  However          in such case we loose the compact description offered by          orthogonal wavelets  the representation is highly          redundant Another problem relates to the occurence of          cross terms Figure           Both these problems can be solved or at least          significantly reduced by the solution proposed in the          next section                            Adaptive approximations and matching pursuit        Given a set of functions dictionary         D           g                   g                   g                   n           such that          g                   i             we can define an optimal         M approximation as an expansion        minimizing the error  of an approximation of signal         f          t  by         M waveforms                where                    i                           i           M  represents the indices of the        chosen functions         g                            i            Finding such an optimal approximation is an        NPhard problem A suboptimal expansion can be found by        means of an iterative procedure such as the matching        pursuit algorithm MP proposed by Mallat and Zhang                   In the first step of MP the waveform         g                    which best matches the signal         f          t  is chosen In each of the        consecutive steps the waveform         g                            n           is matched to the signal R         n         f  which is the residual left after        subtracting results of previous iterations                Orthogonality of R         n          f and         g                            n           in each step implies energy conservation                For a complete dictionary the procedure converges to         f                 From this equation we can derive a timefrequency        distribution of the signals energy that is free of        crossterms by adding Wigner distributions of selected        functions                This magnitude is presented in Figure  calculated from        MP decomposition of a simulated signal with known and        simple content We observe that most of the structures are        represented compactly and with high resolution except for        the structure of changing frequency linear chirp It is        represented by a series of structures of constant        frequency since in the applied Gabor dictionary section         we have only constant frequency modulations Section         presents an alternative approach to this issue        Figure presents estimates of the timefrequency density        of the same signals energy obtained from spectrograms        with different window widths continuous wavelet transform        and smoothed pseudo WignerVille distribution Only in the        last case representation of the chirp looks better than on        the plot obtained from MP decomposition but we must take        into account that in this case the parameters of the kernel        of the distribution were optimized for this particular        signal        Except for the lack of cross terms and high resolution        adaptive timefrequency parametrizations exhibit one more        basic and important advantage over the continuous        timefrequency representations Unlike the maps from Figure         for all the structures presented in Figure we have a        priori the exact values of their time and frequency        centers widths amplitudes and phases This property will        be thoroughly explored in the following studies                    First application in EEG analysis sleep        spindles        The presence of sleep spindle should not be defined        unless it is of at least  sec duration ie one should        be able to count  or  distinct waves within the        halfsecond period  The term should be used only to        describe activity between  and  cps         says the definition from the basic reference            A manual of standardized terminology techniques and        scoring system for sleep stages in human subjects It can        be directly translated into the language of parameters of        the structures fitted to the signal by the algorithm        discussed in the previous section        By choosing from the timefrequency atoms fitted to EEG        by the MP algorithm those conforming to the above        criteria we obtain a detailed automatic and        highresolution parametrization of the relevant structures        which correspond to sleep spindles      Figures and        present results of such a procedure carried out for        several derivations of an overnight sleep EEG recording        This parametrization has proven to be consistent with        visual detection especially for the structures of higher        amplitudes     For lower amplitudes the algorithm        detects also spindles elusive to a human expert        Results presented in these figures conform also the        previously observed effect of predominance of lower        frequencies of sleep spindles in frontal derivations and        higher frequencies in parietal derivations We also notice        that some frequencies on these plots are prefereed ie        exhibit regular maxima in the histograms But are they        preferred by the brain or by the analysis algorithm This        question will be resolved in the next section                    Discrete Gabor dictionary                  Stochastic dictionaries          In forming the dictionary used for MP decomposition          using any           fixed scheme of subsampling the          parameter space introduces statistical bias in the          resulting parametrization This bias becomes apparent          only when statistics comes into play like in          parameterization of large amounts of data Unbiased MP          decompositions can be obtained by an analogue of Monte          Carlo methods          In    we proposed MP with stochastic dictionaries          where the parameters of a dictionarys atoms are          randomized before each decomposition A stochastic          dictionary           D is constructed for a given signal          length           N and chosen resolutions in          time frequency and scale            t   and            s  The space of parameters           t   and           s is thereby divided into bricks of          size            t by  by            s each where    In each of          those bricks one timefrequency atom is chosen by          drawing its parameters from flat distributions within the          given ranges of continuous parameters          Figures and present results for the same data as          Figures and  These results owing to the application          of the above described stochastic dictionaries are free          from the statistical bias          The resolution of the matching pursuit is hard to          define in general since the procedure is nonlinear and          signaldependent It should be related to the distance          between neighboring dictionary waveforms available for          decomposition In the described procedure this distance          does not exceed twice the value of the corresponding          parameter            t   or            s                             Pharmaco EEG        This section presents an application of the proposed        methodology to the standard clinical problem of testing        influence of sleep inducing drugs on the sleep EEG        The effects of zolpidem midazolam and placebo        administered at bed time were studied in  paid        volunteers From each of the  allnight recordings         nights for each subject we extracted artifactfree epochs        from derivation CA of the  system For the analysis        of slow wave activity SWA we used data from stages III        and IV and for sleep spindles only data from sleep stage        II        Figures and present the classical approach to the        analysis of these data that is averaging the spectral        integrals in the above mentioned ranges for each of the        analyzed recordings        Figures and present each of the structures        classified as sleep spindles Figure  or SWA Figure         as a dot in the frequencyamplitude plane These structures        were selected using not only the frequency information as        in the classical approach but also information on time        duration and amplitude from Table  Total power carried by        these structures summed and normalized per time unit is        indicated on the right of each plot together with the        average number of occurrences per minute average amplitude        and frequency        We observe that selective MPbased estimates of power        are more sensitive to the effect of influence of both drugs        than the spectral integrals This sensitivity becomes        crucial in two of the analyzed cases         In the recording of patient ZCB which revealed a        very low spindling activity last row in Figures and         fluctuations in the background masked the power of sleep        spindles to such an extent that spectral integrals        indicate a partially reverse trend ie decrease of power        of sleep spindles under the influence of midazolam        Selective estimates indicate the expected increase         For patient ZCB second row from the bottom        spectral integrals indicate increase of power of SWA         while MP estimates reveal a decrease coherent with all the        other cases        Finally as an example of an effect elusive to the        classical methodology these results indicate also a        statistically significant decrease of the frequency of the        slow wave activity Further discussion and statistical        evaluation of results can be found in            Figure partially explains the increased sensitivity of        the proposed approach as compared to the classical paradigm        of bandlimited spectral power integrals                    Representation of changing frequency        Another interesting property of the stochastic        timefrequency dictionaries discussed in section         relates to the representation of structures of changing        frequency Such structures are absent in the dictionaries        usually applied for the decomposition and therefore are        represented as a series od fixedfrequency Gabor functions        Figure  fand Figure  b        However by averaging several decompositions of the same        signal in different realizations of smaller stochastic        dictionaries we obtain a more continuous representation        like in Figures  gand Figure  c The representation        is no more compact but retains the general property of        absence of cross terms                    Eventrelated desynchronization and        synchronization        Advantages of the MP algorithm with stochastic        dictionaries can be also combined with the stochastic        element present inherently in the data like eg in the        case of analyzing repetitions of eventrelated potentials        This relates especially to the nonphase locked activity        ie such that would not be enhanced in the        stimulussynchronized time averages Its detection requires        a different analysis technique allowing for averaging        signals energy irrelevant of the phase  Classically it        was achieved by squaring the values of signals bandpass        filtered in         a priori chosen frequency bands        before averaging      Figure         This methodology has several drawbacks including tha        arbitrary choice of frequency bands and limited sensitivity        cf Figure  Averaging the timefrequency densities of        energy obtained from the MP decomposition allows for an        instantaneous evaluation of the complete picture of changes        in the timefrequency plane with high resolution Figure        presents this picture for the same data as in Figure         Another study in Figure reveals clearly splitting of the        alpha band in the upper and lower frequencies with        different behaviour related to the finger movement This        phenomenon would be very difficult to find using the        classical methodology        If we want to analyze phasic synchronization in higher        frequencies like eg gamma band around  Hz the        accuracy of the trigers determination would have to be         much better than eg  ms which is        rather beyond the accuracy of determining eg the moment        of a finger movement But nonphasic effects should be        visible in the presented approach                    Epileptic seizures        Discussed advantages of timefrequency estimates of        energy density obtained from MP decomposition allowed for        identification of different dynamic states during evolution        and propagation of epileptic seizures in            Figure presents an example of timefrequency density        of energy calculated from the MP expansion of an        intracranial recording of epileptic seizure Sensitivity of        the algorithm to the phase changes clearly distinguishes        the initial less synchronized period of transitional        rhytmic activity starting near th second from the        organized rhytmic activity In this period starting about        th second all the harmonics up to the Nyquist        frequency clearly follow the pattern of decreasing        frequency Such a clear representation of changing        frequency was possible using the technique discussed in        section                     Problems        As presented in figure  greedy MP algorithm in        certain cases can fail to properly decompose signal        containing even a simple combination of dictionarys        functions This counterexample was simulated especially for        discussion of practical issues and as such may look scary        but on the other hand we never encountered such a failure        in applications to real world signals The trap in this        case lies in the fact that both these structures have         exactly the same phase and it might        be even dicussable if they should not be treated as one in        the first approximation If they were produced by two        different biological generators such a coincidence of        phases would not be possible and they would be parametrized        separately        Other more theoretical examples of MP failures are        given in    and     Some of these cases can be        properly solved by the orthogonalized matching pursuit            at a cost of increased computational requirements and a        possibility of introducing numerical instabilities            Another modification of the MP algorithm discussed in            relies on a modification of the similarity function        used in each step to choosed the best fit Other works           indicate that global optimalization of the         l norm of expansions coefficients        might be the best choice     but in spite of recent        advances in linear programming computational complexity is        still very high        Other problems awaiting better solutions include        efficient and at the same time biasfree implementations        robust estimation of resolution proper addressing of the        tradeoff between resolution increasing dictionary size        and computation cost and extension of the algorithm to the        multichannel case Such research will improve effectivity        and understanding of mathematical foundations of these        higly nonlinear procedures However current        implementations and knowledge of algorithms properties are        already sufficient for large scale applications in EEG        research and clinical practice They may serve as a basis        for a unification of parametrization and description of        EEG        Implementations of MP with stochastic dictionaries is        available from httpbrainfuweduplmp                    Authors contributions        Parts of presented research according to the quoted        references were coauthored by         Prof Katarzyna J Blinowska head of the Laboratory        of Medical Physics Warsaw University and my colleagues        from the Lab Jzef Ginter Jr Dobiesaw Ircha Jarosaw        Zygierewicz         Prof Waldemar Szelenberger Medical University of        Warsaw         Prof Ernest A Bartnik Inst of Theoretical Physics        Warsaw University         Prof Piotr Franaszczuk Johns Hopkins Medical        University         Prof Gert Pfurtscheller and dr Christa Neuper Graz        Technical University            